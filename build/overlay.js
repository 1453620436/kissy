/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: May 9 14:06
*/
KISSY.add("overlay",["overlay/control","overlay/dialog","overlay/popup"],function(j,i){var h=i("overlay/control"),f=i("overlay/dialog"),m=i("overlay/popup");h.Dialog=f;j.Dialog=f;h.Popup=m;return j.Overlay=h});
KISSY.add("overlay/control","component/container,component/extension/shim,component/extension/align,./extension/loading,./extension/mask,./extension/overlay-effect,component/extension/content-box,./overlay-xtpl".split(","),function(j,i){var h=i("component/container"),f=i("component/extension/shim"),m=i("component/extension/align"),a=i("./extension/loading"),g=i("./extension/mask"),b=i("./extension/overlay-effect"),c=i("component/extension/content-box"),k=i("./overlay-xtpl"),o={hide:"hide",destroy:"destroy"};
return h.extend([c,f,a,m,g,b],{bindUI:function(){var b=this,c=b.get("closeBtn");if(c)c.on("click",function(c){b.close();c.preventDefault()})},close:function(){this[o[this.get("closeAction")]||"hide"]();return this}},{ATTRS:{contentTpl:{value:k},closable:{value:false,sync:0,render:1,parse:function(){return!!this.get("closeBtn")}},closeBtn:{selector:function(){return"."+this.getBaseCssClass("close")}},closeAction:{value:"hide"},focusable:{value:false},allowTextSelection:{value:true},handleGestureEvents:{value:false},
visible:{value:false}},xclass:"overlay"})});
KISSY.add("overlay/extension/loading",["node"],function(j,i){function h(){}var f=i("node");h.prototype={loading:function(){this._loadingExtEl||(this._loadingExtEl=(new f('<div class="'+this.get("prefixCls")+'ext-loading" style="position: absolute;border: none;width: 100%;top: 0;left: 0;z-index: 99999;height:100%;*height: expression(this.parentNode.offsetHeight);"/>')).appendTo(this.$el));this._loadingExtEl.show()},unloading:function(){this._loadingExtEl&&this._loadingExtEl.hide()}};return h});
KISSY.add("overlay/extension/mask",["ua","node","event/gesture/tap"],function(j,i){function h(b,c){var d=b.getBaseCssClasses("mask"),d=o('<div  style="width:'+(k?"expression(KISSY.DOM.docWidth())":"100%")+";left:0;top:0;height:"+(k?"expression(KISSY.DOM.docHeight())":"100%")+";position:"+(k?"absolute":"fixed")+';" class="'+d+" "+c+'">'+(k?'<iframe style="position:absolute;left:0;top:0;background:red;width: expression(this.parentNode.offsetWidth);height: expression(this.parentNode.offsetHeight);filter:alpha(opacity=0);z-index:-1;"></iframe>':
"")+"</div>").prependTo("body");d.unselectable();d.on("mousedown",function(b){b.preventDefault()});return d}function f(){}function m(b,c){var d=b.get("maskNode"),g=b.getBaseCssClasses("mask-hidden");c?d.removeClass(g):d.addClass(g)}function a(b,c,d,g){var k=b.effect||l;m(g,d);if(k!==l){var g=b.duration,b=b.easing,e=d?1:0;c.stop(1,1);c.css("display",d?l:"block");c[k+n[k][e]](g,function(){c.css("display","")},b)}}function g(b){var c=this.get("maskNode");if(b=b.newVal){var d=Number(this.$el.css("z-index"));
isNaN(d)||c.css("z-index",d)}a(this.get("mask"),c,b,this)}var b=i("ua"),c=i("node"),k=6===b.ie,o=c.all,e=i("event/gesture/tap").TAP;f.ATTRS={mask:{value:!1},maskNode:{}};var l="none",n={fade:["Out","In"],slide:["Up","Down"]};f.prototype={__renderUI:function(){this.get("mask")&&this.set("maskNode",h(this,this.get("visible")?"":this.getBaseCssClasses("mask-hidden")))},__bindUI:function(){var b,c;if(c=this.get("mask")){b=this.get("maskNode");if(c.closeOnClick)b.on(e,this.close,this);this.on("afterVisibleChange",
g)}},__destructor:function(){var b;(b=this.get("maskNode"))&&b.remove()}};return f});
KISSY.add("overlay/extension/overlay-effect",[],function(j){function i(b){var c=b.$el.clone(!0);c.css({visibility:"hidden",overflow:"hidden"}).addClass(b.get("prefixCls")+"overlay-ghost");return b.__afterCreateEffectGhost(c)}function h(b,c){b.__effectGhost&&b.__effectGhost.stop(1,1);var g=b.$el,a=j.all,e=b.get("effect"),l=a(e.target),a=e.duration,f={width:l.width(),height:l.height()},p=l.offset(),r={width:g.width(),height:g.height()},d=g.offset(),q,h=i(b),s=e.easing;h.insertAfter(g);c?(l=f,q=p,f=
r,p=d):(l=r,q=d);h.offset(p);j.mix(f,{left:h.css("left"),top:h.css("top")});g.css("visibility","hidden");h.css(l);h.offset(q);b.__effectGhost=h;h.css("visibility","visible");h.animate(f,{Anim:e.Anim,duration:a,easing:s,complete:function(){b.__effectGhost=null;h.remove();g.css("visibility","")}})}function f(b,c){var k=b.$el,a=b.get("effect"),e=a.effect||"none",l=a.target;if("none"!==e||l)if(l)h(b,c);else{var l=a.duration,i=a.easing,f=c?1:0;k.stop(1,1);k.css({visibility:"visible",display:c?"none":"block"});
k[e+g[e][f]]({duration:l,Anim:a.Anim,complete:function(){k.css({display:"block",visibility:""})},easing:i})}}function m(b){f(this,b.newVal)}function a(){}var g={fade:["Out","In"],slide:["Up","Down"]};a.ATTRS={effect:{value:{effect:"",target:null,duration:0.5,easing:"easeOut"},setter:function(b){var c=b.effect;"string"===typeof c&&!g[c]&&(b.effect="")}}};a.prototype={__afterCreateEffectGhost:function(b){return b},__bindUI:function(){this.on("afterVisibleChange",m,this)}};return a});
KISSY.add("overlay/overlay-xtpl",[],function(j,i,h,f){j=function(i,a,g){var b=this,c=b.root.nativeCommands,k=b.root.utils.callFn,h=c["if"],c=c.block;a.write("",0);var e={escape:1},f=[];f.push("ks-overlay-closable");e.params=f;e.fn=function(c,a){a.write("\r\n    ",0);var e={escape:1},d=[],f=c.resolve(["closable"],0);d.push(f);e.params=d;e.fn=function(c,d){d.write('\r\n        <a href="javascript:void(\'close\')"\r\n           class="',0);var a={escape:1},e=[];e.push("close");a.params=e;if((a=k(b,c,
a,d,["getBaseCssClasses"],0,4))&&a.isBuffer)d=a,a=g;d.write(a,!0);d.write("\"\r\n           role='button'>\r\n            <span class=\"",0);a={escape:1};e=[];e.push("close-x");a.params=e;if((a=k(b,c,a,d,["getBaseCssClasses"],0,6))&&a.isBuffer)d=a,a=g;d.write(a,!0);d.write('">close</span>\r\n        </a>\r\n    ',0);return d};a=h.call(b,c,e,a,2);a.write("\r\n",0);return a};a=c.call(b,i,e,a,1);a.write('\r\n\r\n<div class="',0);e={escape:1};f=[];f.push("content");e.params=f;if((e=k(b,i,e,a,["getBaseCssClasses"],
0,11))&&e.isBuffer)a=e,e=g;a.write(e,!0);a.write('">\r\n    ',0);e={escape:1};f=[];f.push("ks-overlay-content");e.params=f;e.fn=function(b,c){c.write("\r\n        ",0);var a=b.resolve(["content"],0);c.write(a,!1);c.write("\r\n    ",0);return c};a=c.call(b,i,e,a,12);a.write("\r\n</div>",0);return a};j.TPL_NAME=f.name;j.version="5.0.0";return j});
KISSY.add("overlay/dialog",["./control","node","./dialog-xtpl"],function(j,i){var h=i("./control"),f=i("node"),m=i("./dialog-xtpl"),h=h.extend({beforeCreateDom:function(a){j.mix(a.elAttrs,{role:"dialog","aria-labelledby":"ks-stdmod-header-"+this.get("id")})},getChildrenContainerEl:function(){return this.get("body")},__afterCreateEffectGhost:function(a){var b=this.get("body");a.all("."+this.get("prefixCls")+"stdmod-body").css({height:b.height(),width:b.width()}).html("");return a},handleKeyDownInternal:function(g){if(this.get("escapeToClose")&&
g.keyCode===f.KeyCode.ESC){if("select"!==g.target.nodeName.toLowerCase()||g.target.disabled)this.close(),g.halt()}else a:if(g.keyCode===a){var b=this.$el,c=f.all(g.target),k=b.last();if(c.equals(b)&&g.shiftKey)k[0].focus(),g.halt();else if(c.equals(k)&&!g.shiftKey)this.focus(),g.halt();else if(c.equals(b)||b.contains(c))break a;g.halt()}},_onSetVisible:function(a,b){var c=this.el;this.callSuper(a,b);if(a)this.__lastActive=c.ownerDocument.activeElement,this.focus(),c.setAttribute("aria-hidden","false");
else{c.setAttribute("aria-hidden","true");try{this.__lastActive&&this.__lastActive.focus()}catch(f){}}},_onSetBodyContent:function(a){var b;b=this.get("body");b.html(a)},_onSetHeaderContent:function(a){var b;b=this.get("header");b.html(a)},_onSetFooterContent:function(a){var b;b=this.get("footer");b.html(a)}},{ATTRS:{contentTpl:{value:m},header:{selector:function(){return"."+this.getBaseCssClass("header")}},body:{selector:function(){return"."+this.getBaseCssClass("body")}},footer:{selector:function(){return"."+
this.getBaseCssClass("footer")}},bodyStyle:{value:{},sync:0},footerStyle:{value:{},render:1},headerStyle:{value:{},render:1},headerContent:{value:"",sync:0,render:1,parse:function(){return this.get("header").html()}},bodyContent:{value:"",sync:0,render:1,parse:function(){return this.get("body").html()}},footerContent:{value:"",sync:0,render:1,parse:function(){return this.get("footer").html()}},closable:{value:!0},focusable:{value:!0},escapeToClose:{value:!0}},xclass:"dialog"}),a=f.KeyCode.TAB;return h});
KISSY.add("overlay/dialog-xtpl",["./overlay-xtpl"],function(j,i,h,f){j=function(f,a,g){var b=this,c=b.root.nativeCommands,k=b.root.utils.callFn,h=c.each,e=c.extend,c=c.block;a.write("",0);var j={},n=[];n.push("./overlay-xtpl");j.params=n;i("./overlay-xtpl");if((e=e.call(b,f,j,a,1))&&e.isBuffer)a=e,e=g;a.write(e,!1);a.write("\r\n",0);e={escape:1};j=[];j.push("ks-overlay-content");e.params=j;e.fn=function(c,a){a.write('\r\n    <div class="',0);var d={escape:1},e=[];e.push("header");d.params=e;if((d=
k(b,c,d,a,["getBaseCssClasses"],0,3))&&d.isBuffer)a=d,d=g;a.write(d,!0);a.write('"\r\n         style="\r\n',0);var d={escape:1},e=[],f=c.resolve(["headerStyle"],0);e.push(f);d.params=e;d.fn=function(a,c){c.write("\r\n ",0);var b=a.resolve(["xindex"],0);c.write(b,!0);c.write(":",0);b=a.resolve(["this"],0);c.write(b,!0);c.write(";\r\n",0);return c};a=h.call(b,c,d,a,5);a.write('\r\n">',0);d=c.resolve(["headerContent"],0);a.write(d,!1);a.write('</div>\r\n\r\n    <div class="',0);d={escape:1};e=[];e.push("body");
d.params=e;if((d=k(b,c,d,a,["getBaseCssClasses"],0,10))&&d.isBuffer)a=d,d=g;a.write(d,!0);a.write('"\r\n         style="\r\n',0);d={escape:1};e=[];f=c.resolve(["bodyStyle"],0);e.push(f);d.params=e;d.fn=function(c,a){a.write("\r\n ",0);var b=c.resolve(["xindex"],0);a.write(b,!0);a.write(":",0);b=c.resolve(["this"],0);a.write(b,!0);a.write(";\r\n",0);return a};a=h.call(b,c,d,a,12);a.write('\r\n">',0);d=c.resolve(["bodyContent"],0);a.write(d,!1);a.write('</div>\r\n\r\n    <div class="',0);d={escape:1};
e=[];e.push("footer");d.params=e;if((d=k(b,c,d,a,["getBaseCssClasses"],0,17))&&d.isBuffer)a=d,d=g;a.write(d,!0);a.write('"\r\n         style="\r\n',0);d={escape:1};e=[];f=c.resolve(["footerStyle"],0);e.push(f);d.params=e;d.fn=function(a,c){c.write("\r\n ",0);var b=a.resolve(["xindex"],0);c.write(b,!0);c.write(":",0);b=a.resolve(["this"],0);c.write(b,!0);c.write(";\r\n",0);return c};a=h.call(b,c,d,a,19);a.write('\r\n">',0);d=c.resolve(["footerContent"],0);a.write(d,!1);a.write('</div>\r\n    <div tabindex="0"></div>\r\n',
0);return a};return a=c.call(b,f,e,a,2)};j.TPL_NAME=f.name;j.version="5.0.0";return j});
KISSY.add("overlay/popup",["./control"],function(j,i){function h(){var c=this,a=c.get("trigger"),b;c.__mouseEnterPopup=function(a){m.call(c);b=j.later(function(){g.call(c,a);b=void 0},1E3*c.get("mouseDelay"))};a.on("mouseenter",c.__mouseEnterPopup);c._mouseLeavePopup=function(){b&&(b.cancel(),b=void 0);f.call(c)};a.on("mouseleave",c._mouseLeavePopup)}function f(){var a=this,f=1E3*a.get("mouseDelay");a._hiddenTimer=j.later(function(){b.call(a)},f)}function m(){this._hiddenTimer&&(this._hiddenTimer.cancel(),
this._hiddenTimer=void 0)}function a(){var a=this;a.__clickPopup=function(f){f.preventDefault();a.get("toggle")?(a.get("visible")?b:g).call(a,f):g.call(a,f)};a.get("trigger").on("click",a.__clickPopup)}function g(a){this.set("currentTrigger",j.one(a.target));this.show()}function b(){this.set("currentTrigger",void 0);this.hide()}return i("./control").extend({initializer:function(){this.get("trigger")&&("mouse"===this.get("triggerType")?h.call(this):a.call(this))},bindUI:function(){if(this.get("trigger")&&
"mouse"===this.get("triggerType"))this.$el.on("mouseleave",f,this).on("mouseenter",m,this)},destructor:function(){var a=this.$el,b=this.get("trigger");b&&(this.__clickPopup&&b.detach("click",this.__clickPopup),this.__mouseEnterPopup&&b.detach("mouseenter",this.__mouseEnterPopup),this._mouseLeavePopup&&b.detach("mouseleave",this._mouseLeavePopup));a&&a.detach("mouseleave",f,this).detach("mouseenter",m,this)}},{ATTRS:{trigger:{setter:function(a){return j.all(a)}},triggerType:{value:"click"},currentTrigger:{},
mouseDelay:{value:0.1},toggle:{value:!1}},xclass:"popup"})});
