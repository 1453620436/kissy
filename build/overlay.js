/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: May 19 20:54
*/
KISSY.add("overlay",["overlay/control","overlay/dialog","overlay/popup"],function(j,d){var k=d("overlay/control"),f=d("overlay/dialog"),m=d("overlay/popup");k.Dialog=f;j.Dialog=f;k.Popup=m;return j.Overlay=k});
KISSY.add("overlay/control","component/container,component/extension/shim,component/extension/align,./extension/loading,./extension/mask,./extension/overlay-effect,component/extension/content-box,./overlay-xtpl".split(","),function(j,d){var k=d("component/container"),f=d("component/extension/shim"),m=d("component/extension/align"),h=d("./extension/loading"),l=d("./extension/mask"),b=d("./extension/overlay-effect"),a=d("component/extension/content-box"),i=d("./overlay-xtpl"),p={hide:"hide",destroy:"destroy"};
return k.extend([a,f,h,m,l,b],{bindUI:function(){var c=this,b=c.get("closeBtn");if(b)b.on("click",function(b){c.close();b.preventDefault()})},close:function(){this[p[this.get("closeAction")]||"hide"]();return this}},{ATTRS:{contentTpl:{value:i},closable:{value:false,sync:0,render:1,parse:function(){return!!this.get("closeBtn")}},closeBtn:{selector:function(){return"."+this.getBaseCssClass("close")}},closeAction:{value:"hide"},focusable:{value:false},allowTextSelection:{value:true},handleGestureEvents:{value:false},
visible:{value:false}},xclass:"overlay"})});
KISSY.add("overlay/extension/loading",["node"],function(j,d){function k(){}var f=d("node");k.prototype={loading:function(){this._loadingExtEl||(this._loadingExtEl=(new f('<div class="'+this.get("prefixCls")+'ext-loading" style="position: absolute;border: none;width: 100%;top: 0;left: 0;z-index: 99999;height:100%;*height: expression(this.parentNode.offsetHeight);"/>')).appendTo(this.$el));this._loadingExtEl.show()},unloading:function(){this._loadingExtEl&&this._loadingExtEl.hide()}};return k});
KISSY.add("overlay/extension/mask",["ua","node","event/gesture/tap"],function(j,d){function k(c,b){var e=c.getBaseCssClasses("mask"),e=p('<div  style="width:'+(i?"expression(KISSY.DOM.docWidth())":"100%")+";left:0;top:0;height:"+(i?"expression(KISSY.DOM.docHeight())":"100%")+";position:"+(i?"absolute":"fixed")+';" class="'+e+" "+b+'">'+(i?'<iframe style="position:absolute;left:0;top:0;background:red;width: expression(this.parentNode.offsetWidth);height: expression(this.parentNode.offsetHeight);filter:alpha(opacity=0);z-index:-1;"></iframe>':
"")+"</div>").prependTo("body");e.unselectable();e.on("mousedown",function(c){c.preventDefault()});return e}function f(){}function m(c,b){var e=c.get("maskNode"),i=c.getBaseCssClasses("mask-hidden");b?e.removeClass(i):e.addClass(i)}function h(c,b,e,i){var a=c.effect||g;m(i,e);if(a!==g){var i=c.duration,c=c.easing,d=e?1:0;b.stop(1,1);b.css("display",e?g:"block");b[a+s[a][d]](i,function(){b.css("display","")},c)}}function l(c){var b=this.get("maskNode");if(c=c.newVal){var e=Number(this.$el.css("z-index"));
isNaN(e)||b.css("z-index",e)}h(this.get("mask"),b,c,this)}var b=d("ua"),a=d("node"),i=6===b.ie,p=a.all,c=d("event/gesture/tap").TAP;f.ATTRS={mask:{value:!1},maskNode:{}};var g="none",s={fade:["Out","In"],slide:["Up","Down"]};f.prototype={__renderUI:function(){this.get("mask")&&this.set("maskNode",k(this,this.get("visible")?"":this.getBaseCssClasses("mask-hidden")))},__bindUI:function(){var b,i;if(i=this.get("mask")){b=this.get("maskNode");if(i.closeOnClick)b.on(c,this.close,this);this.on("afterVisibleChange",
l)}},__destructor:function(){var c;(c=this.get("maskNode"))&&c.remove()}};return f});
KISSY.add("overlay/extension/overlay-effect",["util","node"],function(j,d){function k(b){var a=b.$el.clone(!0);a.css({visibility:"hidden",overflow:"hidden"}).addClass(b.get("prefixCls")+"overlay-ghost");return b.__afterCreateEffectGhost(a)}function f(b,h){b.__effectGhost&&b.__effectGhost.stop(1,1);var c=b.$el,g=d("node").all,f=b.get("effect"),n=g(f.target),g=f.duration,q={width:n.width(),height:n.height()},e=n.offset(),m={width:c.width(),height:c.height()},l=c.offset(),r,o=k(b),t=f.easing;o.insertAfter(c);
h?(n=q,r=e,q=m,e=l):(n=m,r=l);o.offset(e);a.mix(q,{left:o.css("left"),top:o.css("top")});c.css("visibility","hidden");o.css(n);o.offset(r);b.__effectGhost=o;o.css("visibility","visible");o.animate(q,{Anim:f.Anim,duration:g,easing:t,complete:function(){b.__effectGhost=null;o.remove();c.css("visibility","")}})}function m(i,a){var c=i.$el,g=i.get("effect"),d=g.effect||"none",n=g.target;if("none"!==d||n)if(n)f(i,a);else{var n=g.duration,q=g.easing,e=a?1:0;c.stop(1,1);c.css({visibility:"visible",display:a?
"none":"block"});c[d+b[d][e]]({duration:n,Anim:g.Anim,complete:function(){c.css({display:"block",visibility:""})},easing:q})}}function h(b){m(this,b.newVal)}function l(){}var b={fade:["Out","In"],slide:["Up","Down"]},a=d("util");l.ATTRS={effect:{valueFn:function(){return{effect:"",target:null,duration:0.5,easing:"easeOut"}},setter:function(a){var d=a.effect;"string"===typeof d&&!b[d]&&(a.effect="")}}};l.prototype={__afterCreateEffectGhost:function(b){return b},__bindUI:function(){this.on("afterVisibleChange",
h,this)}};return l});
KISSY.add("overlay/overlay-xtpl",[],function(j,d,k,f){j=function(d,h,f){var b=this,a=b.root.nativeCommands,i=b.root.utils.callFn,j=a["if"],a=a.block;h.write("",0);var c={escape:1},g=[];g.push("ks-overlay-closable");c.params=g;c.fn=function(c,a){a.write("\r\n    ",0);var d={escape:1},e=[],g=c.resolve(["closable"],0);e.push(g);d.params=e;d.fn=function(c,e){e.write('\r\n        <a href="javascript:void(\'close\')"\r\n           class="',0);var a={escape:1},d=[];d.push("close");a.params=d;if((a=i(b,c,
a,e,["getBaseCssClasses"],0,4))&&a.isBuffer)e=a,a=f;e.write(a,!0);e.write("\"\r\n           role='button'>\r\n            <span class=\"",0);a={escape:1};d=[];d.push("close-x");a.params=d;if((a=i(b,c,a,e,["getBaseCssClasses"],0,6))&&a.isBuffer)e=a,a=f;e.write(a,!0);e.write('">close</span>\r\n        </a>\r\n    ',0);return e};a=j.call(b,c,d,a,2);a.write("\r\n",0);return a};h=a.call(b,d,c,h,1);h.write('\r\n\r\n<div class="',0);c={escape:1};g=[];g.push("content");c.params=g;if((c=i(b,d,c,h,["getBaseCssClasses"],
0,11))&&c.isBuffer)h=c,c=f;h.write(c,!0);h.write('">\r\n    ',0);c={escape:1};g=[];g.push("ks-overlay-content");c.params=g;c.fn=function(c,b){b.write("\r\n        ",0);var a=c.resolve(["content"],0);b.write(a,!1);b.write("\r\n    ",0);return b};h=a.call(b,d,c,h,12);h.write("\r\n</div>",0);return h};j.TPL_NAME=f.name;j.version="5.0.0";return j});
KISSY.add("overlay/dialog",["util","./control","node","./dialog-xtpl"],function(j,d){var k=d("util"),f=d("./control"),m=d("node"),h=d("./dialog-xtpl"),f=f.extend({beforeCreateDom:function(b){k.mix(b.elAttrs,{role:"dialog","aria-labelledby":"ks-stdmod-header-"+this.get("id")})},getChildrenContainerEl:function(){return this.get("body")},__afterCreateEffectGhost:function(b){var a=this.get("body");b.all("."+this.get("prefixCls")+"stdmod-body").css({height:a.height(),width:a.width()}).html("");return b},
handleKeyDownInternal:function(b){if(this.get("escapeToClose")&&b.keyCode===m.KeyCode.ESC){if("select"!==b.target.nodeName.toLowerCase()||b.target.disabled)this.close(),b.halt()}else a:if(b.keyCode===l){var a=this.$el,d=m.all(b.target),f=a.last();if(d.equals(a)&&b.shiftKey)f[0].focus(),b.halt();else if(d.equals(f)&&!b.shiftKey)this.focus(),b.halt();else if(d.equals(a)||a.contains(d))break a;b.halt()}},_onSetVisible:function(b,a){var d=this.el;this.callSuper(b,a);if(b)this.__lastActive=d.ownerDocument.activeElement,
this.focus(),d.setAttribute("aria-hidden","false");else{d.setAttribute("aria-hidden","true");try{this.__lastActive&&this.__lastActive.focus()}catch(f){}}},_onSetBodyContent:function(b){var a;a=this.get("body");a.html(b)},_onSetHeaderContent:function(b){var a;a=this.get("header");a.html(b)},_onSetFooterContent:function(b){var a;a=this.get("footer");a.html(b)}},{ATTRS:{contentTpl:{value:h},header:{selector:function(){return"."+this.getBaseCssClass("header")}},body:{selector:function(){return"."+this.getBaseCssClass("body")}},
footer:{selector:function(){return"."+this.getBaseCssClass("footer")}},bodyStyle:{sync:0},footerStyle:{render:1},headerStyle:{render:1},headerContent:{value:"",sync:0,render:1,parse:function(){return this.get("header").html()}},bodyContent:{value:"",sync:0,render:1,parse:function(){return this.get("body").html()}},footerContent:{value:"",sync:0,render:1,parse:function(){return this.get("footer").html()}},closable:{value:!0},focusable:{value:!0},escapeToClose:{value:!0}},xclass:"dialog"}),l=m.KeyCode.TAB;
return f});
KISSY.add("overlay/dialog-xtpl",["./overlay-xtpl"],function(j,d,k,f){j=function(f,h,l){var b=this,a=b.root.nativeCommands,i=b.root.utils.callFn,j=a.each,c=a.extend,a=a.block;h.write("",0);var g={},k=[];k.push("./overlay-xtpl");g.params=k;d("./overlay-xtpl");if((c=c.call(b,f,g,h,1))&&c.isBuffer)h=c,c=l;h.write(c,!1);h.write("\r\n",0);c={escape:1};g=[];g.push("ks-overlay-content");c.params=g;c.fn=function(c,a){a.write('\r\n    <div class="',0);var e={escape:1},d=[];d.push("header");e.params=d;if((e=
i(b,c,e,a,["getBaseCssClasses"],0,3))&&e.isBuffer)a=e,e=l;a.write(e,!0);a.write('"\r\n         style="\r\n',0);var e={escape:1},d=[],g=c.resolve(["headerStyle"],0);d.push(g);e.params=d;e.fn=function(c,a){a.write("\r\n ",0);var b=c.resolve(["xindex"],0);a.write(b,!0);a.write(":",0);b=c.resolve(["this"],0);a.write(b,!0);a.write(";\r\n",0);return a};a=j.call(b,c,e,a,5);a.write('\r\n">',0);e=c.resolve(["headerContent"],0);a.write(e,!1);a.write('</div>\r\n\r\n    <div class="',0);e={escape:1};d=[];d.push("body");
e.params=d;if((e=i(b,c,e,a,["getBaseCssClasses"],0,10))&&e.isBuffer)a=e,e=l;a.write(e,!0);a.write('"\r\n         style="\r\n',0);e={escape:1};d=[];g=c.resolve(["bodyStyle"],0);d.push(g);e.params=d;e.fn=function(c,a){a.write("\r\n ",0);var b=c.resolve(["xindex"],0);a.write(b,!0);a.write(":",0);b=c.resolve(["this"],0);a.write(b,!0);a.write(";\r\n",0);return a};a=j.call(b,c,e,a,12);a.write('\r\n">',0);e=c.resolve(["bodyContent"],0);a.write(e,!1);a.write('</div>\r\n\r\n    <div class="',0);e={escape:1};
d=[];d.push("footer");e.params=d;if((e=i(b,c,e,a,["getBaseCssClasses"],0,17))&&e.isBuffer)a=e,e=l;a.write(e,!0);a.write('"\r\n         style="\r\n',0);e={escape:1};d=[];g=c.resolve(["footerStyle"],0);d.push(g);e.params=d;e.fn=function(a,c){c.write("\r\n ",0);var b=a.resolve(["xindex"],0);c.write(b,!0);c.write(":",0);b=a.resolve(["this"],0);c.write(b,!0);c.write(";\r\n",0);return c};a=j.call(b,c,e,a,19);a.write('\r\n">',0);e=c.resolve(["footerContent"],0);a.write(e,!1);a.write('</div>\r\n    <div tabindex="0"></div>\r\n',
0);return a};return h=a.call(b,f,c,h,2)};j.TPL_NAME=f.name;j.version="5.0.0";return j});
KISSY.add("overlay/popup",["./control","util","node"],function(j,d){function k(){var c=this,a=c.get("trigger"),b;c.__mouseEnterPopup=function(a){m.call(c);b=i.later(function(){l.call(c,a);b=void 0},1E3*c.get("mouseDelay"))};a.on("mouseenter",c.__mouseEnterPopup);c._mouseLeavePopup=function(){b&&(b.cancel(),b=void 0);f.call(c)};a.on("mouseleave",c._mouseLeavePopup)}function f(){var a=this,d=1E3*a.get("mouseDelay");a._hiddenTimer=i.later(function(){b.call(a)},d)}function m(){this._hiddenTimer&&(this._hiddenTimer.cancel(),
this._hiddenTimer=void 0)}function h(){var a=this;a.__clickPopup=function(d){d.preventDefault();a.get("toggle")?(a.get("visible")?b:l).call(a,d):l.call(a,d)};a.get("trigger").on("click",a.__clickPopup)}function l(a){this.set("currentTrigger",p.one(a.target));this.show()}function b(){this.set("currentTrigger",void 0);this.hide()}var a=d("./control"),i=d("util"),p=d("node");return a.extend({initializer:function(){this.get("trigger")&&("mouse"===this.get("triggerType")?k.call(this):h.call(this))},bindUI:function(){if(this.get("trigger")&&
"mouse"===this.get("triggerType"))this.$el.on("mouseleave",f,this).on("mouseenter",m,this)},destructor:function(){var a=this.$el,b=this.get("trigger");b&&(this.__clickPopup&&b.detach("click",this.__clickPopup),this.__mouseEnterPopup&&b.detach("mouseenter",this.__mouseEnterPopup),this._mouseLeavePopup&&b.detach("mouseleave",this._mouseLeavePopup));a&&a.detach("mouseleave",f,this).detach("mouseenter",m,this)}},{ATTRS:{trigger:{setter:function(a){return p.all(a)}},triggerType:{value:"click"},currentTrigger:{},
mouseDelay:{value:0.1},toggle:{value:!1}},xclass:"popup"})});
