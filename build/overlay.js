/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: Apr 29 15:11
*/
KISSY.add("overlay",["overlay/control","overlay/dialog","overlay/popup"],function(l,i){var k=i("overlay/control"),j=i("overlay/dialog"),m=i("overlay/popup");k.Dialog=j;l.Dialog=j;k.Popup=m;return l.Overlay=k});
KISSY.add("overlay/control","component/container,component/extension/shim,component/extension/align,./extension/loading,./extension/mask,./extension/overlay-effect,component/extension/content-box,./overlay-xtpl".split(","),function(l,i){var k=i("component/container"),j=i("component/extension/shim"),m=i("component/extension/align"),d=i("./extension/loading"),g=i("./extension/mask"),a=i("./extension/overlay-effect"),b=i("component/extension/content-box"),c=i("./overlay-xtpl"),q={hide:"hide",destroy:"destroy"};
return k.extend([b,j,d,m,g,a],{bindUI:function(){var b=this,a=b.get("closeBtn");if(a)a.on("click",function(a){b.close();a.preventDefault()})},close:function(){this[q[this.get("closeAction")]||"hide"]();return this}},{ATTRS:{contentEl:{},closable:{value:false,sync:0,render:1,parse:function(){return!!this.get("closeBtn")}},closeBtn:{selector:function(){return"."+this.getBaseCssClass("close")}},closeAction:{value:"hide"},focusable:{value:false},allowTextSelection:{value:true},handleGestureEvents:{value:false},
visible:{value:false},contentTpl:{value:c}},xclass:"overlay"})});
KISSY.add("overlay/extension/loading",["node"],function(l,i){function k(){}var j=i("node");k.prototype={loading:function(){this._loadingExtEl||(this._loadingExtEl=(new j('<div class="'+this.get("prefixCls")+'ext-loading" style="position: absolute;border: none;width: 100%;top: 0;left: 0;z-index: 99999;height:100%;*height: expression(this.parentNode.offsetHeight);"/>')).appendTo(this.$el));this._loadingExtEl.show()},unloading:function(){this._loadingExtEl&&this._loadingExtEl.hide()}};return k});
KISSY.add("overlay/extension/mask",["ua","node","event/gesture/tap"],function(l,i){function k(b,a){var e=b.getBaseCssClasses("mask"),e=q('<div  style="width:'+(c?"expression(KISSY.DOM.docWidth())":"100%")+";left:0;top:0;height:"+(c?"expression(KISSY.DOM.docHeight())":"100%")+";position:"+(c?"absolute":"fixed")+';" class="'+e+" "+a+'">'+(c?'<iframe style="position:absolute;left:0;top:0;background:red;width: expression(this.parentNode.offsetWidth);height: expression(this.parentNode.offsetHeight);filter:alpha(opacity=0);z-index:-1;"></iframe>':
"")+"</div>").prependTo("body");e.unselectable();e.on("mousedown",function(b){b.preventDefault()});return e}function j(){}function m(b,a){var e=b.get("maskNode"),f=b.getBaseCssClasses("mask-hidden");a?e.removeClass(f):e.addClass(f)}function d(b,a,e,f){var c=b.effect||h;m(f,e);if(c!==h){var f=b.duration,b=b.easing,g=e?1:0;a.stop(1,1);a.css("display",e?h:"block");a[c+n[c][g]](f,function(){a.css("display","")},b)}}function g(b){var a=this.get("maskNode");if(b=b.newVal){var e=Number(this.$el.css("z-index"));
isNaN(e)||a.css("z-index",e)}d(this.get("mask"),a,b,this)}var a=i("ua"),b=i("node"),c=6===a.ie,q=b.all,p=i("event/gesture/tap").TAP;j.ATTRS={mask:{value:!1},maskNode:{}};var h="none",n={fade:["Out","In"],slide:["Up","Down"]};j.prototype={__renderUI:function(){this.get("mask")&&this.set("maskNode",k(this,this.get("visible")?"":this.getBaseCssClasses("mask-hidden")))},__bindUI:function(){var b,a;if(a=this.get("mask")){b=this.get("maskNode");if(a.closeOnClick)b.on(p,this.close,this);this.on("afterVisibleChange",
g)}},__destructor:function(){var b;(b=this.get("maskNode"))&&b.remove()}};return j});
KISSY.add("overlay/extension/overlay-effect",[],function(l){function i(a){var b=a.$el.clone(!0);b.css({visibility:"hidden",overflow:"hidden"}).addClass(a.get("prefixCls")+"overlay-ghost");return a.__afterCreateEffectGhost(b)}function k(a,b){a.__effectGhost&&a.__effectGhost.stop(1,1);var c=a.$el,g=l.all,d=a.get("effect"),h=g(d.target),g=d.duration,j={width:h.width(),height:h.height()},k=h.offset(),s={width:c.width(),height:c.height()},e=c.offset(),f,o=i(a),m=d.easing;o.insertAfter(c);b?(h=j,f=k,j=
s,k=e):(h=s,f=e);o.offset(k);l.mix(j,{left:o.css("left"),top:o.css("top")});c.css("visibility","hidden");o.css(h);o.offset(f);a.__effectGhost=o;o.css("visibility","visible");o.animate(j,{Anim:d.Anim,duration:g,easing:m,complete:function(){a.__effectGhost=null;o.remove();c.css("visibility","")}})}function j(a,b){var c=a.$el,d=a.get("effect"),i=d.effect||"none",h=d.target;if("none"!==i||h)if(h)k(a,b);else{var h=d.duration,j=d.easing,m=b?1:0;c.stop(1,1);c.css({visibility:"visible",display:b?"none":"block"});
c[i+g[i][m]]({duration:h,Anim:d.Anim,complete:function(){c.css({display:"block",visibility:""})},easing:j})}}function m(a){j(this,a.newVal)}function d(){}var g={fade:["Out","In"],slide:["Up","Down"]};d.ATTRS={effect:{value:{effect:"",target:null,duration:0.5,easing:"easeOut"},setter:function(a){var b=a.effect;"string"===typeof b&&!g[b]&&(a.effect="")}}};d.prototype={__afterCreateEffectGhost:function(a){return a},__bindUI:function(){this.on("afterVisibleChange",m,this)}};return d});
KISSY.add("overlay/overlay-xtpl",[],function(l,i,k,j){i=function(i,d,g,a){var b=this,c=b.nativeCommands,j=b.utils.callFn,k=c["if"],c=c.block;if("5.0.0"!==l.version)throw Error("current xtemplate file("+b.name+")(v5.0.0) need to be recompiled using current kissy(v"+l.version+")!");d.write("",0);var h={escape:1},n=[];n.push("ks-overlay-closable");h.params=n;h.fn=function(c,d){d.write("\r\n    ",0);var e={escape:1},f=[],h=c.resolve(["closable"],0);f.push(h);e.params=f;e.fn=function(c,f){f.write('\r\n        <a href="javascript:void(\'close\')"\r\n           class="',
0);var e={escape:1},g=[];g.push("close");e.params=g;if((e=j(b,c,e,f,["getBaseCssClasses"],0,4))&&e.isBuffer)f=e,e=a;f.write(e,!0);f.write("\"\r\n           role='button'>\r\n            <span class=\"",0);e={escape:1};g=[];g.push("close-x");e.params=g;if((e=j(b,c,e,f,["getBaseCssClasses"],0,6))&&e.isBuffer)f=e,e=a;f.write(e,!0);f.write('">close</span>\r\n        </a>\r\n    ',0);return f};d=k.call(b,c,e,d,2,g);d.write("\r\n",0);return d};d=c.call(b,i,h,d,1,g);d.write('\r\n\r\n<div class="',0);h={escape:1};
n=[];n.push("content");h.params=n;if((h=j(b,i,h,d,["getBaseCssClasses"],0,11))&&h.isBuffer)d=h,h=a;d.write(h,!0);d.write('">\r\n    ',0);h={escape:1};n=[];n.push("ks-overlay-content");h.params=n;h.fn=function(b,a){a.write("\r\n        ",0);var e=b.resolve(["content"],0);a.write(e,!1);a.write("\r\n    ",0);return a};d=c.call(b,i,h,d,12,g);d.write("\r\n</div>",0);return d};i.TPL_NAME=j.name;return i});
KISSY.add("overlay/dialog",["./control","node","./dialog-xtpl"],function(l,i){var k=i("./control"),j=i("node"),m=i("./dialog-xtpl"),k=k.extend({beforeCreateDom:function(g){l.mix(g.elAttrs,{role:"dialog","aria-labelledby":"ks-stdmod-header-"+this.get("id")})},getChildrenContainerEl:function(){return this.get("body")},__afterCreateEffectGhost:function(g){var a=this.get("body");g.all("."+this.get("prefixCls")+"stdmod-body").css({height:a.height(),width:a.width()}).html("");return g},handleKeyDownInternal:function(g){if(this.get("escapeToClose")&&
g.keyCode===j.KeyCode.ESC){if("select"!==g.target.nodeName.toLowerCase()||g.target.disabled)this.close(),g.halt()}else a:if(g.keyCode===d){var a=this.$el,b=j.all(g.target),c=a.last();if(b.equals(a)&&g.shiftKey)c[0].focus(),g.halt();else if(b.equals(c)&&!g.shiftKey)this.focus(),g.halt();else if(b.equals(a)||a.contains(b))break a;g.halt()}},_onSetVisible:function(g,a){var b=this.el;this.callSuper(g,a);if(g)this.__lastActive=b.ownerDocument.activeElement,this.focus(),b.setAttribute("aria-hidden","false");
else{b.setAttribute("aria-hidden","true");try{this.__lastActive&&this.__lastActive.focus()}catch(c){}}},_onSetBodyContent:function(g){var a;a=this.get("body");a.html(g)},_onSetHeaderContent:function(g){var a;a=this.get("header");a.html(g)},_onSetFooterContent:function(g){var a;a=this.get("footer");a.html(g)}},{ATTRS:{contentTpl:{value:m},header:{selector:function(){return"."+this.getBaseCssClass("header")}},body:{selector:function(){return"."+this.getBaseCssClass("body")}},footer:{selector:function(){return"."+
this.getBaseCssClass("footer")}},bodyStyle:{value:{},sync:0},footerStyle:{value:{},render:1},headerStyle:{value:{},render:1},headerContent:{value:"",sync:0,render:1,parse:function(){return this.get("header").html()}},bodyContent:{value:"",sync:0,render:1,parse:function(){return this.get("body").html()}},footerContent:{value:"",sync:0,render:1,parse:function(){return this.get("footer").html()}},closable:{value:!0},focusable:{value:!0},escapeToClose:{value:!0}},xclass:"dialog"}),d=j.KeyCode.TAB;return k});
KISSY.add("overlay/dialog-xtpl",["./overlay-xtpl"],function(l,i,k,j){k=function(j,d,g,a){var b=this,c=b.nativeCommands,k=b.utils.callFn,p=c.each,h=c.extend,c=c.block;if("5.0.0"!==l.version)throw Error("current xtemplate file("+b.name+")(v5.0.0) need to be recompiled using current kissy(v"+l.version+")!");d.write("",0);var n={},r=[];r.push("./overlay-xtpl");n.params=r;i("./overlay-xtpl");if((h=h.call(b,j,n,d,1,g))&&h.isBuffer)d=h,h=a;d.write(h,!1);d.write("\r\n",0);h={escape:1};n=[];n.push("ks-overlay-content");
h.params=n;h.fn=function(c,e){e.write('\r\n    <div class="',0);var f={escape:1},d=[];d.push("header");f.params=d;if((f=k(b,c,f,e,["getBaseCssClasses"],0,3))&&f.isBuffer)e=f,f=a;e.write(f,!0);e.write('"\r\n         style="\r\n',0);var f={escape:1},d=[],h=c.resolve(["headerStyle"],0);d.push(h);f.params=d;f.fn=function(b,a){a.write("\r\n ",0);var c=b.resolve(["xindex"],0);a.write(c,!0);a.write(":",0);c=b.resolve(["this"],0);a.write(c,!0);a.write(";\r\n",0);return a};e=p.call(b,c,f,e,5,g);e.write('\r\n">',
0);f=c.resolve(["headerContent"],0);e.write(f,!1);e.write('</div>\r\n\r\n    <div class="',0);f={escape:1};d=[];d.push("body");f.params=d;if((f=k(b,c,f,e,["getBaseCssClasses"],0,10))&&f.isBuffer)e=f,f=a;e.write(f,!0);e.write('"\r\n         style="\r\n',0);f={escape:1};d=[];h=c.resolve(["bodyStyle"],0);d.push(h);f.params=d;f.fn=function(b,a){a.write("\r\n ",0);var c=b.resolve(["xindex"],0);a.write(c,!0);a.write(":",0);c=b.resolve(["this"],0);a.write(c,!0);a.write(";\r\n",0);return a};e=p.call(b,c,
f,e,12,g);e.write('\r\n">',0);f=c.resolve(["bodyContent"],0);e.write(f,!1);e.write('</div>\r\n\r\n    <div class="',0);f={escape:1};d=[];d.push("footer");f.params=d;if((f=k(b,c,f,e,["getBaseCssClasses"],0,17))&&f.isBuffer)e=f,f=a;e.write(f,!0);e.write('"\r\n         style="\r\n',0);f={escape:1};d=[];h=c.resolve(["footerStyle"],0);d.push(h);f.params=d;f.fn=function(b,a){a.write("\r\n ",0);var c=b.resolve(["xindex"],0);a.write(c,!0);a.write(":",0);c=b.resolve(["this"],0);a.write(c,!0);a.write(";\r\n",
0);return a};e=p.call(b,c,f,e,19,g);e.write('\r\n">',0);f=c.resolve(["footerContent"],0);e.write(f,!1);e.write('</div>\r\n    <div tabindex="0"></div>\r\n',0);return e};return d=c.call(b,j,h,d,2,g)};k.TPL_NAME=j.name;return k});
KISSY.add("overlay/popup",["./control"],function(l,i){function k(){var b=this,a=b.get("trigger"),d;b.__mouseEnterPopup=function(a){m.call(b);d=l.later(function(){g.call(b,a);d=void 0},1E3*b.get("mouseDelay"))};a.on("mouseenter",b.__mouseEnterPopup);b._mouseLeavePopup=function(){d&&(d.cancel(),d=void 0);j.call(b)};a.on("mouseleave",b._mouseLeavePopup)}function j(){var b=this,c=1E3*b.get("mouseDelay");b._hiddenTimer=l.later(function(){a.call(b)},c)}function m(){this._hiddenTimer&&(this._hiddenTimer.cancel(),
this._hiddenTimer=void 0)}function d(){var b=this;b.__clickPopup=function(c){c.preventDefault();b.get("toggle")?(b.get("visible")?a:g).call(b,c):g.call(b,c)};b.get("trigger").on("click",b.__clickPopup)}function g(b){this.set("currentTrigger",l.one(b.target));this.show()}function a(){this.set("currentTrigger",void 0);this.hide()}return i("./control").extend({initializer:function(){this.get("trigger")&&("mouse"===this.get("triggerType")?k.call(this):d.call(this))},bindUI:function(){if(this.get("trigger")&&
"mouse"===this.get("triggerType"))this.$el.on("mouseleave",j,this).on("mouseenter",m,this)},destructor:function(){var b=this.$el,a=this.get("trigger");a&&(this.__clickPopup&&a.detach("click",this.__clickPopup),this.__mouseEnterPopup&&a.detach("mouseenter",this.__mouseEnterPopup),this._mouseLeavePopup&&a.detach("mouseleave",this._mouseLeavePopup));b&&b.detach("mouseleave",j,this).detach("mouseenter",m,this)}},{ATTRS:{trigger:{setter:function(a){return l.all(a)}},triggerType:{value:"click"},currentTrigger:{},
mouseDelay:{value:0.1},toggle:{value:!1}},xclass:"popup"})});
