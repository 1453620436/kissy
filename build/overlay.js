/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: Apr 23 15:50
*/
KISSY.add("overlay",["overlay/control","overlay/dialog","overlay/popup"],function(k,h){var j=h("overlay/control"),i=h("overlay/dialog"),n=h("overlay/popup");j.Dialog=i;k.Dialog=i;j.Popup=n;return k.Overlay=j});
KISSY.add("overlay/control","component/container,component/extension/shim,component/extension/align,./extension/loading,./extension/mask,./extension/overlay-effect,component/extension/content-box,./overlay-xtpl".split(","),function(k,h){var j=h("component/container"),i=h("component/extension/shim"),n=h("component/extension/align"),f=h("./extension/loading"),g=h("./extension/mask"),c=h("./extension/overlay-effect"),b=h("component/extension/content-box"),d=h("./overlay-xtpl"),a={hide:"hide",destroy:"destroy"};
return j.extend([b,i,f,n,g,c],{bindUI:function(){var b=this,c=b.get("closeBtn");if(c)c.on("click",function(c){b.close();c.preventDefault()})},close:function(){this[a[this.get("closeAction")]||"hide"]();return this}},{ATTRS:{contentEl:{},closable:{value:false,sync:0,render:1,parse:function(){return!!this.get("closeBtn")}},closeBtn:{selector:function(){return"."+this.getBaseCssClass("close")}},closeAction:{value:"hide"},focusable:{value:false},allowTextSelection:{value:true},handleGestureEvents:{value:false},
visible:{value:false},contentTpl:{value:d}},xclass:"overlay"})});
KISSY.add("overlay/extension/loading",["node"],function(k,h){function j(){}var i=h("node");j.prototype={loading:function(){this._loadingExtEl||(this._loadingExtEl=(new i('<div class="'+this.get("prefixCls")+'ext-loading" style="position: absolute;border: none;width: 100%;top: 0;left: 0;z-index: 99999;height:100%;*height: expression(this.parentNode.offsetHeight);"/>')).appendTo(this.$el));this._loadingExtEl.show()},unloading:function(){this._loadingExtEl&&this._loadingExtEl.hide()}};return j});
KISSY.add("overlay/extension/mask",["ua","node","event/gesture/tap"],function(k,h){function j(b,c){var l=b.getBaseCssClasses("mask"),l=a('<div  style="width:'+(d?"expression(KISSY.DOM.docWidth())":"100%")+";left:0;top:0;height:"+(d?"expression(KISSY.DOM.docHeight())":"100%")+";position:"+(d?"absolute":"fixed")+';" class="'+l+" "+c+'">'+(d?'<iframe style="position:absolute;left:0;top:0;background:red;width: expression(this.parentNode.offsetWidth);height: expression(this.parentNode.offsetHeight);filter:alpha(opacity=0);z-index:-1;"></iframe>':
"")+"</div>").prependTo("body");l.unselectable();l.on("mousedown",function(b){b.preventDefault()});return l}function i(){}function n(b,c){var l=b.get("maskNode"),e=b.getBaseCssClasses("mask-hidden");c?l.removeClass(e):l.addClass(e)}function f(b,c,l,e){var a=b.effect||p;n(e,l);if(a!==p){var e=b.duration,b=b.easing,d=l?1:0;c.stop(1,1);c.css("display",l?p:"block");c[a+m[a][d]](e,function(){c.css("display","")},b)}}function g(b){var c=this.get("maskNode");if(b=b.newVal){var a=Number(this.$el.css("z-index"));
isNaN(a)||c.css("z-index",a)}f(this.get("mask"),c,b,this)}var c=h("ua"),b=h("node"),d=6===c.ie,a=b.all,q=h("event/gesture/tap").TAP;i.ATTRS={mask:{value:!1},maskNode:{}};var p="none",m={fade:["Out","In"],slide:["Up","Down"]};i.prototype={__renderUI:function(){this.get("mask")&&this.set("maskNode",j(this,this.get("visible")?"":this.getBaseCssClasses("mask-hidden")))},__bindUI:function(){var b,c;if(c=this.get("mask")){b=this.get("maskNode");if(c.closeOnClick)b.on(q,this.close,this);this.on("afterVisibleChange",
g)}},__destructor:function(){var b;(b=this.get("maskNode"))&&b.remove()}};return i});
KISSY.add("overlay/extension/overlay-effect",[],function(k){function h(c){var b=c.$el.clone(!0);b.css({visibility:"hidden",overflow:"hidden"}).addClass(c.get("prefixCls")+"overlay-ghost");return c.__afterCreateEffectGhost(b)}function j(c,b){c.__effectGhost&&c.__effectGhost.stop(1,1);var d=c.$el,a=k.all,g=c.get("effect"),f=a(g.target),a=g.duration,i={width:f.width(),height:f.height()},j=f.offset(),s={width:d.width(),height:d.height()},l=d.offset(),e,o=h(c),n=g.easing;o.insertAfter(d);b?(f=i,e=j,i=
s,j=l):(f=s,e=l);o.offset(j);k.mix(i,{left:o.css("left"),top:o.css("top")});d.css("visibility","hidden");o.css(f);o.offset(e);c.__effectGhost=o;o.css("visibility","visible");o.animate(i,{Anim:g.Anim,duration:a,easing:n,complete:function(){c.__effectGhost=null;o.remove();d.css("visibility","")}})}function i(c,b){var d=c.$el,a=c.get("effect"),f=a.effect||"none",h=a.target;if("none"!==f||h)if(h)j(c,b);else{var h=a.duration,i=a.easing,n=b?1:0;d.stop(1,1);d.css({visibility:"visible",display:b?"none":"block"});
d[f+g[f][n]]({duration:h,Anim:a.Anim,complete:function(){d.css({display:"block",visibility:""})},easing:i})}}function n(c){i(this,c.newVal)}function f(){}var g={fade:["Out","In"],slide:["Up","Down"]};f.ATTRS={effect:{value:{effect:"",target:null,duration:0.5,easing:"easeOut"},setter:function(c){var b=c.effect;"string"===typeof b&&!g[b]&&(c.effect="")}}};f.prototype={__afterCreateEffectGhost:function(c){return c},__bindUI:function(){this.on("afterVisibleChange",n,this)}};return f});
KISSY.add("overlay/overlay-xtpl",[],function(k,h,j,i){h=function(h,f,g,c){var b=this,d=b.nativeCommands,a=b.utils;if("5.0.0"!==k.version)throw Error("current xtemplate file("+b.name+")(v5.0.0) need to be recompiled using current kissy(v"+k.version+")!");var i=a.callCommand,j=d["if"],d=d.block;f.write("");var a={escape:1},m=[];m.push("ks-overlay-closable");a.params=m;a.fn=function(a,d){d.write("\r\n    ");var l={escape:1},e=[],f=a.resolve(["closable"]);e.push(f);l.params=e;l.fn=function(a,d){d.write('\r\n        <a href="javascript:void(\'close\')"\r\n           class="');
var e={escape:1},g=[];g.push("close");e.params=g;if((e=i(b,a,e,d,"getBaseCssClasses",4))&&e.isBuffer)d=e,e=c;d.write(e,!0);d.write("\"\r\n           role='button'>\r\n            <span class=\"");e={escape:1};g=[];g.push("close-x");e.params=g;if((e=i(b,a,e,d,"getBaseCssClasses",6))&&e.isBuffer)d=e,e=c;d.write(e,!0);d.write('">close</span>\r\n        </a>\r\n    ');return d};d=j.call(b,a,l,d,2,g);d.write("\r\n");return d};f=d.call(b,h,a,f,1,g);f.write('\r\n\r\n<div class="');a={escape:1};m=[];m.push("content");
a.params=m;if((a=i(b,h,a,f,"getBaseCssClasses",11))&&a.isBuffer)f=a,a=c;f.write(a,!0);f.write('">\r\n    ');a={escape:1};m=[];m.push("ks-overlay-content");a.params=m;a.fn=function(b,c){c.write("\r\n        ");var d=b.resolve(["content"]);c.write(d,!1);c.write("\r\n    ");return c};f=d.call(b,h,a,f,12,g);f.write("\r\n</div>");return f};h.TPL_NAME=i.name;return h});
KISSY.add("overlay/dialog",["./control","node","./dialog-xtpl"],function(k,h){var j=h("./control"),i=h("node"),n=h("./dialog-xtpl"),j=j.extend({beforeCreateDom:function(g){k.mix(g.elAttrs,{role:"dialog","aria-labelledby":"ks-stdmod-header-"+this.get("id")})},getChildrenContainerEl:function(){return this.get("body")},__afterCreateEffectGhost:function(g){var c=this.get("body");g.all("."+this.get("prefixCls")+"stdmod-body").css({height:c.height(),width:c.width()}).html("");return g},handleKeyDownInternal:function(g){if(this.get("escapeToClose")&&
g.keyCode===i.KeyCode.ESC){if("select"!==g.target.nodeName.toLowerCase()||g.target.disabled)this.close(),g.halt()}else a:if(g.keyCode===f){var c=this.$el,b=i.all(g.target),d=c.last();if(b.equals(c)&&g.shiftKey)d[0].focus(),g.halt();else if(b.equals(d)&&!g.shiftKey)this.focus(),g.halt();else if(b.equals(c)||c.contains(b))break a;g.halt()}},_onSetVisible:function(g,c){var b=this.el;this.callSuper(g,c);if(g)this.__lastActive=b.ownerDocument.activeElement,this.focus(),b.setAttribute("aria-hidden","false");
else{b.setAttribute("aria-hidden","true");try{this.__lastActive&&this.__lastActive.focus()}catch(d){}}},_onSetBodyContent:function(g){var c;c=this.get("body");c.html(g)},_onSetHeaderContent:function(g){var c;c=this.get("header");c.html(g)},_onSetFooterContent:function(g){var c;c=this.get("footer");c.html(g)}},{ATTRS:{contentTpl:{value:n},header:{selector:function(){return"."+this.getBaseCssClass("header")}},body:{selector:function(){return"."+this.getBaseCssClass("body")}},footer:{selector:function(){return"."+
this.getBaseCssClass("footer")}},bodyStyle:{value:{},sync:0},footerStyle:{value:{},render:1},headerStyle:{value:{},render:1},headerContent:{value:"",sync:0,render:1,parse:function(){return this.get("header").html()}},bodyContent:{value:"",sync:0,render:1,parse:function(){return this.get("body").html()}},footerContent:{value:"",sync:0,render:1,parse:function(){return this.get("footer").html()}},closable:{value:!0},focusable:{value:!0},escapeToClose:{value:!0}},xclass:"dialog"}),f=i.KeyCode.TAB;return j});
KISSY.add("overlay/dialog-xtpl",["./overlay-xtpl"],function(k,h,j,i){j=function(j,f,g,c){var b=this,d=b.nativeCommands,a=b.utils;if("5.0.0"!==k.version)throw Error("current xtemplate file("+b.name+")(v5.0.0) need to be recompiled using current kissy(v"+k.version+")!");var q=a.callCommand,p=d.each,a=d.extend,d=d.block;f.write("");var m={},r=[];r.push("./overlay-xtpl");m.params=r;h("./overlay-xtpl");m.params[0]=i.resolve(m.params[0]);if((a=a.call(b,j,m,f,1,g))&&a.isBuffer)f=a,a=c;f.write(a,!1);f.write("\r\n");
a={escape:1};m=[];m.push("ks-overlay-content");a.params=m;a.fn=function(d,a){a.write('\r\n    <div class="');var e={escape:1},f=[];f.push("header");e.params=f;if((e=q(b,d,e,a,"getBaseCssClasses",3))&&e.isBuffer)a=e,e=c;a.write(e,!0);a.write('"\r\n         style="\r\n');var e={escape:1},f=[],h=d.resolve(["headerStyle"]);f.push(h);e.params=f;e.fn=function(b,a){a.write("\r\n ");var c=b.resolve(["xindex"]);a.write(c,!0);a.write(":");c=b.resolve(["this"]);a.write(c,!0);a.write(";\r\n");return a};a=p.call(b,
d,e,a,5,g);a.write('\r\n">');e=d.resolve(["headerContent"]);a.write(e,!1);a.write('</div>\r\n\r\n    <div class="');e={escape:1};f=[];f.push("body");e.params=f;if((e=q(b,d,e,a,"getBaseCssClasses",10))&&e.isBuffer)a=e,e=c;a.write(e,!0);a.write('"\r\n         style="\r\n');e={escape:1};f=[];h=d.resolve(["bodyStyle"]);f.push(h);e.params=f;e.fn=function(b,a){a.write("\r\n ");var c=b.resolve(["xindex"]);a.write(c,!0);a.write(":");c=b.resolve(["this"]);a.write(c,!0);a.write(";\r\n");return a};a=p.call(b,
d,e,a,12,g);a.write('\r\n">');e=d.resolve(["bodyContent"]);a.write(e,!1);a.write('</div>\r\n\r\n    <div class="');e={escape:1};f=[];f.push("footer");e.params=f;if((e=q(b,d,e,a,"getBaseCssClasses",17))&&e.isBuffer)a=e,e=c;a.write(e,!0);a.write('"\r\n         style="\r\n');e={escape:1};f=[];h=d.resolve(["footerStyle"]);f.push(h);e.params=f;e.fn=function(b,a){a.write("\r\n ");var c=b.resolve(["xindex"]);a.write(c,!0);a.write(":");c=b.resolve(["this"]);a.write(c,!0);a.write(";\r\n");return a};a=p.call(b,
d,e,a,19,g);a.write('\r\n">');e=d.resolve(["footerContent"]);a.write(e,!1);a.write('</div>\r\n    <div tabindex="0"></div>\r\n');return a};return f=d.call(b,j,a,f,2,g)};j.TPL_NAME=i.name;return j});
KISSY.add("overlay/popup",["./control"],function(k,h){function j(){var b=this,c=b.get("trigger"),a;b.__mouseEnterPopup=function(c){n.call(b);a=k.later(function(){g.call(b,c);a=void 0},1E3*b.get("mouseDelay"))};c.on("mouseenter",b.__mouseEnterPopup);b._mouseLeavePopup=function(){a&&(a.cancel(),a=void 0);i.call(b)};c.on("mouseleave",b._mouseLeavePopup)}function i(){var b=this,d=1E3*b.get("mouseDelay");b._hiddenTimer=k.later(function(){c.call(b)},d)}function n(){this._hiddenTimer&&(this._hiddenTimer.cancel(),
this._hiddenTimer=void 0)}function f(){var b=this;b.__clickPopup=function(d){d.preventDefault();b.get("toggle")?(b.get("visible")?c:g).call(b,d):g.call(b,d)};b.get("trigger").on("click",b.__clickPopup)}function g(b){this.set("currentTrigger",k.one(b.target));this.show()}function c(){this.set("currentTrigger",void 0);this.hide()}return h("./control").extend({initializer:function(){this.get("trigger")&&("mouse"===this.get("triggerType")?j.call(this):f.call(this))},bindUI:function(){if(this.get("trigger")&&
"mouse"===this.get("triggerType"))this.$el.on("mouseleave",i,this).on("mouseenter",n,this)},destructor:function(){var b=this.$el,c=this.get("trigger");c&&(this.__clickPopup&&c.detach("click",this.__clickPopup),this.__mouseEnterPopup&&c.detach("mouseenter",this.__mouseEnterPopup),this._mouseLeavePopup&&c.detach("mouseleave",this._mouseLeavePopup));b&&b.detach("mouseleave",i,this).detach("mouseenter",n,this)}},{ATTRS:{trigger:{setter:function(b){return k.all(b)}},triggerType:{value:"click"},currentTrigger:{},
mouseDelay:{value:0.1},toggle:{value:!1}},xclass:"popup"})});
