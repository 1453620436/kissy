/*
Copyright 2013, KISSY v1.40dev
MIT Licensed
build time: Aug 30 01:36
*/
KISSY.add("scroll-view/base/render",function(k,l,n,o){var k=k.Features,i,l={syncUI:function(){var d=this.control,g=d.el,h=d.contentEl,e=d.$contentEl,a=h.offsetHeight,h=h.offsetWidth,b=g.clientHeight,c=g.clientWidth;d.scrollHeight=a;d.scrollWidth=h;d.clientHeight=b;d.clientWidth=c;g=d.allowScroll={};a>b&&(g.top=1);h>c&&(g.left=1);d.minScroll={left:0,top:0};var p,f;d.maxScroll={left:p=h-c,top:f=a-b};delete d.scrollStep;b=d.get("snap");a=d.get("scrollLeft");h=d.get("scrollTop");if(b){var m=e.offset(),
e=d.pages="string"==typeof b?e.all(b):e.children(),b=d.get("pageIndex"),j=d.pagesOffset=[];e.each(function(a,b){var c=a.offset(),d=c.left-m.left,c=c.top-m.top;d<=p&&c<=f&&(j[b]={left:d,top:c,index:b})});if(b){d.scrollToPage(b);return}}d.scrollToWithBounds({left:a,top:h})},_onSetScrollLeft:function(d){this.control.contentEl.style.left=-d+"px"},_onSetScrollTop:function(d){this.control.contentEl.style.top=-d+"px"}};k.isTransformSupported()&&(i=k.getTransformProperty(),l._onSetScrollLeft=function(d){var g=
this.control;g.contentEl.style[i]="translate3d("+-d+"px,"+-g.get("scrollTop")+"px,0)"},l._onSetScrollTop=function(d){var g=this.control;g.contentEl.style[i]="translate3d("+-g.get("scrollLeft")+"px,"+-d+"px,0)"});return n.getDefaultRender().extend([o],l,{name:"ScrollViewRender"})},{requires:["node","component/container","component/extension/content-render"]});
KISSY.add("scroll-view/base",function(k,l,n,o,i){function d(){var a=this.el,b=a.scrollTop,c=a.scrollLeft;b&&this.set("scrollTop",b+this.get("scrollTop"));c&&this.set("scrollLeft",c+this.get("scrollLeft"));a.scrollTop=a.scrollLeft=0}var g=k.all,h=k.Features.isTouchEventSupported(),e=l.KeyCode;return n.extend({bindUI:function(){this.$el.on("mousewheel",this.handleMouseWheel,this).on("scroll",d,this)},handleKeyDownInternal:function(a){var b=g(a.target),c=b.nodeName();if("input"==c||"textarea"==c||"select"==
c||b.hasAttr("contenteditable"))return i;var a=a.keyCode,c=this.getScrollStep(),b=i,d=this.allowScroll.left;if(this.allowScroll.top){var f=c.top,m=this.clientHeight,j=this.get("scrollTop");a==e.DOWN?(this.scrollToWithBounds({top:j+f}),b=!0):a==e.UP?(this.scrollToWithBounds({top:j-f}),b=!0):a==e.PAGE_DOWN?(this.scrollToWithBounds({top:j+m}),b=!0):a==e.PAGE_UP&&(this.scrollToWithBounds({top:j-m}),b=!0)}d&&(c=c.left,d=this.get("scrollLeft"),a==e.RIGHT?(this.scrollToWithBounds({left:d+c}),b=!0):a==e.LEFT&&
(this.scrollToWithBounds({left:d-c}),b=!0));return b},getScrollStep:function(){if(this.scrollStep)return this.scrollStep;var a=g(this.get("el")[0].ownerDocument),b=this.clientHeight,c=this.clientWidth;return this.scrollStep={top:Math.max(0.7*b*b/a.height(),20),left:Math.max(0.7*c*c/a.width(),20)}},handleMouseWheel:function(a){if(!this.get("disabled")){var b,c,d=this.getScrollStep(),f,g=this.maxScroll,j=this.minScroll;if((f=a.deltaY)&&this.allowScroll.top){var e=this.get("scrollTop");b=g.top;c=j.top;
e<=c&&0<f||e>=b&&0>f||(this.scrollToWithBounds({top:e-a.deltaY*d.top}),h&&a.preventDefault())}if((f=a.deltaX)&&this.allowScroll.left)e=this.get("scrollLeft"),b=g.left,c=j.left,e<=c&&0<f||e>=b&&0>f||(this.scrollToWithBounds({left:e-a.deltaX*d.left}),h&&a.preventDefault())}},isAxisEnabled:function(a){return this.allowScroll["x"==a?"left":"top"]},stopAnimation:function(){this.$contentEl.stop();this.scrollToWithBounds({left:this.get("scrollLeft"),top:this.get("scrollTop")})},_uiSetPageIndex:function(a){this.scrollToPage(a)},
_getPageIndexFromXY:function(a,b,c){var d=this.pagesOffset.concat([]),f=b?"left":"top";d.sort(function(a,c){return a[f]-c[f]});if(0<c)for(b=0;b<d.length;b++){if(c=d[b],c[f]>=a)return c.index}else for(b=d.length-1;0<=b;b--)if(c=d[b],c[f]<=a)return c.index;return i},scrollToPage:function(a,b){var c;if((c=this.pagesOffset)&&c[a])this.set("pageIndex",a),this.scrollTo(c[a],b)},scrollToWithBounds:function(a,b){var c=this.maxScroll,d=this.minScroll;a.left&&(a.left=Math.min(Math.max(a.left,d.left),c.left));
a.top&&(a.top=Math.min(Math.max(a.top,d.top),c.top));this.scrollTo(a,b)},scrollTo:function(a,b){var c=this,d=a.left,f=a.top;if(b){var e=c.get("scrollLeft"),g=c.get("scrollTop");c.$contentEl.animate({xx:{fx:{frame:function(a,b){d!==i&&c.set("scrollLeft",e+b.pos*(d-e));f!==i&&c.set("scrollTop",g+b.pos*(f-g))}}}},b)}else d!==i&&c.set("scrollLeft",d),f!==i&&c.set("scrollTop",f)}},{ATTRS:{contentEl:{},scrollLeft:{view:1,value:0},scrollTop:{view:1,value:0},focusable:{value:!h},allowTextSelection:{value:!0},
handleMouseEvents:{value:!1},snap:{value:!1},snapDuration:{value:0.3},snapEasing:{value:"easeOut"},pageIndex:{value:0},xrender:{value:o}},xclass:"scroll-view"})},{requires:["node","component/container","./base/render"]});
