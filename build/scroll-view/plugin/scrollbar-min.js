/*
Copyright 2014, KISSY v1.50
MIT Licensed
build time: Mar 5 22:11
*/
KISSY.add("scroll-view/plugin/scrollbar/scrollbar-xtpl",[],function(){var f=function(e,f){var c,h=f.escapeHtml,g=this.utils.callCommand;c='<div id="ks-scrollbar-arrow-up-';var d=e.resolve(["id"]);c+=h(d);c+='"\n        class="';var d={},b=[],i=e.resolve(["axis"]);b.push(i+"-arrow-up");d.params=b;d=g(this,e,d,"getBaseCssClasses",2);c+=h(d);c+='">\n    <a href="javascript:void(\'up\')">up</a>\n</div>\n<div id="ks-scrollbar-arrow-down-';d=e.resolve(["id"]);c+=h(d);c+='"\n        class="';d={};b=[];i=
e.resolve(["axis"]);b.push(i+"-arrow-down");d.params=b;d=g(this,e,d,"getBaseCssClasses",6);c+=h(d);c+='">\n    <a href="javascript:void(\'down\')">down</a>\n</div>\n<div id="ks-scrollbar-track-';d=e.resolve(["id"]);c+=h(d);c+='"\n     class="';d={};b=[];i=e.resolve(["axis"]);b.push(i+"-track");d.params=b;d=g(this,e,d,"getBaseCssClasses",10);c+=h(d);c+='">\n<div id="ks-scrollbar-drag-';d=e.resolve(["id"]);c+=h(d);c+='"\n     class="';d={};b=[];i=e.resolve(["axis"]);b.push(i+"-drag");d.params=b;d=g(this,
e,d,"getBaseCssClasses",12);c+=h(d);c+='">\n<div class="';d={};b=[];i=e.resolve(["axis"]);b.push(i+"-drag-top");d.params=b;d=g(this,e,d,"getBaseCssClasses",13);c+=h(d);c+='">\n</div>\n<div class="';d={};b=[];i=e.resolve(["axis"]);b.push(i+"-drag-center");d.params=b;d=g(this,e,d,"getBaseCssClasses",15);c+=h(d);c+='">\n</div>\n<div class="';d={};b=[];i=e.resolve(["axis"]);b.push(i+"-drag-bottom");d.params=b;g=g(this,e,d,"getBaseCssClasses",17);c+=h(g);return c+'">\n</div>\n</div>\n</div>'};f.TPL_NAME=
"scroll-view/sub-modules/plugin/scrollbar/src/scrollbar/scrollbar.xtpl.html";return f});
KISSY.add("scroll-view/plugin/scrollbar/render",["component/control","./scrollbar-xtpl"],function(f,e){var k=e("component/control"),c=e("./scrollbar-xtpl"),h=f.Feature.isTransform3dSupported(),g={beforeCreateDom:function(b,d){b.elCls.push(b.prefixCls+"scrollbar-"+b.axis);f.mix(d,{dragEl:"#ks-scrollbar-drag-{id}",downBtn:"#ks-scrollbar-arrow-down-{id}",upBtn:"#ks-scrollbar-arrow-up-{id}",trackEl:"#ks-scrollbar-track-{id}"})},createDom:function(){var b=this.control;b.$dragEl=b.get("dragEl");b.$trackEl=
b.get("trackEl");b.$downBtn=b.get("downBtn");b.$upBtn=b.get("upBtn");b.dragEl=b.$dragEl[0];b.trackEl=b.$trackEl[0];b.downBtn=b.$downBtn[0];b.upBtn=b.$upBtn[0]},_onSetDragHeight:function(b){this.control.dragEl.style.height=b+"px"},_onSetDragWidth:function(b){this.control.dragEl.style.width=b+"px"},_onSetDragLeft:function(b){this.control.dragEl.style.left=b+"px"},_onSetDragTop:function(b){this.control.dragEl.style.top=b+"px"}};if(!1!==f.Feature.getVendorCssPropPrefix("transform")){var d=f.Feature.getVendorCssPropName("transform");
g._onSetDragLeft=function(b){this.control.dragEl.style[d]="translateX("+b+"px) translateY("+this.control.get("dragTop")+"px)"+(h?" translateZ(0)":"")};g._onSetDragTop=function(b){this.control.dragEl.style[d]="translateX("+this.control.get("dragLeft")+"px) translateY("+b+"px)"+(h?" translateZ(0)":"")}}return k.getDefaultRender().extend(g,{ATTRS:{contentTpl:{value:c}}})});
KISSY.add("scroll-view/plugin/scrollbar/control",["node","component/control","./render"],function(f,e){function k(a){a.preventDefault()}function c(a){a.stopPropagation();a.isTouch||a.preventDefault();this.get("disabled")||(this.startMousePos=a[this.pageXyProperty],this.startScroll=this.scrollView.get(this.scrollProperty),n.on(j.move,h,this).on(j.end,g,this))}function h(a){var b=this.scrollView,d={};d[this.scrollType]=this.startScroll+(a[this.pageXyProperty]-this.startMousePos)/this.trackElSize*this.scrollLength;
b.scrollToWithBounds(d)}function g(){n.detach(j.move,h,this).detach(j.end,g,this)}function d(){var a=this.scrollView,b=this.trackEl,d=this.scrollWHProperty,c=this.whProperty,e=this.clientWHProperty,g=this.dragWHProperty;a.allowScroll[this.scrollType]?(this.scrollLength=a[d],b=this.trackElSize="width"===c?b.offsetWidth:b.offsetHeight,a=a[e]/this.scrollLength,a*=b,this.set(g,a),this.barSize=a,o(this),this.set("visible",!0)):this.set("visible",!1)}function b(a){this.set("disabled",a.newVal)}function i(){this.hideFn&&
p(this)}function l(){var a=this.scrollView;a.allowScroll[this.scrollType]&&(m(this),this.set("visible",!0),this.hideFn&&!a.isScrolling&&p(this),o(this))}function r(a){function b(){var a={};a[e]=d.get(c)+h*g;d.scrollToWithBounds(a)}if(!this.get("disabled")){a.halt();var d=this.scrollView,c=this.scrollProperty,e=this.scrollType,g=d.getScrollStep()[this.scrollType],a=a.target,h=a===this.downBtn||this.$downBtn.contains(a)?1:-1;clearInterval(this.mouseInterval);this.mouseInterval=setInterval(b,100);b()}}
function s(a){if(!this.get("disabled")){var b=a.target,d=this.$dragEl;if(!(this.dragEl===b||d.contains(b))){var b=this.scrollType,d=this.scrollView,c=Math.max(0,(a[this.pageXyProperty]-this.$trackEl.offset()[b]-this.barSize/2)/this.trackElSize),e={};e[b]=c*this.scrollLength;d.scrollToWithBounds(e);a.halt()}}}function t(){clearInterval(this.mouseInterval)}function o(a){var b=a.scrollType,d=a.scrollView,c=a.dragLTProperty,e=a.dragWHProperty,g=a.trackElSize,h=a.barSize,i=a.scrollLength,f=d.get(a.scrollProperty),
l=d.minScroll[b],b=d.maxScroll[b];f>b?(g*=b/i,a.set(e,h-(f-b)),a.set(c,g+h-a.get(e))):f<l?(g*=l/i,a.set(e,h-(l-f)),a.set(c,g)):(a.set(c,f/i*g),a.set(e,h))}function p(a){m(a);a.hideTimer=setTimeout(a.hideFn,1E3*a.get("hideDelay"))}function m(a){a.hideTimer&&(clearTimeout(a.hideTimer),a.hideTimer=null)}var q=e("node"),n=q.all(document),u=e("component/control"),v=e("./render"),j=q.Gesture;return u.extend({initializer:function(){var a=this.scrollType="x"===this.get("axis")?"left":"top",b=f.ucfirst(a);
this.pageXyProperty="left"===a?"pageX":"pageY";a=this.whProperty="left"===a?"width":"height";a=f.ucfirst(a);this.afterScrollChangeEvent="afterScroll"+b+"Change";this.scrollProperty="scroll"+b;this.dragWHProperty="drag"+a;this.dragLTProperty="drag"+b;this.clientWHProperty="client"+a;this.scrollWHProperty="scroll"+a;this.scrollView=this.get("scrollView")},bindUI:function(){var a=this,e=a.get("autoHide"),g=a.scrollView;e?a.hideFn=f.bind(a.hide,a):(f.each([a.$downBtn,a.$upBtn],function(b){b.on(j.start,
r,a).on(j.end,t,a)}),a.$trackEl.on(j.start,s,a),a.$dragEl.on("dragstart",k).on(j.start,c,a));g.on(a.afterScrollChangeEvent+".ks-scrollbar",l,a).on("scrollTouchEnd.ks-scrollbar",i,a).on("afterDisabledChange.ks-scrollbar",b,a).on("reflow.ks-scrollbar",d,a)},syncUI:function(){d.call(this)},destructor:function(){this.scrollView.detach(".ks-scrollbar");m(this)}},{ATTRS:{minLength:{value:20},scrollView:{},axis:{view:1},autoHide:{value:f.UA.ios},visible:{valueFn:function(){return!this.get("autoHide")}},
hideDelay:{value:0.1},dragWidth:{setter:function(a){var b=this.get("minLength");return a<b?b:a},view:1},dragHeight:{setter:function(a){var b=this.get("minLength");return a<b?b:a},view:1},dragLeft:{view:1,value:0},dragTop:{view:1,value:0},dragEl:{},downBtn:{},upBtn:{},trackEl:{},focusable:{value:!1},xrender:{value:v}},xclass:"scrollbar"})});
KISSY.add("scroll-view/plugin/scrollbar",["base","./scrollbar/control"],function(f,e){function k(){var c=this.scrollView,d=this.get("minLength"),b=this.get("autoHideX"),e=this.get("autoHideY"),f;!this.scrollBarX&&c.allowScroll.left&&(f={axis:"x",scrollView:c,elBefore:c.$contentEl},void 0!==d&&(f.minLength=d),void 0!==b&&(f.autoHide=b),this.scrollBarX=(new h(f)).render());!this.scrollBarY&&c.allowScroll.top&&(f={axis:"y",scrollView:c,elBefore:c.$contentEl},void 0!==d&&(f.minLength=d),void 0!==e&&(f.autoHide=
e),this.scrollBarY=(new h(f)).render())}var c=e("base"),h=e("./scrollbar/control");return c.extend({pluginId:this.getName(),pluginBindUI:function(c){this.scrollView=c;c.on("reflow",k,this)},pluginDestructor:function(c){this.scrollBarX&&(this.scrollBarX.destroy(),this.scrollBarX=null);this.scrollBarY&&(this.scrollBarY.destroy(),this.scrollBarY=null);c.detach("reflow",k,this)}},{ATTRS:{minLength:{},autoHideX:{},autoHideY:{}}})});
