/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: Apr 10 18:49
*/
KISSY.add("scroll-view/plugin/scrollbar/scrollbar-xtpl",[],function(i,e,j,k){e=function(f,c,g,e){g=this.utils;if("5.0.0"!==i.version)throw Error("current xtemplate file("+this.name+")(v5.0.0) need to be recompiled using current kissy(v"+i.version+")!");g=g.callCommand;c.write('<div class="');var a={escape:1},d=[],h=f.resolve(["axis"]);d.push(h+"-arrow-up");a.params=d;if((a=g(this,f,a,c,"getBaseCssClasses",1))&&a.isBuffer)c=a,a=e;c.write(a,!0);c.write('">\n    <a href="javascript:void(\'up\')">up</a>\n</div>\n<div class="');
a={escape:1};d=[];h=f.resolve(["axis"]);d.push(h+"-arrow-down");a.params=d;if((a=g(this,f,a,c,"getBaseCssClasses",4))&&a.isBuffer)c=a,a=e;c.write(a,!0);c.write('">\n    <a href="javascript:void(\'down\')">down</a>\n</div>\n<div class="');a={escape:1};d=[];h=f.resolve(["axis"]);d.push(h+"-track");a.params=d;if((a=g(this,f,a,c,"getBaseCssClasses",7))&&a.isBuffer)c=a,a=e;c.write(a,!0);c.write('">\n<div class="');a={escape:1};d=[];h=f.resolve(["axis"]);d.push(h+"-drag");a.params=d;if((a=g(this,f,a,c,
"getBaseCssClasses",8))&&a.isBuffer)c=a,a=e;c.write(a,!0);c.write('">\n<div class="');a={escape:1};d=[];h=f.resolve(["axis"]);d.push(h+"-drag-top");a.params=d;if((a=g(this,f,a,c,"getBaseCssClasses",9))&&a.isBuffer)c=a,a=e;c.write(a,!0);c.write('">\n</div>\n<div class="');a={escape:1};d=[];h=f.resolve(["axis"]);d.push(h+"-drag-center");a.params=d;if((a=g(this,f,a,c,"getBaseCssClasses",11))&&a.isBuffer)c=a,a=e;c.write(a,!0);c.write('">\n</div>\n<div class="');a={escape:1};d=[];h=f.resolve(["axis"]);
d.push(h+"-drag-bottom");a.params=d;if((f=g(this,f,a,c,"getBaseCssClasses",13))&&f.isBuffer)c=f,f=e;c.write(f,!0);c.write('">\n</div>\n</div>\n</div>');return c};e.TPL_NAME=k.name;return e});
KISSY.add("scroll-view/plugin/scrollbar/control",["ua","component/control","event/gesture/base","event/gesture/drag","./scrollbar-xtpl"],function(i,e){function j(b){b.preventDefault()}function k(b){b.stopPropagation();this.startScroll=this.scrollView.get(this.scrollProperty)}function f(b){var a=this.scrollView,c={};c[this.scrollType]=this.startScroll+("pageX"===this.pageXyProperty?b.deltaX:b.deltaY)/this.trackElSize*this.scrollLength;a.scrollToWithBounds(c)}function c(){var b=this.scrollView,a=this.trackEl,
c=this.scrollWHProperty,d=this.whProperty,f=this.clientWHProperty,e=this.dragWHProperty;b.allowScroll[this.scrollType]?(this.scrollLength=b[c],a=this.trackElSize="width"===d?a.offsetWidth:a.offsetHeight,b=b[f]/this.scrollLength,b*=a,this.set(e,b),this.barSize=b,p(this),this.set("visible",!0)):this.set("visible",!1)}function g(b){this.set("disabled",b.newVal)}function u(){this.hideFn&&q(this)}function a(){var b=this.scrollView;b.allowScroll[this.scrollType]&&(m(this),this.set("visible",!0),this.hideFn&&
!b.isScrolling&&q(this),p(this))}function d(b){function a(){var b={};b[f]=c.get(d)+g*e;c.scrollToWithBounds(b)}b.halt();var c=this.scrollView,d=this.scrollProperty,f=this.scrollType,e=c.getScrollStep()[this.scrollType],b=b.target,g=b===this.downBtn||this.$downBtn.contains(b)?1:-1;clearInterval(this.mouseInterval);this.mouseInterval=setInterval(a,100);a()}function h(b){var a=b.target,c=this.$dragEl;if(!(this.dragEl===a||c.contains(a))){var a=this.scrollType,c=this.scrollView,d=Math.max(0,(b[this.pageXyProperty]-
this.$trackEl.offset()[a]-this.barSize/2)/this.trackElSize),f={};f[a]=d*this.scrollLength;c.scrollToWithBounds(f);b.halt()}}function v(){clearInterval(this.mouseInterval)}function p(b){var a=b.scrollType,c=b.scrollView,d=b.dragLTProperty,f=b.dragWHProperty,e=b.trackElSize,g=b.barSize,h=b.scrollLength,i=c.get(b.scrollProperty),j=c.minScroll[a],a=c.maxScroll[a];i>a?(e*=a/h,b.set(f,g-(i-a)),b.set(d,e+g-b.get(f))):i<j?(e*=j/h,b.set(f,g-(j-i)),b.set(d,e)):(b.set(d,i/h*e),b.set(f,g))}function q(b){m(b);
b.hideTimer=setTimeout(b.hideFn,1E3*b.get("hideDelay"))}function m(b){b.hideTimer&&(clearTimeout(b.hideTimer),b.hideTimer=null)}var w=e("ua"),x=e("component/control"),n=e("event/gesture/base"),r=e("event/gesture/drag"),y=e("./scrollbar-xtpl"),l=i.Feature,s=l.isTransform3dSupported(),l=l.getCssVendorInfo("transform"),o={initializer:function(){var b=this.scrollType="x"===this.get("axis")?"left":"top",a=i.ucfirst(b);this.pageXyProperty="left"===b?"pageX":"pageY";b=this.whProperty="left"===b?"width":
"height";b=i.ucfirst(b);this.afterScrollChangeEvent="afterScroll"+a+"Change";this.scrollProperty="scroll"+a;this.dragWHProperty="drag"+b;this.dragLTProperty="drag"+a;this.clientWHProperty="client"+b;this.scrollWHProperty="scroll"+b;this.scrollView=this.get("scrollView")},beforeCreateDom:function(b){b.elCls.push(b.prefixCls+"scrollbar-"+b.axis)},createDom:function(){this.$dragEl=this.get("dragEl");this.$trackEl=this.get("trackEl");this.$downBtn=this.get("downBtn");this.$upBtn=this.get("upBtn");this.dragEl=
this.$dragEl[0];this.trackEl=this.$trackEl[0];this.downBtn=this.$downBtn[0];this.upBtn=this.$upBtn[0]},bindUI:function(){var b=this.scrollView;this.get("autoHide")&&(this.hideFn=i.bind(this.hide,this));b.on(this.afterScrollChangeEvent+".ks-scrollbar",a,this).on("scrollTouchEnd.ks-scrollbar",u,this).on("afterDisabledChange.ks-scrollbar",g,this).on("reflow.ks-scrollbar",c,this)},syncUI:function(){c.call(this)},_onSetDragHeight:function(b){this.dragEl.style.height=b+"px"},_onSetDragWidth:function(b){this.dragEl.style.width=
b+"px"},_onSetDragLeft:function(b){this.dragEl.style.left=b+"px"},_onSetDragTop:function(b){this.dragEl.style.top=b+"px"},_onSetDisabled:function(b){var a=this,c=b?"detach":"on";a.get("autoHide")||(a.$dragEl[c]("dragstart mousedown",j)[c](r.DRAG_START,k,a)[c](r.DRAG,f,a),i.each([a.$downBtn,a.$upBtn],function(b){b[c](n.START,d,a)[c](n.END,v,a)}),a.$trackEl[c](n.START,h,a))},destructor:function(){this.scrollView.detach(".ks-scrollbar");m(this)}};if(l){var t=l.propertyName;o._onSetDragLeft=function(b){this.dragEl.style[t]=
"translateX("+b+"px) translateY("+this.get("dragTop")+"px)"+(s?" translateZ(0)":"")};o._onSetDragTop=function(b){this.dragEl.style[t]="translateX("+this.get("dragLeft")+"px) translateY("+b+"px)"+(s?" translateZ(0)":"")}}return x.extend(o,{ATTRS:{minLength:{value:20},scrollView:{},axis:{render:1},autoHide:{value:w.ios},visible:{valueFn:function(){return!this.get("autoHide")}},hideDelay:{value:0.1},dragWidth:{setter:function(b){var a=this.get("minLength");return b<a?a:b},render:1},dragHeight:{setter:function(a){var c=
this.get("minLength");return a<c?c:a},render:1},dragLeft:{render:1,value:0},dragTop:{render:1,value:0},dragEl:{selector:function(){return"."+this.getBaseCssClass("drag")}},downBtn:{selector:function(){return"."+this.getBaseCssClass("arrow-down")}},upBtn:{selector:function(){return"."+this.getBaseCssClass("arrow-up")}},trackEl:{selector:function(){return"."+this.getBaseCssClass("track")}},focusable:{value:!1},contentTpl:{value:y}},xclass:"scrollbar"})});
KISSY.add("scroll-view/plugin/scrollbar",["base","./scrollbar/control"],function(i,e){function j(){var c=this.scrollView,e=this.get("minLength"),i=this.get("autoHideX"),a=this.get("autoHideY"),d;!this.scrollBarX&&c.allowScroll.left&&(d={axis:"x",scrollView:c,elBefore:c.$contentEl},void 0!==e&&(d.minLength=e),void 0!==i&&(d.autoHide=i),this.scrollBarX=(new f(d)).render());!this.scrollBarY&&c.allowScroll.top&&(d={axis:"y",scrollView:c,elBefore:c.$contentEl},void 0!==e&&(d.minLength=e),void 0!==a&&(d.autoHide=
a),this.scrollBarY=(new f(d)).render())}var k=e("base"),f=e("./scrollbar/control");return k.extend({pluginId:this.getName(),pluginBindUI:function(c){this.scrollView=c;c.on("reflow",j,this)},pluginDestructor:function(c){this.scrollBarX&&(this.scrollBarX.destroy(),this.scrollBarX=null);this.scrollBarY&&(this.scrollBarY.destroy(),this.scrollBarY=null);c.detach("reflow",j,this)}},{ATTRS:{minLength:{},autoHideX:{},autoHideY:{}}})});
