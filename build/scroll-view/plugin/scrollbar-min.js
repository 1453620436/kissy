/*
Copyright 2014, KISSY v1.50
MIT Licensed
build time: Feb 18 15:47
*/
KISSY.add("scroll-view/plugin/scrollbar/scrollbar-xtpl",[],function(){return function(e){var b;b=this.config.utils;var f=b.renderOutput,g=b.getProperty,h=b.runInlineCommand,d=b.getPropertyOrRunCommand;b='<div id="ks-scrollbar-arrow-up-';var c=d(this,e,{},"id",0,1);b+=f(c,!0);b+='"\n        class="';var c={},a=[],j=g(this,e,"axis",0,2);a.push(j+"-arrow-up");c.params=a;c=h(this,e,c,"getBaseCssClasses",2);b+=f(c,!0);b+='">\n    <a href="javascript:void(\'up\')">up</a>\n</div>\n<div id="ks-scrollbar-arrow-down-';
c=d(this,e,{},"id",0,5);b+=f(c,!0);b+='"\n        class="';c={};a=[];j=g(this,e,"axis",0,6);a.push(j+"-arrow-down");c.params=a;c=h(this,e,c,"getBaseCssClasses",6);b+=f(c,!0);b+='">\n    <a href="javascript:void(\'down\')">down</a>\n</div>\n<div id="ks-scrollbar-track-';c=d(this,e,{},"id",0,9);b+=f(c,!0);b+='"\n     class="';c={};a=[];j=g(this,e,"axis",0,10);a.push(j+"-track");c.params=a;c=h(this,e,c,"getBaseCssClasses",10);b+=f(c,!0);b+='">\n<div id="ks-scrollbar-drag-';d=d(this,e,{},"id",0,11);b+=
f(d,!0);b+='"\n     class="';d={};c=[];a=g(this,e,"axis",0,12);c.push(a+"-drag");d.params=c;d=h(this,e,d,"getBaseCssClasses",12);b+=f(d,!0);b+='">\n<div class="';d={};c=[];a=g(this,e,"axis",0,13);c.push(a+"-drag-top");d.params=c;d=h(this,e,d,"getBaseCssClasses",13);b+=f(d,!0);b+='">\n</div>\n<div class="';d={};c=[];a=g(this,e,"axis",0,15);c.push(a+"-drag-center");d.params=c;d=h(this,e,d,"getBaseCssClasses",15);b+=f(d,!0);b+='">\n</div>\n<div class="';d={};c=[];g=g(this,e,"axis",0,17);c.push(g+"-drag-bottom");
d.params=c;e=h(this,e,d,"getBaseCssClasses",17);b+=f(e,!0);return b+'">\n</div>\n</div>\n</div>'}});
KISSY.add("scroll-view/plugin/scrollbar/render",["component/control","./scrollbar-xtpl"],function(e,b){var f=b("component/control"),g=b("./scrollbar-xtpl"),h=e.Feature.isTransform3dSupported(),d={beforeCreateDom:function(a,b){a.elCls.push(a.prefixCls+"scrollbar-"+a.axis);e.mix(b,{dragEl:"#ks-scrollbar-drag-{id}",downBtn:"#ks-scrollbar-arrow-down-{id}",upBtn:"#ks-scrollbar-arrow-up-{id}",trackEl:"#ks-scrollbar-track-{id}"})},createDom:function(){var a=this.control;a.$dragEl=a.get("dragEl");a.$trackEl=
a.get("trackEl");a.$downBtn=a.get("downBtn");a.$upBtn=a.get("upBtn");a.dragEl=a.$dragEl[0];a.trackEl=a.$trackEl[0];a.downBtn=a.$downBtn[0];a.upBtn=a.$upBtn[0]},syncUI:function(){var a=this.control,b=a.get("scrollView"),c=a.trackEl,d=a.scrollWHProperty,k=a.whProperty,e=a.clientWHProperty,l=a.dragWHProperty;a.scrollView=b;b.allowScroll[a.scrollType]?(a.scrollLength=b[d],c=a.trackElSize="width"===k?c.offsetWidth:c.offsetHeight,b=b[e]/a.scrollLength,b*=c,a.set(l,b),a.barSize=b,this.syncOnScrollChange(),
a.set("visible",!0)):a.set("visible",!1)},syncOnScrollChange:function(){var a=this.control,b=a.scrollType,c=a.scrollView,d=a.dragLTProperty,k=a.dragWHProperty,e=a.trackElSize,l=a.barSize,h=a.scrollLength,f=c.get(a.scrollProperty),g=c.minScroll[b],b=c.maxScroll[b];f>b?(e*=b/h,a.set(k,l-(f-b)),a.set(d,e+l-a.get(k))):f<g?(e*=g/h,a.set(k,l-(g-f)),a.set(d,e)):(a.set(d,f/h*e),a.set(k,l))},_onSetDragHeight:function(a){this.control.dragEl.style.height=a+"px"},_onSetDragWidth:function(a){this.control.dragEl.style.width=
a+"px"},_onSetDragLeft:function(a){this.control.dragEl.style.left=a+"px"},_onSetDragTop:function(a){this.control.dragEl.style.top=a+"px"}};if(!1!==e.Feature.getVendorCssPropPrefix("transform")){var c=e.Feature.getVendorCssPropName("transform");d._onSetDragLeft=function(a){this.control.dragEl.style[c]="translateX("+a+"px) translateY("+this.control.get("dragTop")+"px)"+(h?" translateZ(0)":"")};d._onSetDragTop=function(a){this.control.dragEl.style[c]="translateX("+this.control.get("dragLeft")+"px) translateY("+
a+"px)"+(h?" translateZ(0)":"")}}return f.getDefaultRender().extend(d,{ATTRS:{contentTpl:{value:g}}})});
KISSY.add("scroll-view/plugin/scrollbar/control",["node","component/control","./render"],function(e,b){function f(a){a.preventDefault()}function g(b){b.stopPropagation();b.isTouch||b.preventDefault();this.get("disabled")||(this.startMousePos=b[this.pageXyProperty],this.startScroll=this.scrollView.get(this.scrollProperty),a.on(i.move,h,this).on(i.end,d,this))}function h(a){var b=this.scrollView,c={};c[this.scrollType]=this.startScroll+(a[this.pageXyProperty]-this.startMousePos)/this.trackElSize*this.scrollLength;
b.scrollToWithBounds(c)}function d(){a.detach(i.move,h,this).detach(i.end,d,this)}var c=b("node"),a=c.all(document),j=b("component/control"),m=b("./render"),i=c.Gesture;return j.extend({initializer:function(){var a=this.scrollType="x"===this.get("axis")?"left":"top",b=e.ucfirst(a);this.pageXyProperty="left"===a?"pageX":"pageY";a=this.whProperty="left"===a?"width":"height";a=e.ucfirst(a);this.afterScrollChangeEvent="afterScroll"+b+"Change";this.scrollProperty="scroll"+b;this.dragWHProperty="drag"+
a;this.dragLTProperty="drag"+b;this.clientWHProperty="client"+a;this.scrollWHProperty="scroll"+a},bindUI:function(){var a=this,b=a.get("autoHide"),c=a.get("scrollView");b?a.hideFn=e.bind(a.hide,a):(e.each([a.$downBtn,a.$upBtn],function(b){b.on(i.start,a.onUpDownBtnMouseDown,a).on(i.end,a.onUpDownBtnMouseUp,a)}),a.$trackEl.on(i.start,a.onTrackElMouseDown,a),a.$dragEl.on("dragstart",f).on(i.start,g,a),c.on(a.afterScrollChangeEvent+".ks-scrollbar",a.afterScrollChange,a).on("scrollEnd.ks-scrollbar",a.onScrollEnd,
a).on("afterDisabledChange",a.onScrollViewDisabled,a))},destructor:function(){this.get("scrollView").detach(".ks-scrollbar");this.clearHideTimer()},onScrollViewDisabled:function(a){this.set("disabled",a.newVal)},startHideTimer:function(){this.clearHideTimer();this.hideTimer=setTimeout(this.hideFn,1E3*this.get("hideDelay"))},clearHideTimer:function(){this.hideTimer&&(clearTimeout(this.hideTimer),this.hideTimer=null)},onUpDownBtnMouseDown:function(a){function b(){var a={};a[d]=c.get(e)+h*f;c.scrollToWithBounds(a)}
if(!this.get("disabled")){a.halt();var c=this.scrollView,e=this.scrollProperty,d=this.scrollType,f=c.getScrollStep()[this.scrollType],a=a.target,h=a===this.downBtn||this.$downBtn.contains(a)?1:-1;clearInterval(this.mouseInterval);this.mouseInterval=setInterval(b,100);b()}},onTrackElMouseDown:function(a){if(!this.get("disabled")){var b=a.target,c=this.$dragEl;if(!(this.dragEl===b||c.contains(b))){var b=this.scrollType,c=this.scrollView,e=Math.max(0,(a[this.pageXyProperty]-this.$trackEl.offset()[b]-
this.barSize/2)/this.trackElSize),d={};d[b]=e*this.scrollLength;c.scrollToWithBounds(d);a.halt()}}},onUpDownBtnMouseUp:function(){clearInterval(this.mouseInterval)},onScrollEnd:function(){this.hideFn&&this.startHideTimer()},afterScrollChange:function(){var a=this.scrollView;a.allowScroll[this.scrollType]&&(this.clearHideTimer(),this.set("visible",!0),this.hideFn&&!a.isScrolling&&this.startHideTimer(),this.view.syncOnScrollChange())},_onSetDisabled:function(a){this.dd&&this.dd.set("disabled",a)}},
{ATTRS:{minLength:{value:20},scrollView:{},axis:{view:1},autoHide:{value:e.UA.ios},visible:{valueFn:function(){return!this.get("autoHide")}},hideDelay:{value:0.1},dragWidth:{setter:function(a){var b=this.get("minLength");return a<b?b:a},view:1},dragHeight:{setter:function(a){var b=this.get("minLength");return a<b?b:a},view:1},dragLeft:{view:1,value:0},dragTop:{view:1,value:0},dragEl:{},downBtn:{},upBtn:{},trackEl:{},focusable:{value:!1},xrender:{value:m}},xclass:"scrollbar"})});
KISSY.add("scroll-view/plugin/scrollbar",["base","./scrollbar/control"],function(e,b){var f=b("base"),g=b("./scrollbar/control");return f.extend({pluginId:this.getName(),pluginSyncUI:function(b){var d=this.get("minLength"),c=this.get("autoHideX"),a=this.get("autoHideY"),f={scrollView:b,elBefore:b.$contentEl};void 0!==d&&(f.minLength=d);this.scrollBarX?this.scrollBarX.sync():b.allowScroll.left&&(d={axis:"x"},void 0!==c&&(f.autoHide=c),this.scrollBarX=(new g(e.merge(f,d))).render());this.scrollBarY?
this.scrollBarY.sync():b.allowScroll.top&&(d={axis:"y"},void 0!==a&&(f.autoHide=a),this.scrollBarY=(new g(e.merge(f,d))).render())},pluginDestructor:function(){this.scrollBarX&&(this.scrollBarX.destroy(),this.scrollBarX=null);this.scrollBarY&&(this.scrollBarY.destroy(),this.scrollBarY=null)}},{ATTRS:{minLength:{},autoHideX:{},autoHideY:{}}})});
