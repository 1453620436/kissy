/*
Copyright 2013, KISSY v1.50
MIT Licensed
build time: Dec 2 17:28
*/
KISSY.add("scroll-view/plugin/scrollbar/scrollbar-xtpl",[],function(){return function(e,d,g){var d=this.config.utils,f=d.getExpression,h=d.getPropertyOrRunCommand,d='<div id="ks-scrollbar-arrow-up-',c=h(this,e,{},"id",0,1,g,!1),d=d+f(c,!0),d=d+'"\n        class="',c={},i=[],a=h(this,e,{},"axis",0,2,g,!0);i.push(a+"-arrow-up");c.params=i;c=h(this,e,c,"getBaseCssClasses",0,2,!0,g);d=d+c+'">\n    <a href="javascript:void(\'up\')">up</a>\n</div>\n<div id="ks-scrollbar-arrow-down-';c=h(this,e,{},"id",
0,5,g,!1);d+=f(c,!0);d+='"\n        class="';c={};i=[];a=h(this,e,{},"axis",0,6,g,!0);i.push(a+"-arrow-down");c.params=i;c=h(this,e,c,"getBaseCssClasses",0,6,!0,g);d=d+c+'">\n    <a href="javascript:void(\'down\')">down</a>\n</div>\n<div id="ks-scrollbar-track-';c=h(this,e,{},"id",0,9,g,!1);d+=f(c,!0);d+='"\n     class="';c={};i=[];a=h(this,e,{},"axis",0,10,g,!0);i.push(a+"-track");c.params=i;c=h(this,e,c,"getBaseCssClasses",0,10,!0,g);d=d+c+'">\n<div id="ks-scrollbar-drag-';c=h(this,e,{},"id",0,
11,g,!1);d+=f(c,!0);d+='"\n     class="';f={};c=[];i=h(this,e,{},"axis",0,12,g,!0);c.push(i+"-drag");f.params=c;f=h(this,e,f,"getBaseCssClasses",0,12,!0,g);d=d+f+'">\n<div class="';f={};c=[];i=h(this,e,{},"axis",0,13,g,!0);c.push(i+"-drag-top");f.params=c;f=h(this,e,f,"getBaseCssClasses",0,13,!0,g);d=d+f+'">\n</div>\n<div class="';f={};c=[];i=h(this,e,{},"axis",0,15,g,!0);c.push(i+"-drag-center");f.params=c;f=h(this,e,f,"getBaseCssClasses",0,15,!0,g);d=d+f+'">\n</div>\n<div class="';f={};c=[];i=h(this,
e,{},"axis",0,17,g,!0);c.push(i+"-drag-bottom");f.params=c;e=h(this,e,f,"getBaseCssClasses",0,17,!0,g);return d+e+'">\n</div>\n</div>\n</div>'}});
KISSY.add("scroll-view/plugin/scrollbar/render",["component/control","./scrollbar-xtpl"],function(e,d){var g=d("component/control"),f=d("./scrollbar-xtpl"),h=e.Features.isTransform3dSupported(),c=e.Features.isTransformSupported(),i={beforeCreateDom:function(b,a){b.elCls.push(b.prefixCls+"scrollbar-"+b.axis);e.mix(a,{dragEl:"#ks-scrollbar-drag-{id}",downBtn:"#ks-scrollbar-arrow-down-{id}",upBtn:"#ks-scrollbar-arrow-up-{id}",trackEl:"#ks-scrollbar-track-{id}"})},createDom:function(){var b=this.control;
b.$dragEl=b.get("dragEl");b.$trackEl=b.get("trackEl");b.$downBtn=b.get("downBtn");b.$upBtn=b.get("upBtn");b.dragEl=b.$dragEl[0];b.trackEl=b.$trackEl[0];b.downBtn=b.$downBtn[0];b.upBtn=b.$upBtn[0]},syncUI:function(){var b=this.control,a=b.get("scrollView"),c=b.trackEl,d=b.scrollWHProperty,e=b.whProperty,f=b.clientWHProperty,h=b.dragWHProperty;b.scrollView=a;a.allowScroll[b.scrollType]?(b.scrollLength=a[d],c=b.trackElSize="width"===e?c.offsetWidth:c.offsetHeight,a=a[f]/b.scrollLength,a*=c,b.set(h,a),
b.barSize=a,this.syncOnScrollChange(),b.set("visible",!0)):b.set("visible",!1)},syncOnScrollChange:function(){var b=this.control,a=b.scrollType,c=b.scrollView,d=b.dragLTProperty,e=b.dragWHProperty,f=b.trackElSize,h=b.barSize,i=b.scrollLength,g=c.get(b.scrollProperty),j=c.minScroll[a],a=c.maxScroll[a];g>a?(f*=a/i,b.set(e,h-(g-a)),b.set(d,f+h-b.get(e))):g<j?(f*=j/i,b.set(e,h-(j-g)),b.set(d,f)):(b.set(d,g/i*f),b.set(e,h))},_onSetDragHeight:function(a){this.control.dragEl.style.height=a+"px"},_onSetDragWidth:function(a){this.control.dragEl.style.width=
a+"px"},_onSetDragLeft:function(a){this.control.dragEl.style.left=a+"px"},_onSetDragTop:function(a){this.control.dragEl.style.top=a+"px"}},a=e.Features.getTransformProperty();c&&(i._onSetDragLeft=function(b){this.control.dragEl.style[a]="translateX("+b+"px)"+(h?" translateZ(0)":"")},i._onSetDragTop=function(b){this.control.dragEl.style[a]="translateY("+b+"px)"+(h?" translateZ(0)":"")});return g.getDefaultRender().extend(i,{ATTRS:{contentTpl:{value:f}}})});
KISSY.add("scroll-view/plugin/scrollbar/control",["node","component/control","./render"],function(e,d){var g=d("node"),f=d("component/control"),h=d("./render"),c=g.Gesture,i=!e.Features.isTouchGestureSupported();return f.extend({initializer:function(){var a=this.scrollType="x"===this.get("axis")?"left":"top",b=e.ucfirst(a);this.pageXyProperty="left"===a?"pageX":"pageY";a=this.whProperty="left"===a?"width":"height";a=e.ucfirst(a);this.afterScrollChangeEvent="afterScroll"+b+"Change";this.scrollProperty=
"scroll"+b;this.dragWHProperty="drag"+a;this.dragLTProperty="drag"+b;this.clientWHProperty="client"+a;this.scrollWHProperty="scroll"+a},bindUI:function(){var a=this,b=a.get("autoHide"),d=a.get("scrollView");b?a.hideFn=e.bind(a.hide,a):(e.each([a.$downBtn,a.$upBtn],function(b){b.on(c.start,a.onUpDownBtnMouseDown,a).on(c.end,a.onUpDownBtnMouseUp,a)}),a.$trackEl.on(c.start,a.onTrackElMouseDown,a),i&&e.use("dd",function(b,c){a.dd=(new c.Draggable({node:a.$dragEl,disabled:a.get("disabled"),groups:!1,halt:!0})).on("drag",
a.onDrag,a).on("dragstart",a.onDragStart,a)}));d.on(a.afterScrollChangeEvent+".ks-scrollbar",a.afterScrollChange,a).on("scrollEnd.ks-scrollbar",a.onScrollEnd,a).on("afterDisabledChange",a.onScrollViewDisabled,a)},destructor:function(){this.get("scrollView").detach(".ks-scrollbar");this.clearHideTimer()},onScrollViewDisabled:function(a){this.set("disabled",a.newVal)},onDragStart:function(){var a=this.scrollView;this.startMousePos=this.dd.get("startMousePos")[this.scrollType];this.startScroll=a.get(this.scrollProperty)},
onDrag:function(a){var b=this.scrollView,c={};c[this.scrollType]=this.startScroll+(a[this.pageXyProperty]-this.startMousePos)/this.trackElSize*this.scrollLength;b.scrollToWithBounds(c)},startHideTimer:function(){this.clearHideTimer();this.hideTimer=setTimeout(this.hideFn,1E3*this.get("hideDelay"))},clearHideTimer:function(){this.hideTimer&&(clearTimeout(this.hideTimer),this.hideTimer=null)},onUpDownBtnMouseDown:function(a){function b(){var a={};a[e]=c.get(d)+h*f;c.scrollToWithBounds(a)}if(!this.get("disabled")){a.halt();
var c=this.scrollView,d=this.scrollProperty,e=this.scrollType,f=c.getScrollStep()[this.scrollType],a=a.target,h=a===this.downBtn||this.$downBtn.contains(a)?1:-1;clearInterval(this.mouseInterval);this.mouseInterval=setInterval(b,100);b()}},onTrackElMouseDown:function(a){if(!this.get("disabled")){var b=a.target,c=this.$dragEl;if(!(this.dragEl===b||c.contains(b))){var b=this.scrollType,c=this.scrollView,d=Math.max(0,(a[this.pageXyProperty]-this.$trackEl.offset()[b]-this.barSize/2)/this.trackElSize),
e={};e[b]=d*this.scrollLength;c.scrollToWithBounds(e);a.halt()}}},onUpDownBtnMouseUp:function(){clearInterval(this.mouseInterval)},onScrollEnd:function(){this.hideFn&&this.startHideTimer()},afterScrollChange:function(){var a=this.scrollView;a.allowScroll[this.scrollType]&&(this.clearHideTimer(),this.set("visible",!0),this.hideFn&&!a.isScrolling&&this.startHideTimer(),this.view.syncOnScrollChange())},_onSetDisabled:function(a){this.dd&&this.dd.set("disabled",a)}},{ATTRS:{minLength:{value:20},scrollView:{},
axis:{view:1},autoHide:{value:e.UA.ios},visible:{valueFn:function(){return!this.get("autoHide")}},hideDelay:{value:0.1},dragWidth:{setter:function(a){var b=this.get("minLength");return a<b?b:a},view:1},dragHeight:{setter:function(a){var b=this.get("minLength");return a<b?b:a},view:1},dragLeft:{view:1},dragTop:{view:1},dragEl:{},downBtn:{},upBtn:{},trackEl:{},focusable:{value:!1},xrender:{value:h}},xclass:"scrollbar"})});
KISSY.add("scroll-view/plugin/scrollbar",["base","./scrollbar/control"],function(e,d){var g=d("base"),f=d("./scrollbar/control");return g.extend({pluginId:this.getName(),pluginSyncUI:function(d){var c=this.get("minLength"),g=this.get("autoHideX"),a=this.get("autoHideY"),b={scrollView:d,elBefore:d.$contentEl};void 0!==c&&(b.minLength=c);this.scrollBarX?this.scrollBarX.sync():d.allowScroll.left&&(c={axis:"x"},void 0!==g&&(b.autoHide=g),this.scrollBarX=(new f(e.merge(b,c))).render());this.scrollBarY?
this.scrollBarY.sync():d.allowScroll.top&&(c={axis:"y"},void 0!==a&&(b.autoHide=a),this.scrollBarY=(new f(e.merge(b,c))).render())},pluginDestructor:function(){this.scrollBarX&&(this.scrollBarX.destroy(),this.scrollBarX=null);this.scrollBarY&&(this.scrollBarY.destroy(),this.scrollBarY=null)}},{ATTRS:{minLength:{},autoHideX:{},autoHideY:{}}})});
