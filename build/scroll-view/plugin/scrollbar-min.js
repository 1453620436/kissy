/*
Copyright 2014, KISSY v1.50
MIT Licensed
build time: Apr 4 12:24
*/
KISSY.add("scroll-view/plugin/scrollbar/scrollbar-xtpl",[],function(h,d,i,j){d=function(c,b,f,d){f=this.utils;if("1.50"!==h.version)throw Error("current xtemplate file("+this.name+")(v1.50) need to be recompiled using current kissy(v"+h.version+")!");f=f.callCommand;b.write('<div id="ks-scrollbar-arrow-up-');var a=c.resolve(["id"]);b.write(a,!0);b.write('"\n        class="');var a={escape:1},e=[],g=c.resolve(["axis"]);e.push(g+"-arrow-up");a.params=e;if((a=f(this,c,a,b,"getBaseCssClasses",2))&&a.isBuffer)b=
a,a=d;b.write(a,!0);b.write('">\n    <a href="javascript:void(\'up\')">up</a>\n</div>\n<div id="ks-scrollbar-arrow-down-');a=c.resolve(["id"]);b.write(a,!0);b.write('"\n        class="');a={escape:1};e=[];g=c.resolve(["axis"]);e.push(g+"-arrow-down");a.params=e;if((a=f(this,c,a,b,"getBaseCssClasses",6))&&a.isBuffer)b=a,a=d;b.write(a,!0);b.write('">\n    <a href="javascript:void(\'down\')">down</a>\n</div>\n<div id="ks-scrollbar-track-');a=c.resolve(["id"]);b.write(a,!0);b.write('"\n     class="');
a={escape:1};e=[];g=c.resolve(["axis"]);e.push(g+"-track");a.params=e;if((a=f(this,c,a,b,"getBaseCssClasses",10))&&a.isBuffer)b=a,a=d;b.write(a,!0);b.write('">\n<div id="ks-scrollbar-drag-');a=c.resolve(["id"]);b.write(a,!0);b.write('"\n     class="');a={escape:1};e=[];g=c.resolve(["axis"]);e.push(g+"-drag");a.params=e;if((a=f(this,c,a,b,"getBaseCssClasses",12))&&a.isBuffer)b=a,a=d;b.write(a,!0);b.write('">\n<div class="');a={escape:1};e=[];g=c.resolve(["axis"]);e.push(g+"-drag-top");a.params=e;if((a=
f(this,c,a,b,"getBaseCssClasses",13))&&a.isBuffer)b=a,a=d;b.write(a,!0);b.write('">\n</div>\n<div class="');a={escape:1};e=[];g=c.resolve(["axis"]);e.push(g+"-drag-center");a.params=e;if((a=f(this,c,a,b,"getBaseCssClasses",15))&&a.isBuffer)b=a,a=d;b.write(a,!0);b.write('">\n</div>\n<div class="');a={escape:1};e=[];g=c.resolve(["axis"]);e.push(g+"-drag-bottom");a.params=e;if((c=f(this,c,a,b,"getBaseCssClasses",17))&&c.isBuffer)b=c,c=d;b.write(c,!0);b.write('">\n</div>\n</div>\n</div>');return b};d.TPL_NAME=
j.name;return d});
KISSY.add("scroll-view/plugin/scrollbar/render",["component/control","./scrollbar-xtpl"],function(h,d){var i=d("component/control"),j=d("./scrollbar-xtpl"),c=h.Feature,b=c.isTransform3dSupported(),c=c.getCssVendorInfo("transform"),f={beforeCreateDom:function(a,b){a.elCls.push(a.prefixCls+"scrollbar-"+a.axis);h.mix(b,{dragEl:"#ks-scrollbar-drag-{id}",downBtn:"#ks-scrollbar-arrow-down-{id}",upBtn:"#ks-scrollbar-arrow-up-{id}",trackEl:"#ks-scrollbar-track-{id}"})},createDom:function(){var a=this.control;
a.$dragEl=a.get("dragEl");a.$trackEl=a.get("trackEl");a.$downBtn=a.get("downBtn");a.$upBtn=a.get("upBtn");a.dragEl=a.$dragEl[0];a.trackEl=a.$trackEl[0];a.downBtn=a.$downBtn[0];a.upBtn=a.$upBtn[0]},_onSetDragHeight:function(a){this.control.dragEl.style.height=a+"px"},_onSetDragWidth:function(a){this.control.dragEl.style.width=a+"px"},_onSetDragLeft:function(a){this.control.dragEl.style.left=a+"px"},_onSetDragTop:function(a){this.control.dragEl.style.top=a+"px"}};if(c){var k=c.propertyName;f._onSetDragLeft=
function(a){this.control.dragEl.style[k]="translateX("+a+"px) translateY("+this.control.get("dragTop")+"px)"+(b?" translateZ(0)":"")};f._onSetDragTop=function(a){this.control.dragEl.style[k]="translateX("+this.control.get("dragLeft")+"px) translateY("+a+"px)"+(b?" translateZ(0)":"")}}return i.getDefaultRender().extend(f,{ATTRS:{contentTpl:{value:j}}})});
KISSY.add("scroll-view/plugin/scrollbar/control",["node","ua","component/control","./render","event/gesture/drag"],function(h,d){function i(a){a.preventDefault()}function j(a){a.stopPropagation();this.startScroll=this.scrollView.get(this.scrollProperty)}function c(a){var b=this.scrollView,c={};c[this.scrollType]=this.startScroll+("pageX"===this.pageXyProperty?a.deltaX:a.deltaY)/this.trackElSize*this.scrollLength;b.scrollToWithBounds(c)}function b(){var a=this.scrollView,b=this.trackEl,c=this.scrollWHProperty,
e=this.whProperty,d=this.clientWHProperty,f=this.dragWHProperty;a.allowScroll[this.scrollType]?(this.scrollLength=a[c],b=this.trackElSize="width"===e?b.offsetWidth:b.offsetHeight,a=a[d]/this.scrollLength,a*=b,this.set(f,a),this.barSize=a,n(this),this.set("visible",!0)):this.set("visible",!1)}function f(a){this.set("disabled",a.newVal)}function k(){this.hideFn&&o(this)}function a(){var a=this.scrollView;a.allowScroll[this.scrollType]&&(l(this),this.set("visible",!0),this.hideFn&&!a.isScrolling&&o(this),
n(this))}function e(a){function b(){var a={};a[d]=c.get(e)+g*f;c.scrollToWithBounds(a)}a.halt();var c=this.scrollView,e=this.scrollProperty,d=this.scrollType,f=c.getScrollStep()[this.scrollType],a=a.target,g=a===this.downBtn||this.$downBtn.contains(a)?1:-1;clearInterval(this.mouseInterval);this.mouseInterval=setInterval(b,100);b()}function g(a){var b=a.target,c=this.$dragEl;if(!(this.dragEl===b||c.contains(b))){var b=this.scrollType,c=this.scrollView,e=Math.max(0,(a[this.pageXyProperty]-this.$trackEl.offset()[b]-
this.barSize/2)/this.trackElSize),d={};d[b]=e*this.scrollLength;c.scrollToWithBounds(d);a.halt()}}function q(){clearInterval(this.mouseInterval)}function n(a){var b=a.scrollType,c=a.scrollView,e=a.dragLTProperty,d=a.dragWHProperty,f=a.trackElSize,g=a.barSize,h=a.scrollLength,i=c.get(a.scrollProperty),j=c.minScroll[b],b=c.maxScroll[b];i>b?(f*=b/h,a.set(d,g-(i-b)),a.set(e,f+g-a.get(d))):i<j?(f*=j/h,a.set(d,g-(j-i)),a.set(e,f)):(a.set(e,i/h*f),a.set(d,g))}function o(a){l(a);a.hideTimer=setTimeout(a.hideFn,
1E3*a.get("hideDelay"))}function l(a){a.hideTimer&&(clearTimeout(a.hideTimer),a.hideTimer=null)}var r=d("node"),s=d("ua"),t=d("component/control"),u=d("./render"),p=d("event/gesture/drag"),m=r.Gesture;return t.extend({initializer:function(){var a=this.scrollType="x"===this.get("axis")?"left":"top",b=h.ucfirst(a);this.pageXyProperty="left"===a?"pageX":"pageY";a=this.whProperty="left"===a?"width":"height";a=h.ucfirst(a);this.afterScrollChangeEvent="afterScroll"+b+"Change";this.scrollProperty="scroll"+
b;this.dragWHProperty="drag"+a;this.dragLTProperty="drag"+b;this.clientWHProperty="client"+a;this.scrollWHProperty="scroll"+a;this.scrollView=this.get("scrollView")},_onSetDisabled:function(a){var b=this,d=a?"detach":"on";b.get("autoHide")||(b.$dragEl[d]("dragstart mousedown",i)[d](p.DRAG_START,j,b)[d](p.DRAG,c,b),h.each([b.$downBtn,b.$upBtn],function(a){a[d](m.start,e,b)[d](m.end,q,b)}),b.$trackEl[d](m.start,g,b))},bindUI:function(){var c=this.scrollView;this.get("autoHide")&&(this.hideFn=h.bind(this.hide,
this));c.on(this.afterScrollChangeEvent+".ks-scrollbar",a,this).on("scrollTouchEnd.ks-scrollbar",k,this).on("afterDisabledChange.ks-scrollbar",f,this).on("reflow.ks-scrollbar",b,this)},syncUI:function(){b.call(this)},destructor:function(){this.scrollView.detach(".ks-scrollbar");l(this)}},{ATTRS:{minLength:{value:20},scrollView:{},axis:{view:1},autoHide:{value:s.ios},visible:{valueFn:function(){return!this.get("autoHide")}},hideDelay:{value:0.1},dragWidth:{setter:function(a){var b=this.get("minLength");
return a<b?b:a},view:1},dragHeight:{setter:function(a){var b=this.get("minLength");return a<b?b:a},view:1},dragLeft:{view:1,value:0},dragTop:{view:1,value:0},dragEl:{},downBtn:{},upBtn:{},trackEl:{},focusable:{value:!1},xrender:{value:u}},xclass:"scrollbar"})});
KISSY.add("scroll-view/plugin/scrollbar",["base","./scrollbar/control"],function(h,d){function i(){var b=this.scrollView,d=this.get("minLength"),h=this.get("autoHideX"),a=this.get("autoHideY"),e;!this.scrollBarX&&b.allowScroll.left&&(e={axis:"x",scrollView:b,elBefore:b.$contentEl},void 0!==d&&(e.minLength=d),void 0!==h&&(e.autoHide=h),this.scrollBarX=(new c(e)).render());!this.scrollBarY&&b.allowScroll.top&&(e={axis:"y",scrollView:b,elBefore:b.$contentEl},void 0!==d&&(e.minLength=d),void 0!==a&&(e.autoHide=
a),this.scrollBarY=(new c(e)).render())}var j=d("base"),c=d("./scrollbar/control");return j.extend({pluginId:this.getName(),pluginBindUI:function(b){this.scrollView=b;b.on("reflow",i,this)},pluginDestructor:function(b){this.scrollBarX&&(this.scrollBarX.destroy(),this.scrollBarX=null);this.scrollBarY&&(this.scrollBarY.destroy(),this.scrollBarY=null);b.detach("reflow",i,this)}},{ATTRS:{minLength:{},autoHideX:{},autoHideY:{}}})});
