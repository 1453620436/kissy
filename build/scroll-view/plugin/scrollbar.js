/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: Apr 29 15:12
*/
KISSY.add("scroll-view/plugin/scrollbar",["base","./scrollbar/control"],function(h,e){function k(){var c=this.scrollView,i=this.get("minLength"),e=this.get("autoHideX"),b=this.get("autoHideY"),d;!this.scrollBarX&&c.allowScroll.left&&(d={axis:"x",scrollView:c,elBefore:c.$contentEl},void 0!==i&&(d.minLength=i),void 0!==e&&(d.autoHide=e),this.scrollBarX=(new f(d)).render());!this.scrollBarY&&c.allowScroll.top&&(d={axis:"y",scrollView:c,elBefore:c.$contentEl},void 0!==i&&(d.minLength=i),void 0!==b&&(d.autoHide=
b),this.scrollBarY=(new f(d)).render())}var l=e("base"),f=e("./scrollbar/control");return l.extend({pluginId:this.getName(),pluginBindUI:function(c){this.scrollView=c;c.on("reflow",k,this)},pluginDestructor:function(c){this.scrollBarX&&(this.scrollBarX.destroy(),this.scrollBarX=null);this.scrollBarY&&(this.scrollBarY.destroy(),this.scrollBarY=null);c.detach("reflow",k,this)}},{ATTRS:{minLength:{},autoHideX:{},autoHideY:{}}})});
KISSY.add("scroll-view/plugin/scrollbar/control",["ua","component/control","event/gesture/base","event/gesture/drag","./scrollbar-xtpl"],function(h,e){function k(a){a.preventDefault()}function l(a){a.stopPropagation();this.startScroll=this.scrollView.get(this.scrollProperty)}function f(a){var b=this.scrollView,c={};c[this.scrollType]=this.startScroll+("pageX"===this.pageXyProperty?a.deltaX:a.deltaY)/this.trackElSize*this.scrollLength;b.scrollToWithBounds(c)}function c(){var a=this.scrollView,b=this.trackEl,
c=this.scrollWHProperty,d=this.whProperty,f=this.clientWHProperty,e=this.dragWHProperty;a.allowScroll[this.scrollType]?(this.scrollLength=a[c],b=this.trackElSize="width"===d?b.offsetWidth:b.offsetHeight,a=a[f]/this.scrollLength,a*=b,this.set(e,a),this.barSize=a,q(this),this.set("visible",!0)):this.set("visible",!1)}function i(a){this.set("disabled",a.newVal)}function j(){this.hideFn&&r(this)}function b(){var a=this.scrollView;a.allowScroll[this.scrollType]&&(n(this),this.set("visible",!0),this.hideFn&&
!a.isScrolling&&r(this),q(this))}function d(a){function b(){var a={};a[f]=c.get(d)+i*e;c.scrollToWithBounds(a)}a.halt();var c=this.scrollView,d=this.scrollProperty,f=this.scrollType,e=c.getScrollStep()[this.scrollType],a=a.target,i=a===this.downBtn||this.$downBtn.contains(a)?1:-1;clearInterval(this.mouseInterval);this.mouseInterval=setInterval(b,100);b()}function g(a){var b=a.target,c=this.$dragEl;if(!(this.dragEl===b||c.contains(b))){var b=this.scrollType,c=this.scrollView,d=Math.max(0,(a[this.pageXyProperty]-
this.$trackEl.offset()[b]-this.barSize/2)/this.trackElSize),f={};f[b]=d*this.scrollLength;c.scrollToWithBounds(f);a.halt()}}function w(){clearInterval(this.mouseInterval)}function q(a){var b=a.scrollType,c=a.scrollView,d=a.dragLTProperty,f=a.dragWHProperty,e=a.trackElSize,i=a.barSize,g=a.scrollLength,h=c.get(a.scrollProperty),j=c.minScroll[b],b=c.maxScroll[b];h>b?(e*=b/g,a.set(f,i-(h-b)),a.set(d,e+i-a.get(f))):h<j?(e*=j/g,a.set(f,i-(j-h)),a.set(d,e)):(a.set(d,h/g*e),a.set(f,i))}function r(a){n(a);
a.hideTimer=setTimeout(a.hideFn,1E3*a.get("hideDelay"))}function n(a){a.hideTimer&&(clearTimeout(a.hideTimer),a.hideTimer=null)}function s(a,b){var c=b?"detach":"on";a.get("autoHide")||(a.$dragEl[c](["dragstart","mousedown","touchmove"],k)[c](t.DRAG_START,l,a)[c](t.DRAG,f,a),h.each([a.$downBtn,a.$upBtn],function(b){b[c](o.START,d,a)[c](o.END,w,a)}),a.$trackEl[c](o.START,g,a))}var x=e("ua"),y=e("component/control"),o=e("event/gesture/base"),t=e("event/gesture/drag"),z=e("./scrollbar-xtpl"),m=h.Feature,
u=m.isTransform3dSupported(),m=m.getCssVendorInfo("transform"),p={initializer:function(){var a=this.scrollType="x"===this.get("axis")?"left":"top",b=h.ucfirst(a);this.pageXyProperty="left"===a?"pageX":"pageY";a=this.whProperty="left"===a?"width":"height";a=h.ucfirst(a);this.afterScrollChangeEvent="afterScroll"+b+"Change";this.scrollProperty="scroll"+b;this.dragWHProperty="drag"+a;this.dragLTProperty="drag"+b;this.clientWHProperty="client"+a;this.scrollWHProperty="scroll"+a;this.scrollView=this.get("scrollView")},
beforeCreateDom:function(a){a.elCls.push(a.prefixCls+"scrollbar-"+a.axis)},createDom:function(){this.$dragEl=this.get("dragEl");this.$trackEl=this.get("trackEl");this.$downBtn=this.get("downBtn");this.$upBtn=this.get("upBtn");this.dragEl=this.$dragEl[0];this.trackEl=this.$trackEl[0];this.downBtn=this.$downBtn[0];this.upBtn=this.$upBtn[0]},bindUI:function(){var a=this.scrollView;this.get("autoHide")&&(this.hideFn=h.bind(this.hide,this));a.on(this.afterScrollChangeEvent+".ks-scrollbar",b,this).on("scrollTouchEnd.ks-scrollbar",
j,this).on("afterDisabledChange.ks-scrollbar",i,this).on("reflow.ks-scrollbar",c,this);s(this,this.get("disabled"))},syncUI:function(){c.call(this)},_onSetDragHeight:function(a){this.dragEl.style.height=a+"px"},_onSetDragWidth:function(a){this.dragEl.style.width=a+"px"},_onSetDragLeft:function(a){this.dragEl.style.left=a+"px"},_onSetDragTop:function(a){this.dragEl.style.top=a+"px"},_onSetDisabled:function(a){this.callSuper(a);s(this,a)},destructor:function(){this.scrollView.detach(".ks-scrollbar");
n(this)}};if(m){var v=m.propertyName;p._onSetDragLeft=function(a){this.dragEl.style[v]="translateX("+a+"px) translateY("+this.get("dragTop")+"px)"+(u?" translateZ(0)":"")};p._onSetDragTop=function(a){this.dragEl.style[v]="translateX("+this.get("dragLeft")+"px) translateY("+a+"px)"+(u?" translateZ(0)":"")}}return y.extend(p,{ATTRS:{minLength:{value:20},scrollView:{},axis:{render:1},autoHide:{value:x.ios},visible:{valueFn:function(){return!this.get("autoHide")}},hideDelay:{value:0.1},dragWidth:{setter:function(a){var b=
this.get("minLength");return a<b?b:a},render:1},dragHeight:{setter:function(a){var b=this.get("minLength");return a<b?b:a},render:1},dragLeft:{render:1,value:0},dragTop:{render:1,value:0},dragEl:{selector:function(){return"."+this.getBaseCssClass("drag")}},downBtn:{selector:function(){return"."+this.getBaseCssClass("arrow-down")}},upBtn:{selector:function(){return"."+this.getBaseCssClass("arrow-up")}},trackEl:{selector:function(){return"."+this.getBaseCssClass("track")}},focusable:{value:!1},contentTpl:{value:z}},
xclass:"scrollbar"})});
KISSY.add("scroll-view/plugin/scrollbar/scrollbar-xtpl",[],function(h,e,k,l){e=function(f,c,e,j){e=this.utils.callFn;if("5.0.0"!==h.version)throw Error("current xtemplate file("+this.name+")(v5.0.0) need to be recompiled using current kissy(v"+h.version+")!");c.write('<div class="',0);var b={escape:1},d=[],g=f.resolve(["axis"],0);d.push(g+"-arrow-up arrow-up");b.params=d;if((b=e(this,f,b,c,["getBaseCssClasses"],0,1))&&b.isBuffer)c=b,b=j;c.write(b,!0);c.write('">\r\n    <a href="javascript:void(\'up\')">up</a>\r\n</div>\r\n<div class="',0);
b={escape:1};d=[];g=f.resolve(["axis"],0);d.push(g+"-arrow-down arrow-down");b.params=d;if((b=e(this,f,b,c,["getBaseCssClasses"],0,4))&&b.isBuffer)c=b,b=j;c.write(b,!0);c.write('">\r\n    <a href="javascript:void(\'down\')">down</a>\r\n</div>\r\n<div class="',0);b={escape:1};d=[];g=f.resolve(["axis"],0);d.push(g+"-track track");b.params=d;if((b=e(this,f,b,c,["getBaseCssClasses"],0,7))&&b.isBuffer)c=b,b=j;c.write(b,!0);c.write('">\r\n<div class="',0);b={escape:1};d=[];g=f.resolve(["axis"],0);d.push(g+
"-drag drag");b.params=d;if((b=e(this,f,b,c,["getBaseCssClasses"],0,8))&&b.isBuffer)c=b,b=j;c.write(b,!0);c.write('">\r\n<div class="',0);b={escape:1};d=[];g=f.resolve(["axis"],0);d.push(g+"-drag-top");b.params=d;if((b=e(this,f,b,c,["getBaseCssClasses"],0,9))&&b.isBuffer)c=b,b=j;c.write(b,!0);c.write('">\r\n</div>\r\n<div class="',0);b={escape:1};d=[];g=f.resolve(["axis"],0);d.push(g+"-drag-center");b.params=d;if((b=e(this,f,b,c,["getBaseCssClasses"],0,11))&&b.isBuffer)c=b,b=j;c.write(b,!0);c.write('">\r\n</div>\r\n<div class="',
0);b={escape:1};d=[];g=f.resolve(["axis"],0);d.push(g+"-drag-bottom");b.params=d;if((f=e(this,f,b,c,["getBaseCssClasses"],0,13))&&f.isBuffer)c=f,f=j;c.write(f,!0);c.write('">\r\n</div>\r\n</div>\r\n</div>',0);return c};e.TPL_NAME=l.name;return e});
