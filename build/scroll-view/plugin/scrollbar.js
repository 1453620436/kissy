/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: Aug 26 16:10
*/
KISSY.add("scroll-view/plugin/scrollbar",["base","./scrollbar/control"],function(l,f,m,j){function e(){var e=this.scrollView,g=this.get("minLength"),f=this.get("autoHideX"),b=this.get("autoHideY"),d;!this.scrollBarX&&e.allowScroll.left&&(d={axis:"x",scrollView:e,elBefore:e.$contentEl},void 0!==g&&(d.minLength=g),void 0!==f&&(d.autoHide=f),this.scrollBarX=(new c(d)).render());!this.scrollBarY&&e.allowScroll.top&&(d={axis:"y",scrollView:e,elBefore:e.$contentEl},void 0!==g&&(d.minLength=g),void 0!==
b&&(d.autoHide=b),this.scrollBarY=(new c(d)).render())}var l=f("base"),c=f("./scrollbar/control");j.exports=l.extend({pluginId:this.name,pluginBindUI:function(c){this.scrollView=c;c.on("reflow",e,this)},pluginDestructor:function(c){this.scrollBarX&&(this.scrollBarX.destroy(),this.scrollBarX=null);this.scrollBarY&&(this.scrollBarY.destroy(),this.scrollBarY=null);c.detach("reflow",e,this)}},{ATTRS:{minLength:{},autoHideX:{},autoHideY:{}}})});
KISSY.add("scroll-view/plugin/scrollbar/control","ua,util,component/control,event/gesture/basic,event/gesture/pan,./scrollbar-xtpl,feature".split(","),function(l,f,m,j){function e(a){a.preventDefault()}function c(a){a.halt();this.startScroll=this.scrollView.get(this.scrollProperty)}function k(a){var b=this.scrollView,c={};c[this.scrollType]=this.startScroll+(this.pageXyProperty==="pageX"?a.deltaX:a.deltaY)/this.trackElSize*this.scrollLength;b.scrollToWithBounds(c);a.halt()}function g(){var a=this.scrollView,
b=this.trackEl,c=this.scrollWHProperty,e=this.whProperty,d=this.clientWHProperty,g=this.dragWHProperty;if(a.allowScroll[this.scrollType]){this.scrollLength=a[c];b=this.trackElSize=e==="width"?b.offsetWidth:b.offsetHeight;a=a[d]/this.scrollLength;a=a*b;this.set(g,a);this.barSize=a;s(this);this.set("visible",true)}else this.set("visible",false)}function i(a){this.set("disabled",a.newVal)}function b(){this.hideFn&&t(this)}function d(){var a=this.scrollView;if(a.allowScroll[this.scrollType]){o(this);
this.set("visible",true);this.hideFn&&!a.isScrolling&&t(this);s(this)}}function h(a){function b(){var a={};a[d]=c.get(e)+f*g;c.scrollToWithBounds(a)}a.halt();var c=this.scrollView,e=this.scrollProperty,d=this.scrollType,g=c.getScrollStep()[this.scrollType],a=a.target,f=a===this.downBtn||this.$downBtn.contains(a)?1:-1;clearInterval(this.mouseInterval);this.mouseInterval=setInterval(b,100);b()}function x(a){var b=a.target,c=this.$dragEl;if(!(this.dragEl===b||c.contains(b))){var b=this.scrollType,c=
this.scrollView,e=Math.max(0,(a[this.pageXyProperty]-this.$trackEl.offset()[b]-this.barSize/2)/this.trackElSize),d={};d[b]=e*this.scrollLength;c.scrollToWithBounds(d);a.halt()}}function y(){clearInterval(this.mouseInterval)}function s(a){var b=a.scrollType,c=a.scrollView,d=a.dragLTProperty,e=a.dragWHProperty,g=a.trackElSize,f=a.barSize,h=a.scrollLength,k=c.get(a.scrollProperty),i=c.minScroll[b],b=c.maxScroll[b];if(k>b){g=b/h*g;a.set(e,f-(k-b));a.set(d,g+f-a.get(e))}else if(k<i){g=i/h*g;a.set(e,f-
(i-k));a.set(d,g)}else{a.set(d,k/h*g);a.set(e,f)}}function t(a){o(a);a.hideTimer=setTimeout(a.hideFn,a.get("hideDelay")*1E3)}function o(a){if(a.hideTimer){clearTimeout(a.hideTimer);a.hideTimer=null}}function z(a){a.halt()}function u(a,b){var d=b?"detach":"on";if(!a.get("autoHide")){a.$dragEl[d](["dragstart","mousedown"],e)[d](p.PAN_END,z,a)[d](p.PAN_START,c,a)[d](p.PAN,k,a);n.each([a.$downBtn,a.$upBtn],function(b){b[d](q.START,h,a)[d](q.END,y,a)});a.$trackEl[d](q.START,x,a)}}var l=f("ua"),n=f("util"),
m=f("component/control"),q=f("event/gesture/basic"),p=f("event/gesture/pan"),A=f("./scrollbar-xtpl"),f=f("feature"),v=f.isTransform3dSupported(),f=f.getCssVendorInfo("transform"),r={initializer:function(){var a=this.scrollType=this.get("axis")==="x"?"left":"top",b=n.ucfirst(a);this.pageXyProperty=a==="left"?"pageX":"pageY";a=this.whProperty=a==="left"?"width":"height";a=n.ucfirst(a);this.afterScrollChangeEvent="afterScroll"+b+"Change";this.scrollProperty="scroll"+b;this.dragWHProperty="drag"+a;this.dragLTProperty=
"drag"+b;this.clientWHProperty="client"+a;this.scrollWHProperty="scroll"+a;this.scrollView=this.get("scrollView")},beforeCreateDom:function(a){a.elCls.push(a.prefixCls+"scrollbar-"+a.axis)},createDom:function(){this.$dragEl=this.get("dragEl");this.$trackEl=this.get("trackEl");this.$downBtn=this.get("downBtn");this.$upBtn=this.get("upBtn");this.dragEl=this.$dragEl[0];this.trackEl=this.$trackEl[0];this.downBtn=this.$downBtn[0];this.upBtn=this.$upBtn[0]},bindUI:function(){var a=this.scrollView;if(this.get("autoHide"))this.hideFn=
n.bind(this.hide,this);a.on(this.afterScrollChangeEvent+".ks-scrollbar",d,this).on("scrollTouchEnd.ks-scrollbar",b,this).on("afterDisabledChange.ks-scrollbar",i,this).on("reflow.ks-scrollbar",g,this);u(this,this.get("disabled"))},syncUI:function(){g.call(this)},_onSetDragHeight:function(a){this.dragEl.style.height=a+"px"},_onSetDragWidth:function(a){this.dragEl.style.width=a+"px"},_onSetDragLeft:function(a){this.dragEl.style.left=a+"px"},_onSetDragTop:function(a){this.dragEl.style.top=a+"px"},_onSetDisabled:function(a){this.callSuper(a);
u(this,a)},destructor:function(){this.scrollView.detach(".ks-scrollbar");o(this)}};if(f){var w=f.propertyName;r._onSetDragLeft=function(a){this.dragEl.style[w]="translateX("+a+"px) translateY("+this.get("dragTop")+"px)"+(v?" translateZ(0)":"")};r._onSetDragTop=function(a){this.dragEl.style[w]="translateX("+this.get("dragLeft")+"px) translateY("+a+"px)"+(v?" translateZ(0)":"")}}j.exports=m.extend(r,{ATTRS:{handleGestureEvents:{value:false},focusable:{value:false},allowTextSelection:{value:false},minLength:{value:20},
scrollView:{},axis:{render:1},autoHide:{value:l.ios},visible:{valueFn:function(){return!this.get("autoHide")}},hideDelay:{value:0.1},dragWidth:{setter:function(a){var b=this.get("minLength");return a<b?b:a},render:1},dragHeight:{setter:function(a){var b=this.get("minLength");return a<b?b:a},render:1},dragLeft:{render:1,value:0},dragTop:{render:1,value:0},dragEl:{selector:function(){return"."+this.getBaseCssClass("drag")}},downBtn:{selector:function(){return"."+this.getBaseCssClass("arrow-down")}},
upBtn:{selector:function(){return"."+this.getBaseCssClass("arrow-up")}},trackEl:{selector:function(){return"."+this.getBaseCssClass("track")}},contentTpl:{value:A}},xclass:"scrollbar"})});
KISSY.add("scroll-view/plugin/scrollbar/scrollbar-xtpl",[],function(l,f,m,j){j.exports=function(e,c,f){var g=this.pos={line:1,col:1},i=this.root.utils.callFn;c.append('<div class="');var b={escape:1},d=[],h=e.resolve(["axis"]);d.push(h+"-arrow-up arrow-up");b.params=d;g.line=1;g.col=33;if((b=i(this,e,b,c,["getBaseCssClasses"]))&&b.isBuffer)c=b,b=f;c.writeEscaped(b);c.append('">\r\n    <a href="javascript:void(\'up\')">up</a>\r\n</div>\r\n<div class="');b={escape:1};d=[];h=e.resolve(["axis"]);d.push(h+
"-arrow-down arrow-down");b.params=d;g.line=4;g.col=32;if((b=i(this,e,b,c,["getBaseCssClasses"]))&&b.isBuffer)c=b,b=f;c.writeEscaped(b);c.append('">\r\n    <a href="javascript:void(\'down\')">down</a>\r\n</div>\r\n<div class="');b={escape:1};d=[];h=e.resolve(["axis"]);d.push(h+"-track track");b.params=d;g.line=7;g.col=32;if((b=i(this,e,b,c,["getBaseCssClasses"]))&&b.isBuffer)c=b,b=f;c.writeEscaped(b);c.append('">\r\n<div class="');b={escape:1};d=[];h=e.resolve(["axis"]);d.push(h+"-drag drag");b.params=
d;g.line=8;g.col=32;if((b=i(this,e,b,c,["getBaseCssClasses"]))&&b.isBuffer)c=b,b=f;c.writeEscaped(b);c.append('">\r\n<div class="');b={escape:1};d=[];h=e.resolve(["axis"]);d.push(h+"-drag-top");b.params=d;g.line=9;g.col=32;if((b=i(this,e,b,c,["getBaseCssClasses"]))&&b.isBuffer)c=b,b=f;c.writeEscaped(b);c.append('">\r\n</div>\r\n<div class="');b={escape:1};d=[];h=e.resolve(["axis"]);d.push(h+"-drag-center");b.params=d;g.line=11;g.col=32;if((b=i(this,e,b,c,["getBaseCssClasses"]))&&b.isBuffer)c=b,b=
f;c.writeEscaped(b);c.append('">\r\n</div>\r\n<div class="');b={escape:1};d=[];h=e.resolve(["axis"]);d.push(h+"-drag-bottom");b.params=d;g.line=13;g.col=32;if((e=i(this,e,b,c,["getBaseCssClasses"]))&&e.isBuffer)c=e,e=f;c.writeEscaped(e);c.append('">\r\n</div>\r\n</div>\r\n</div>');return c};j.exports.TPL_NAME=j.name});
