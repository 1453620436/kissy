/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: Jun 5 23:17
*/
KISSY.add("anim/transition",["util","dom","./base","feature"],function(n,j,l,o){function p(d){var c="";g.each(d,function(a,b){c&&(c+=",");c+=b+" "+a.duration+"s "+a.easing+" "+a.delay+"s"});return c}function q(d){return d.replace(/[A-Z]/g,function(c){return"-"+c.toLowerCase()})}function h(d,c,a,b,f){if(!(this instanceof h))return new h(d,c,a,b,f);h.superclass.constructor.apply(this,arguments)}var g=j("util"),i=j("dom"),l=j("./base"),m=j("feature").getCssVendorInfo,k=m("transition").propertyName,r=
{ease:1,linear:1,"ease-in":1,"ease-out":1,"ease-in-out":1};g.extend(h,l,{prepareFx:function(){var d=this._propsData,c={},a,b;for(b in d)a=d[b],"string"===typeof a.easing?!g.startsWith(a.easing,"cubic-bezier")&&!r[a.easing]&&(a.easing="linear"):a.easing="linear",a=m(b),c[q(a.propertyName)]=d[b];this._propsData=c},doStart:function(){var d=this,c=d.node,a=c.style,b=d._propsData,f=a[k],e=0,h={};g.each(b,function(b,a){var d=b.value;i.css(c,a,i.css(c,a));h[a]=d;e=Math.max(b.duration+b.delay,e)});-1!==f.indexOf("none")?
f="":f&&(f+=",");a[k]=f+p(b);setTimeout(function(){i.css(c,h)},0);d._transitionEndTimer=setTimeout(function(){d.stop(!0)},1E3*e)},beforeResume:function(){var d=this._propsData,c=g.merge(d),a=this._runTime/1E3;g.each(c,function(b,c){var e=a;b.delay>=e?b.delay-=e:(e-=b.delay,b.delay=0,b.duration>=e?b.duration-=e:delete d[c])})},doStop:function(d){var c=this.node,a=c.style,b=this._propsData,f=[],e={};this._transitionEndTimer&&(clearTimeout(this._transitionEndTimer),this._transitionEndTimer=null);g.each(b,
function(b,a){d||(e[a]=i.css(c,a));f.push(a)});b=g.trim(a[k].replace(RegExp("(^|,)\\s*(?:"+f.join("|")+")\\s+[^,]+","gi"),"$1")).replace(/^,|,,|,$/g,"")||"none";a[k]=b;i.css(c,e)}});g.mix(h,l.Statics);o.exports=n.Anim=h});
