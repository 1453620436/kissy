/*
Copyright 2013, KISSY v1.50dev
MIT Licensed
build time: Nov 19 12:02
*/
KISSY.add("anim/timer/easing",[],function(){function i(b){return b}function g(b,a,f,c){var e=3*b-3*f+1,d=3*f-6*b,h=3*b,g=3*a-3*c+1,i=3*c-6*a,n=3*a;return function(b){a:{for(var a=b,c,f,m=0;8>m;m++){f=((e*a+d)*a+h)*a-b;if(o(f)<j){b=a;break a}c=(3*e*a+2*d)*a+h;if(o(c)<j)break;a-=f/c}c=1;m=0;for(a=b;c>m;){f=((e*a+d)*a+h)*a-b;if(o(f)<j)break;0<f?c=a:m=a;a=(c+m)/2}b=a}return((g*b+i)*b+n)*b}}var h=Math.PI,a=Math.pow,c=Math.sin,e=parseFloat,d=/^cubic-bezier\(([^,]+),([^,]+),([^,]+),([^,]+)\)$/i,n={swing:function(b){return-Math.cos(b*
h)/2+0.5},easeNone:i,linear:i,easeIn:function(b){return b*b},ease:g(0.25,0.1,0.25,1),"ease-in":g(0.42,0,1,1),"ease-out":g(0,0,0.58,1),"ease-in-out":g(0.42,0,0.58,1),"ease-out-in":g(0,0.42,1,0.58),toFn:function(b){var a;return(a=b.match(d))?g(e(a[1]),e(a[2]),e(a[3]),e(a[4])):n[b]||i},easeOut:function(b){return(2-b)*b},easeBoth:function(b){return 1>(b*=2)?0.5*b*b:0.5*(1- --b*(b-2))},easeInStrong:function(b){return b*b*b*b},easeOutStrong:function(b){return 1- --b*b*b*b},easeBothStrong:function(b){return 1>
(b*=2)?0.5*b*b*b*b:0.5*(2-(b-=2)*b*b*b)},elasticIn:function(b){return 0===b||1===b?b:-(a(2,10*(b-=1))*c(2*(b-0.075)*h/0.3))},elasticOut:function(b){return 0===b||1===b?b:a(2,-10*b)*c(2*(b-0.075)*h/0.3)+1},elasticBoth:function(b){return 0===b||2===(b*=2)?b:1>b?-0.5*a(2,10*(b-=1))*c(2*(b-0.1125)*h/0.45):0.5*a(2,-10*(b-=1))*c(2*(b-0.1125)*h/0.45)+1},backIn:function(b){1===b&&(b-=0.001);return b*b*(2.70158*b-1.70158)},backOut:function(b){return(b-=1)*b*(2.70158*b+1.70158)+1},backBoth:function(b){var a,
c=(a=2.5949095)+1;return 1>(b*=2)?0.5*b*b*(c*b-a):0.5*((b-=2)*b*(c*b+a)+2)},bounceIn:function(b){return 1-n.bounceOut(1-b)},bounceOut:function(b){return b<1/2.75?7.5625*b*b:b<2/2.75?7.5625*(b-=1.5/2.75)*b+0.75:b<2.5/2.75?7.5625*(b-=2.25/2.75)*b+0.9375:7.5625*(b-=2.625/2.75)*b+0.984375},bounceBoth:function(b){return 0.5>b?0.5*n.bounceIn(2*b):0.5*n.bounceOut(2*b-1)+0.5}},j=1.0E-6,o=Math.abs;return n});
KISSY.add("anim/timer/manager",[],function(i){var g=i.stamp,h,a;h=function(a){return setTimeout(a,15)};a=function(a){clearTimeout(a)};return{runnings:{},timer:null,start:function(a){var e=g(a);this.runnings[e]||(this.runnings[e]=a,this.startTimer())},stop:function(a){this.notRun(a)},notRun:function(a){delete this.runnings[g(a)];i.isEmptyObject(this.runnings)&&this.stopTimer()},pause:function(a){this.notRun(a)},resume:function(a){this.start(a)},startTimer:function(){var a=this;a.timer||(a.timer=h(function d(){a.runFrames()?
a.stopTimer():a.timer=h(d)}))},stopTimer:function(){var c=this.timer;c&&(a(c),this.timer=0)},runFrames:function(){var a,e,d=this.runnings;for(a in d)d[a].frame();for(a in d){e=0;break}return void 0===e}}});
KISSY.add("anim/timer/fx",["dom"],function(i){function g(a){i.mix(this,a);this.pos=0;this.unit=this.unit||""}var h=this.require("dom");g.prototype={isCustomFx:0,constructor:g,load:function(a){i.mix(this,a);this.pos=0;this.unit=this.unit||""},frame:function(a){if(1!==this.pos){var c=this.anim,e=this.prop,d=c.node,g=this.from,j=this.propData,o=this.to;if(void 0===a)var b=i.now(),a=j.duration,b=b-c.startTime-j.delay,a=0>=b?0:b>=a?1:j.easing(b/a);this.pos=a;g===o||0===a||(this.val=a=this.interpolate(g,
o,this.pos),j.frame?j.frame.call(this,c,this):this.isCustomFx||(void 0===a?(this.pos=1,a=o,e+" update directly ! : "+a+" : "+g+" : "+o):a+=this.unit,this.val=a,"attr"==this.type?h.attr(d,e,a,1):h.css(d,e,a)))}},interpolate:function(a,c,e){if("number"===typeof a&&"number"===typeof c)return Math.round(1E5*(a+(c-a)*e))/1E5},cur:function(){var a=this.prop,c,e,d=this.anim.node;if(this.isCustomFx)return d[a]||0;if(!(c=this.type))c=this.type=(!d.style||null==d.style[a])&&null!=h.attr(d,a,void 0,1)?"attr":
"css";a="attr"==c?h.attr(d,a,void 0,1):h.css(d,a);return isNaN(e=parseFloat(a))?!a||"auto"===a?0:a:e}};g.Factories={};g.FxTypes={};g.getFx=function(a){var c=g,e,d;if(e=a.fxType)c=g.FxTypes[e];else if(!a.isCustomFx&&(d=g.Factories[a.prop]))c=d;return new c(a)};return g});
KISSY.add("anim/timer/short-hand",[],function(){return{background:[],border:["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth"],borderBottom:["borderBottomWidth"],borderLeft:["borderLeftWidth"],borderTop:["borderTopWidth"],borderRight:["borderRightWidth"],font:["fontSize","fontWeight"],margin:["marginBottom","marginLeft","marginRight","marginTop"],padding:["paddingBottom","paddingLeft","paddingRight","paddingTop"]}});
KISSY.add("anim/timer/color",["./fx","./short-hand"],function(i){function g(a){var a=a+"",d;if(d=a.match(re_RGB))return[parseInt(d[1]),parseInt(d[2]),parseInt(d[3])];if(d=a.match(re_RGBA))return[parseInt(d[1]),parseInt(d[2]),parseInt(d[3]),parseInt(d[4])];if(d=a.match(re_hex)){for(a=1;a<d.length;a++)2>d[a].length&&(d[a]+=d[a]);return[parseInt(d[1],HEX_BASE),parseInt(d[2],HEX_BASE),parseInt(d[3],HEX_BASE)]}if(KEYWORDS[a=a.toLowerCase()])return KEYWORDS[a];"only allow rgb or hex color string : "+a;
return[255,255,255]}function h(){h.superclass.constructor.apply(this,arguments)}var a=this.require("./fx"),c=this.require("./short-hand");re_hex=/^#?([0-9A-F]{1,2})([0-9A-F]{1,2})([0-9A-F]{1,2})$/i;COLORS="backgroundColor,borderBottomColor,borderLeftColor,borderRightColor,borderTopColor,color,outlineColor".split(",");c.background.push("backgroundColor");c.borderColor=["borderBottomColor","borderLeftColor","borderRightColor","borderTopColor"];c.border.push("borderBottomColor","borderLeftColor","borderRightColor",
"borderTopColor");c.borderBottom.push("borderBottomColor");c.borderLeft.push("borderLeftColor");c.borderRight.push("borderRightColor");c.borderTop.push("borderTopColor");i.extend(h,a,{load:function(){h.superclass.load.apply(this,arguments);this.from&&(this.from=g(this.from));this.to&&(this.to=g(this.to))},interpolate:function(a,d,c){var j=h.superclass.interpolate;if(3==a.length&&3==d.length)return"rgb("+[floor(j(a[0],d[0],c)),floor(j(a[1],d[1],c)),floor(j(a[2],d[2],c))].join(", ")+")";if(4==a.length||
4==d.length)return"rgba("+[floor(j(a[0],d[0],c)),floor(j(a[1],d[1],c)),floor(j(a[2],d[2],c)),floor(j(a[3]||1,d[3]||1,c))].join(", ")+")";"unknown value : "+a}});i.each(COLORS,function(c){a.Factories[c]=h});return a.FxTypes.color=h});
KISSY.add("anim/timer/transform",["dom","./fx"],function(i){function g(c){c=c.split(/,/);return c=i.map(c,function(c){return a(c)})}function h(){return{translateX:0,translateY:0,rotate:0,skewX:0,skewY:0,scaleX:1,scaleY:1}}function a(a){return Math.round(1E5*parseFloat(a))/1E5}function c(c){for(var c=c.split(")"),d=i.trim,b=-1,m=c.length-1,f,e,l=h();++b<m;)switch(f=c[b].split("("),e=d(f[0]),f=f[1],e){case "translateX":case "translateY":case "scaleX":case "scaleY":l[e]=a(f);break;case "rotate":case "skewX":case "skewY":var k=
a(f);i.endsWith(f,"deg")||(k=180*k/Math.PI);l[e]=k;break;case "translate":case "translate3d":f=f.split(",");l.translateX=a(f[0]);l.translateY=a(f[1]||0);break;case "scale":f=f.split(",");l.scaleX=a(f[0]);l.scaleY=a(f[1]||f[0]);break;case "matrix":return c=f,c=g(c),m=b=d=void 0,e=c[0],l=c[1],f=c[2],k=c[3],e*k-l*f?(d=Math.sqrt(e*e+l*l),e/=d,l/=d,m=e*f+l*k,f-=e*m,k-=l*m,b=Math.sqrt(f*f+k*k),f/=b,k/=b,m/=b,e*k<l*f&&(e=-e,l=-l,m=-m,d=-d)):d=b=m=0,{translateX:a(c[4]),translateY:a(c[5]),rotate:a(180*Math.atan2(l,
e)/Math.PI),skewX:a(180*Math.atan(m)/Math.PI),skewY:0,scaleX:a(d),scaleY:a(b)}}return l}function e(){e.superclass.constructor.apply(this,arguments)}var d=this.require("dom"),n=this.require("./fx");i.extend(e,n,{load:function(){e.superclass.load.apply(this,arguments);this.from=(this.from=d.style(this.anim.node,"transform")||this.from)&&"none"!=this.from?c(this.from):h();this.to=this.to?c(this.to):h()},interpolate:function(a,c,b){var d=e.superclass.interpolate,f={};f.translateX=d(a.translateX,c.translateX,
b);f.translateY=d(a.translateY,c.translateY,b);f.rotate=d(a.rotate,c.rotate,b);f.skewX=d(a.skewX,c.skewX,b);f.skewY=d(a.skewY,c.skewY,b);f.scaleX=d(a.scaleX,c.scaleX,b);f.scaleY=d(a.scaleY,c.scaleY,b);return i.substitute("translate3d({translateX}px,{translateY}px,0) rotate({rotate}deg) skewX({skewX}deg) skewY({skewY}deg) scale({scaleX},{scaleY})",f)}});return n.Factories.transform=e});
KISSY.add("anim/timer","dom,./base,./timer/easing,./timer/manager,./timer/fx,./timer/short-hand,./timer/color,./timer/transform".split(","),function(i){function g(){var b;g.superclass.constructor.apply(this,arguments);i.each(b=this.to,function(a,c){var d=j(c);if(c!=d){b[d]=b[c];delete b[c]}})}var h=this.require("dom"),a=this.require("./base"),c=this.require("./timer/easing"),e=this.require("./timer/manager"),d=this.require("./timer/fx"),n=this.require("./timer/short-hand");this.require("./timer/color");
this.require("./timer/transform");var j=h._camelCase,o=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i;i.extend(g,a,{prepareFx:function(){var b=this.node,a=this._propsData;i.each(a,function(b){b.duration=b.duration*1E3;b.delay=b.delay*1E3;if(typeof b.easing=="string")b.easing=c.toFn(b.easing)});i.each(n,function(c,d){var f,e=a[d],g;if(e){g=e.value;f={};i.each(c,function(a){f[a]=h.css(b,a)});h.css(b,d,g);i.each(f,function(c,d){d in a||(a[d]=i.merge(e,{value:h.css(b,d)}));h.css(b,d,c)});delete a[d]}});var f,e,g,
k,j,p,r,u=0,q;i.isPlainObject(b)&&(u=1);for(f in a){e=a[f];g=e.value;p={isCustomFx:u,prop:f,anim:this,fxType:e.fxType,type:e.type,propData:e};r=d.getFx(p);k=g;j=r.cur();g=g+"";q="";if(g=g.match(o)){k=parseFloat(g[2]);if((q=g[3])&&q!=="px"&&j){var s=0,t=k;do{++t;h.css(b,f,t+q);s=r.cur()}while(s==0);j=t/s*j;h.css(b,f,j+q)}g[1]&&(k=(g[1]==="-="?-1:1)*k+j)}p.from=j;p.to=k;p.unit=q;r.load(p);e.fx=r}},frame:function(){var b,a=1,c,d=this._propsData;for(b in d){c=d[b];c=c.fx;c.frame();if(this.isRejected()||
this.isResolved())return;a=a&c.pos==1}d=i.now();b=this.config.duration*1E3;d=Math.max(0,this.startTime+b-d);this.defer.notify([this,1-(d/b||0),d]);a&&this.stop(a)},doStop:function(b){var a,c=this._propsData;e.stop(this);if(b)for(a in c){b=c[a];(b=b.fx)&&b.frame(1)}},doStart:function(){e.start(this)}});g.Easing=c;g.Fx=d;return g});
