/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: Apr 10 18:34
*/
KISSY.add("anim/base/queue",["dom"],function(b,l){function h(b,a,d){var a=a||g,n,h=e.data(b,c);!h&&!d&&e.data(b,c,h={});h&&(n=h[a],!n&&!d&&(n=h[a]=[]));return n}var e=l("dom"),c=b.guid("ks-queue-"+b.now()+"-"),g=b.guid("ks-queue-"+b.now()+"-"),a;return a={queueCollectionKey:c,queue:function(a,b,d){a=h(a,b);a.push(d);return a},remove:function(j,f,d){var e=h(j,f,1);e&&(d=b.indexOf(d,e),-1<d&&e.splice(d,1));e&&!e.length&&a.clearQueue(j,f);return e},clearQueues:function(a){e.removeData(a,c)},clearQueue:function(a,
f){var f=f||g,d=e.data(a,c);d&&delete d[f];b.isEmptyObject(d)&&e.removeData(a,c)},dequeue:function(b,e){var d=h(b,e,1);d&&(d.shift(),d.length||a.clearQueue(b,e));return d}}});
KISSY.add("anim/base/utils",["./queue","dom"],function(b,l){var h=l("./queue"),e=l("dom"),c=b.guid("ks-anim-unqueued-"+b.now()+"-"),g=b.guid("ks-anim-paused-"+b.now()+"-");return{saveRunningAnim:function(a){var j=a.node,f=e.data(j,c);f||e.data(j,c,f={});f[b.stamp(a)]=a},removeRunningAnim:function(a){var j=a.node,f=e.data(j,c);f&&(delete f[b.stamp(a)],b.isEmptyObject(f)&&e.removeData(j,c))},isAnimPaused:function(a){var c=e.data(a.node,g);return c?!!c[b.stamp(a)]:0},removePausedAnim:function(a){var c=
a.node,f=e.data(c,g);f&&(delete f[b.stamp(a)],b.isEmptyObject(f)&&e.removeData(c,g))},savePausedAnim:function(a){var c=a.node,f=e.data(c,g);f||e.data(c,g,f={});f[b.stamp(a)]=a},isAnimRunning:function(a){var j=e.data(a.node,c);return j?!!j[b.stamp(a)]:0},isElPaused:function(a){return(a=e.data(a,g))&&!b.isEmptyObject(a)},isElRunning:function(a){return(a=e.data(a,c))&&!b.isEmptyObject(a)},pauseOrResumeQueue:function(a,j,f){a=e.data(a,"resume"===f?g:c);a=b.merge(a);b.each(a,function(a){if(void 0===j||
a.config.queue===j)a[f]()})},stopEl:function(a,j,f,d){f&&(void 0===d?h.clearQueues(a):!1!==d&&h.clearQueue(a,d));a=e.data(a,c);a=b.merge(a);b.each(a,function(a){(void 0===d||a.config.queue===d)&&a.stop(j)})}}});
KISSY.add("anim/base",["dom","./base/utils","./base/queue","promise"],function(b,l){function h(k,c,d,j,i){if(k.node)i=k;else{"string"===typeof c&&(c=b.unparam(""+c,";",":"),b.each(c,function(a,k){var e=b.trim(k);e&&(c[e]=b.trim(a));(!e||e!==k)&&delete c[k]}));if(b.isPlainObject(d))i=b.clone(d);else if(i={complete:i},d&&(i.duration=d),j)i.easing=j;i.node=k;i.to=c}i=b.merge(r,i);h.superclass.constructor.call(this);a.Defer(this);this.config=i;k=i.node;b.isPlainObject(k)||(k=e.get(i.node));this.node=
this.el=k;this._backupProps={};this._propsData={};var k={},c=i.to,g;for(g in c)k[f(g)]=c[g];i.to=k}var e=l("dom"),c=l("./base/utils"),g=l("./base/queue"),a=l("promise"),j=e.NodeType,f=b.camelCase,d=b.noop,n={toggle:1,hide:1,show:1},r={duration:1,easing:"linear"};b.extend(h,a,{prepareFx:d,runInternal:function(){var a=this,d=a.config,f=a.node,g,i=a._backupProps,h=a._propsData,m=d.to,l=d.delay||0,p=d.duration;c.saveRunningAnim(a);b.each(m,function(a,c){b.isPlainObject(a)||(a={value:a});h[c]=b.mix({delay:l,
easing:d.easing,frame:d.frame,duration:p},a)});if(f.nodeType===j.ELEMENT_NODE){if(m.width||m.height)m=f.style,b.mix(i,{overflow:m.overflow,"overflow-x":m.overflowX,"overflow-y":m.overflowY}),m.overflow="hidden","inline"===e.css(f,"display")&&"none"===e.css(f,"float")&&(m.zoom=1,m.display="inline-block");var q,o;o="none"===e.css(f,"display");b.each(h,function(b,c){g=b.value;if(n[g]){if("hide"===g&&o||"show"===g&&!o)return a.stop(!0),q=!1;i[c]=e.style(f,c);"toggle"===g&&(g=o?"show":"hide");"hide"===
g?(b.value=0,i.display="none"):(b.value=e.css(f,c),e.css(f,c,0),e.show(f))}});if(!1===q)return}a.startTime=b.now();b.isEmptyObject(h)?(a.__totalTime=1E3*p,a.__waitTimeout=setTimeout(function(){a.stop(!0)},a.__totalTime)):(a.prepareFx(),a.doStart())},isRunning:function(){return c.isAnimRunning(this)},isPaused:function(){return c.isAnimPaused(this)},pause:function(){this.isRunning()&&(this._runTime=b.now()-this.startTime,this.__totalTime-=this._runTime,c.removeRunningAnim(this),c.savePausedAnim(this),
this.__waitTimeout?clearTimeout(this.__waitTimeout):this.doStop());return this},doStop:d,doStart:d,resume:function(){var a=this;a.isPaused()&&(a.startTime=b.now()-a._runTime,c.removePausedAnim(a),c.saveRunningAnim(a),a.__waitTimeout?a.__waitTimeout=setTimeout(function(){a.stop(!0)},a.__totalTime):(a.beforeResume(),a.doStart()));return a},beforeResume:d,run:function(){var a;a=this.config.queue;!1===a?this.runInternal():(a=g.queue(this.node,a,this),1===a.length&&this.runInternal());return this},stop:function(a){var d=
this.node,f=this.config.queue;if(this.isResolved()||this.isRejected())return this;this.__waitTimeout&&(clearTimeout(this.__waitTimeout),this.__waitTimeout=0);if(!this.isRunning()&&!this.isPaused())return!1!==f&&g.remove(d,f,this),this;this.doStop(a);c.removeRunningAnim(this);c.removePausedAnim(this);var h=this.defer;if(a){var i,a=this.config.complete;b.isEmptyObject(i=this._backupProps)||e.css(this.node,i);a&&a.call(this);h.resolve([this])}else h.reject([this]);!1!==f&&(d=g.dequeue(d,f))&&d[0]&&d[0].runInternal();
return this}});var s=h.Statics={isRunning:c.isElRunning,isPaused:c.isElPaused,stop:c.stopEl,Q:g};b.each(["pause","resume"],function(a){s[a]=function(b,d){return null===d||"string"===typeof d||!1===d?c.pauseOrResumeQueue(b,d,a):c.pauseOrResumeQueue(b,void 0,a)}});return h});
