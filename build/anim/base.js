/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: May 9 13:52
*/
KISSY.add("anim/base",["dom","./base/utils","./base/queue","promise"],function(c,l){function i(g,d,f,e,j){if(g.node)j=g;else{"string"===typeof d&&(d=c.unparam(""+d,";",":"),c.each(d,function(g,a){var b=c.trim(a);b&&(d[b]=c.trim(g));(!b||b!==a)&&delete d[a]}));if(c.isPlainObject(f))j=c.clone(f);else if(j={complete:j},f&&(j.duration=f),e)j.easing=e;j.node=g;j.to=d}j=c.merge(n,j);i.superclass.constructor.call(this);a.Defer(this);this.config=j;g=j.node;c.isPlainObject(g)||(g=h.get(j.node));this.node=
this.el=g;this._backupProps={};this._propsData={};var g={},d=j.to,m;for(m in d)g[b(m)]=d[m];j.to=g}var h=l("dom"),e=l("./base/utils"),k=l("./base/queue"),a=l("promise"),d=h.NodeType,b=c.camelCase,f=c.noop,m={toggle:1,hide:1,show:1},n={duration:1,easing:"linear"};c.extend(i,a,{prepareFx:f,runInternal:function(){var g=this,a=g.config,b=g.node,f,j=g._backupProps,k=g._propsData,i=a.to,l=a.delay||0,n=a.duration;e.saveRunningAnim(g);c.each(i,function(g,b){c.isPlainObject(g)||(g={value:g});k[b]=c.mix({delay:l,
easing:a.easing,frame:a.frame,duration:n},g)});if(b.nodeType===d.ELEMENT_NODE){if(i.width||i.height)i=b.style,c.mix(j,{overflow:i.overflow,"overflow-x":i.overflowX,"overflow-y":i.overflowY}),i.overflow="hidden","inline"===h.css(b,"display")&&"none"===h.css(b,"float")&&(i.zoom=1,i.display="inline-block");var p,o;o="none"===h.css(b,"display");c.each(k,function(a,d){f=a.value;if(m[f]){if("hide"===f&&o||"show"===f&&!o)return g.stop(!0),p=!1;j[d]=h.style(b,d);"toggle"===f&&(f=o?"show":"hide");"hide"===
f?(a.value=0,j.display="none"):(a.value=h.css(b,d),h.css(b,d,0),h.show(b))}});if(!1===p)return}g.startTime=c.now();c.isEmptyObject(k)?(g.__totalTime=1E3*n,g.__waitTimeout=setTimeout(function(){g.stop(!0)},g.__totalTime)):(g.prepareFx(),g.doStart())},isRunning:function(){return e.isAnimRunning(this)},isPaused:function(){return e.isAnimPaused(this)},pause:function(){this.isRunning()&&(this._runTime=c.now()-this.startTime,this.__totalTime-=this._runTime,e.removeRunningAnim(this),e.savePausedAnim(this),
this.__waitTimeout?clearTimeout(this.__waitTimeout):this.doStop());return this},doStop:f,doStart:f,resume:function(){var a=this;a.isPaused()&&(a.startTime=c.now()-a._runTime,e.removePausedAnim(a),e.saveRunningAnim(a),a.__waitTimeout?a.__waitTimeout=setTimeout(function(){a.stop(!0)},a.__totalTime):(a.beforeResume(),a.doStart()));return a},beforeResume:f,run:function(){var a;a=this.config.queue;!1===a?this.runInternal():(a=k.queue(this.node,a,this),1===a.length&&this.runInternal());return this},stop:function(a){var d=
this.node,b=this.config.queue;if(this.isResolved()||this.isRejected())return this;this.__waitTimeout&&(clearTimeout(this.__waitTimeout),this.__waitTimeout=0);if(!this.isRunning()&&!this.isPaused())return!1!==b&&k.remove(d,b,this),this;this.doStop(a);e.removeRunningAnim(this);e.removePausedAnim(this);var f=this.defer;if(a){var i,a=this.config.complete;c.isEmptyObject(i=this._backupProps)||h.css(this.node,i);a&&a.call(this);f.resolve([this])}else f.reject([this]);!1!==b&&(d=k.dequeue(d,b))&&d[0]&&d[0].runInternal();
return this}});var q=i.Statics={isRunning:e.isElRunning,isPaused:e.isElPaused,stop:e.stopEl,Q:k};c.each(["pause","resume"],function(a){q[a]=function(d,b){return null===b||"string"===typeof b||!1===b?e.pauseOrResumeQueue(d,b,a):e.pauseOrResumeQueue(d,void 0,a)}});return i});
KISSY.add("anim/base/utils",["./queue","dom"],function(c,l){var i=l("./queue"),h=l("dom"),e=c.guid("ks-anim-unqueued-"+c.now()+"-"),k=c.guid("ks-anim-paused-"+c.now()+"-");return{saveRunningAnim:function(a){var d=a.node,b=h.data(d,e);b||h.data(d,e,b={});b[c.stamp(a)]=a},removeRunningAnim:function(a){var d=a.node,b=h.data(d,e);b&&(delete b[c.stamp(a)],c.isEmptyObject(b)&&h.removeData(d,e))},isAnimPaused:function(a){var d=h.data(a.node,k);return d?!!d[c.stamp(a)]:0},removePausedAnim:function(a){var d=
a.node,b=h.data(d,k);b&&(delete b[c.stamp(a)],c.isEmptyObject(b)&&h.removeData(d,k))},savePausedAnim:function(a){var d=a.node,b=h.data(d,k);b||h.data(d,k,b={});b[c.stamp(a)]=a},isAnimRunning:function(a){var d=h.data(a.node,e);return d?!!d[c.stamp(a)]:0},isElPaused:function(a){return(a=h.data(a,k))&&!c.isEmptyObject(a)},isElRunning:function(a){return(a=h.data(a,e))&&!c.isEmptyObject(a)},pauseOrResumeQueue:function(a,d,b){a=h.data(a,"resume"===b?k:e);a=c.merge(a);c.each(a,function(a){if(void 0===d||
a.config.queue===d)a[b]()})},stopEl:function(a,d,b,f){b&&(void 0===f?i.clearQueues(a):!1!==f&&i.clearQueue(a,f));a=h.data(a,e);a=c.merge(a);c.each(a,function(a){(void 0===f||a.config.queue===f)&&a.stop(d)})}}});
KISSY.add("anim/base/queue",["dom"],function(c,l){function i(a,b,c){var b=b||k,i,l=h.data(a,e);!l&&!c&&h.data(a,e,l={});l&&(i=l[b],!i&&!c&&(i=l[b]=[]));return i}var h=l("dom"),e=c.guid("ks-queue-"+c.now()+"-"),k=c.guid("ks-queue-"+c.now()+"-"),a;return a={queueCollectionKey:e,queue:function(a,b,c){a=i(a,b);a.push(c);return a},remove:function(d,b,f){var e=i(d,b,1);e&&(f=c.indexOf(f,e),-1<f&&e.splice(f,1));e&&!e.length&&a.clearQueue(d,b);return e},clearQueues:function(a){h.removeData(a,e)},clearQueue:function(a,
b){var b=b||k,f=h.data(a,e);f&&delete f[b];c.isEmptyObject(f)&&h.removeData(a,e)},dequeue:function(d,b){var c=i(d,b,1);c&&(c.shift(),c.length||a.clearQueue(d,b));return c}}});
