/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: May 14 22:13
*/
KISSY.add("anim/base",["dom","./base/utils","./base/queue","promise","util"],function(m,g){function l(i,b,c,e,j){if(i.node)j=i;else{"string"===typeof b&&(b=a.unparam(""+b,";",":"),a.each(b,function(i,c){var d=a.trim(c);d&&(b[d]=a.trim(i));(!d||d!==c)&&delete b[c]}));if(a.isPlainObject(c))j=a.clone(c);else if(j={complete:j},c&&(j.duration=c),e)j.easing=e;j.node=i;j.to=b}j=a.merge(n,j);l.superclass.constructor.call(this);k.Defer(this);this.config=j;i=j.node;a.isPlainObject(i)||(i=f.get(j.node));this.node=
this.el=i;this._backupProps={};this._propsData={};var i={},b=j.to,h;for(h in b)i[d(h)]=b[h];j.to=i}var f=g("dom"),c=g("./base/utils"),h=g("./base/queue"),k=g("promise"),a=g("util"),b=f.NodeType,d=a.camelCase,e=a.noop,p={toggle:1,hide:1,show:1},n={duration:1,easing:"linear"};a.extend(l,k,{prepareFx:e,runInternal:function(){var i=this,d=i.config,e=i.node,h,j=i._backupProps,k=i._propsData,g=d.to,l=d.delay||0,n=d.duration;c.saveRunningAnim(i);a.each(g,function(i,b){a.isPlainObject(i)||(i={value:i});k[b]=
a.mix({delay:l,easing:d.easing,frame:d.frame,duration:n},i)});if(e.nodeType===b.ELEMENT_NODE){if(g.width||g.height)g=e.style,a.mix(j,{overflow:g.overflow,"overflow-x":g.overflowX,"overflow-y":g.overflowY}),g.overflow="hidden","inline"===f.css(e,"display")&&"none"===f.css(e,"float")&&(g.zoom=1,g.display="inline-block");var m,o;o="none"===f.css(e,"display");a.each(k,function(a,b){h=a.value;if(p[h]){if("hide"===h&&o||"show"===h&&!o)return i.stop(!0),m=!1;j[b]=f.style(e,b);"toggle"===h&&(h=o?"show":"hide");
"hide"===h?(a.value=0,j.display="none"):(a.value=f.css(e,b),f.css(e,b,0),f.show(e))}});if(!1===m)return}i.startTime=a.now();a.isEmptyObject(k)?(i.__totalTime=1E3*n,i.__waitTimeout=setTimeout(function(){i.stop(!0)},i.__totalTime)):(i.prepareFx(),i.doStart())},isRunning:function(){return c.isAnimRunning(this)},isPaused:function(){return c.isAnimPaused(this)},pause:function(){this.isRunning()&&(this._runTime=a.now()-this.startTime,this.__totalTime-=this._runTime,c.removeRunningAnim(this),c.savePausedAnim(this),
this.__waitTimeout?clearTimeout(this.__waitTimeout):this.doStop());return this},doStop:e,doStart:e,resume:function(){var b=this;b.isPaused()&&(b.startTime=a.now()-b._runTime,c.removePausedAnim(b),c.saveRunningAnim(b),b.__waitTimeout?b.__waitTimeout=setTimeout(function(){b.stop(!0)},b.__totalTime):(b.beforeResume(),b.doStart()));return b},beforeResume:e,run:function(){var b;b=this.config.queue;!1===b?this.runInternal():(b=h.queue(this.node,b,this),1===b.length&&this.runInternal());return this},stop:function(b){var d=
this.node,e=this.config.queue;if(this.isResolved()||this.isRejected())return this;this.__waitTimeout&&(clearTimeout(this.__waitTimeout),this.__waitTimeout=0);if(!this.isRunning()&&!this.isPaused())return!1!==e&&h.remove(d,e,this),this;this.doStop(b);c.removeRunningAnim(this);c.removePausedAnim(this);var g=this.defer;if(b){var j,b=this.config.complete;a.isEmptyObject(j=this._backupProps)||f.css(this.node,j);b&&b.call(this);g.resolve([this])}else g.reject([this]);!1!==e&&(d=h.dequeue(d,e))&&d[0]&&d[0].runInternal();
return this}});var q=l.Statics={isRunning:c.isElRunning,isPaused:c.isElPaused,stop:c.stopEl,Q:h};a.each(["pause","resume"],function(b){q[b]=function(a,d){return null===d||"string"===typeof d||!1===d?c.pauseOrResumeQueue(a,d,b):c.pauseOrResumeQueue(a,void 0,b)}});return l});
KISSY.add("anim/base/utils",["./queue","util","dom"],function(m,g){var l=g("./queue"),f=g("util"),c=g("dom"),h=f.guid("ks-anim-unqueued-"+f.now()+"-"),k=f.guid("ks-anim-paused-"+f.now()+"-");return{saveRunningAnim:function(a){var b=a.node,d=c.data(b,h);d||c.data(b,h,d={});d[f.stamp(a)]=a},removeRunningAnim:function(a){var b=a.node,d=c.data(b,h);d&&(delete d[f.stamp(a)],f.isEmptyObject(d)&&c.removeData(b,h))},isAnimPaused:function(a){var b=c.data(a.node,k);return b?!!b[f.stamp(a)]:0},removePausedAnim:function(a){var b=
a.node,d=c.data(b,k);d&&(delete d[f.stamp(a)],f.isEmptyObject(d)&&c.removeData(b,k))},savePausedAnim:function(a){var b=a.node,d=c.data(b,k);d||c.data(b,k,d={});d[f.stamp(a)]=a},isAnimRunning:function(a){var b=c.data(a.node,h);return b?!!b[f.stamp(a)]:0},isElPaused:function(a){return(a=c.data(a,k))&&!f.isEmptyObject(a)},isElRunning:function(a){return(a=c.data(a,h))&&!f.isEmptyObject(a)},pauseOrResumeQueue:function(a,b,d){a=c.data(a,"resume"===d?k:h);a=f.merge(a);f.each(a,function(a){if(void 0===b||
a.config.queue===b)a[d]()})},stopEl:function(a,b,d,e){d&&(void 0===e?l.clearQueues(a):!1!==e&&l.clearQueue(a,e));a=c.data(a,h);a=f.merge(a);f.each(a,function(a){(void 0===e||a.config.queue===e)&&a.stop(b)})}}});
KISSY.add("anim/base/queue",["dom","util"],function(m,g){function l(b,a,e){var a=a||k,c,g=f.data(b,h);!g&&!e&&f.data(b,h,g={});g&&(c=g[a],!c&&!e&&(c=g[a]=[]));return c}var f=g("dom"),c=g("util"),h=c.guid("ks-queue-"+c.now()+"-"),k=c.guid("ks-queue-"+c.now()+"-"),a;return a={queueCollectionKey:h,queue:function(b,a,c){b=l(b,a);b.push(c);return b},remove:function(b,d,e){var f=l(b,d,1);f&&(e=c.indexOf(e,f),-1<e&&f.splice(e,1));f&&!f.length&&a.clearQueue(b,d);return f},clearQueues:function(b){f.removeData(b,
h)},clearQueue:function(b,a){var a=a||k,e=f.data(b,h);e&&delete e[a];c.isEmptyObject(e)&&f.removeData(b,h)},dequeue:function(b,c){var e=l(b,c,1);e&&(e.shift(),e.length||a.clearQueue(b,c));return e}}});
