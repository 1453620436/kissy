/*
Copyright 2014, KISSY v1.50
MIT Licensed
build time: Feb 25 19:32
*/
KISSY.add("component/control/process",["base","promise"],function(f,k){function c(b){b.fire("beforeSyncUI");b.syncUI();b.__callPluginsMethod("pluginSyncUI");b.fire("afterSyncUI")}var j=k("base"),g=j.prototype.__getHook,i=f.noop,h=k("promise").Defer,l=j.extend({bindInternal:i,syncInternal:i,initializer:function(){this._renderedDefer=new h},renderUI:i,syncUI:i,bindUI:i,onRendered:function(b){return this._renderedDefer.promise.then(b)},create:function(){this.get("created")||(this.fire("beforeCreateDom"),
this.createDom(),this.__callPluginsMethod("pluginCreateDom"),this.fire("afterCreateDom"),this.setInternal("created",!0));return this},render:function(){this.get("rendered")||(this.create(),this.fire("beforeRenderUI"),this.renderUI(),this.__callPluginsMethod("pluginRenderUI"),this.fire("afterRenderUI"),this.fire("beforeBindUI"),l.superclass.bindInternal.call(this),this.bindUI(),this.__callPluginsMethod("pluginBindUI"),this.fire("afterBindUI"),l.superclass.syncInternal.call(this),c(this),this.setInternal("rendered",
!0));return this},sync:function(){c(this)},plug:function(b){var c=this.get("plugins");this.callSuper(b);b=c[c.length-1];this.get("rendered")?(b.pluginCreateDom&&b.pluginCreateDom(this),b.pluginRenderUI&&b.pluginCreateDom(this),b.pluginBindUI&&b.pluginBindUI(this),b.pluginSyncUI&&b.pluginSyncUI(this)):this.get("created")&&b.pluginCreateDom&&b.pluginCreateDom(this);return this}},{__hooks__:{createDom:g("__createDom"),renderUI:g("__renderUI"),bindUI:g("__bindUI"),syncUI:g("__syncUI")},name:"ControlProcess",
ATTRS:{rendered:{value:!1,setter:function(b){b&&this._renderedDefer.resolve(this)}},created:{value:!1}}});return l});
KISSY.add("component/control/render-xtpl",[],function(){var f=function(f,c,j,g){var i=c.escapeHtml,h=this.utils.callCommand,l=this.nativeCommands.each,c='<div id="',b=f.resolve(["id"]),c=c+i(b),c=c+'"\n class="',g=h(this,f,g,"getBaseCssClasses",2),c=c+i(g),c=c+"\n",g={},h=[],b=f.resolve(["elCls"]);h.push(b);g.params=h;g.fn=function(b){var a;a="\n ";b=b.resolve(["this"]);a+=i(b);return a+"\n"};c+=l.call(this,f,g,j);c+='\n"\n\n';g={};h=[];b=f.resolve(["elAttrs"]);h.push(b);g.params=h;g.fn=function(b){var a;
a="\n ";var d=b.resolve(["xindex"]);a+=i(d);a+='="';b=b.resolve(["this"]);a+=i(b);return a+'"\n'};c+=l.call(this,f,g,j);c+='\n\nstyle="\n';g={};h=[];b=f.resolve(["elStyle"]);h.push(b);g.params=h;g.fn=function(b){var a;a="\n ";var d=b.resolve(["xindex"]);a+=i(d);a+=":";b=b.resolve(["this"]);a+=i(b);return a+";\n"};c+=l.call(this,f,g,j);return c+'\n">'};f.TPL_NAME="E:/code/kissy_git/kissy/kissy/src/component/sub-modules/control/src/control/render.xtpl.html";return f});
KISSY.add("component/control/render",["base","node","xtemplate/runtime","./render-xtpl","component/manager"],function(f,k){function c(a){"number"===typeof a&&(a+="px");return a}function j(a){a||(a=[""]);"string"===typeof a&&(a=a.split(/\s+/));return a}function g(a,e,b){for(var d="",c=0,f=b.length,e=a+e;c<f;c++)a=(a=b[c])?"-"+a:a,d+=" "+e+a;return d}function i(a){var e;a.target===this.control&&(e=this[n+a.type.slice(5).slice(0,-6)],e.call(this,a.newVal,a))}function h(a,e){return this.config.view.getBaseCssClasses(e&&
e.params[0])}function l(a,e){return this.config.view.getBaseCssClass(e.params[0])}var b=k("base"),m=b.prototype.__getHook,a=f.noop,d=k("node"),p=k("xtemplate/runtime"),q=k("./render-xtpl"),r=k("component/manager"),n="_onSet",o=f.trim,s=d.all,t=f.UA,u=f.Env.host.document;return b.extend({bindInternal:a,syncInternal:a,isRender:!0,create:function(){var a=this.control.get("srcNode");a?this.decorateDom(a):this.createDom()},beforeCreateDom:function(a){var e=this.control,b,d,f,g=e.get("elAttrs"),i=e.get("elCls"),
h;b=e.getAttrs();h=e.get("elStyle");var k=e.get("elCls");for(d in b)f=b[d],f.view&&(a[d]=e.get(d));b=a.width;d=a.height;f=a.visible;a=a.zIndex;b&&(h.width=c(b));d&&(h.height=c(d));a&&(h["z-index"]=a);f||k.push(this.getBaseCssClasses("hidden"));if(h=e.get("disabled"))i.push(this.getBaseCssClasses("disabled")),g["aria-disabled"]="true";e.get("highlighted")&&i.push(this.getBaseCssClasses("hover"));e.get("focusable")&&(9>t.ieMode&&(g.hideFocus="true"),g.tabindex=h?"-1":"0")},createDom:function(){this.beforeCreateDom(this.renderData=
{},this.childrenElSelectors={},this.renderCommands={getBaseCssClasses:h,getBaseCssClass:l});var a=this.control,e;e=this.renderTpl(q)+this.renderTpl(this.get("contentTpl"))+"</div>";a.setInternal("el",this.$el=s(e));this.el=this.$el[0];this.fillChildrenElsBySelectors()},decorateDom:function(a){var e=this.control;a.attr("id")||a.attr("id",e.get("id"));var b=this.constructor.HTML_PARSER,d,c;for(d in b)c=b[d],"function"===typeof c?(c=c.call(this,a),void 0!==c&&e.setInternal(d,c)):"string"===typeof c?
e.setInternal(d,a.one(c)):f.isArray(c)&&c[0]&&e.setInternal(d,a.all(c[0]));e.setInternal("el",this.$el=a);this.el=a[0]},renderUI:function(){var a=this.control,e=this.$el;if(!a.get("srcNode")){var b=a.get("render");(a=a.get("elBefore"))?e.insertBefore(a,void 0):b?e.appendTo(b,void 0):e.appendTo(u.body,void 0)}},bindUI:function(){var a=this.control,e=a.getAttrs(),b,d;for(b in e){d=e[b];var c=f.ucfirst(b),g=this[n+c];if(d.view&&g)a.on("after"+c+"Change",i,this)}},syncUI:a,destructor:function(){this.$el&&
this.$el.remove()},$:function(a){return this.$el.all(a)},fillChildrenElsBySelectors:function(a){var e=this.$el,b=this.control,d,c,a=a||this.childrenElSelectors;for(d in a)c=a[d],"function"===typeof c?b.setInternal(d,c(e)):b.setInternal(d,this.$(f.substitute(c,this.renderData))),delete a[d]},renderTpl:function(a,e,b){e=e||this.renderData;b=b||this.renderCommands;return(new (this.get("xtemplate"))(a,{control:this.control,view:this,commands:b})).render(e)},getComponentConstructorByNode:function(a,b){var d=
b[0].className;return d?(d=d.replace(RegExp("\\b"+a,"ig"),""),r.getConstructorByXClass(d)):null},getComponentCssClasses:function(){if(this.componentCssClasses)return this.componentCssClasses;for(var a=this.control.constructor,b,d=[];a&&!a.prototype.hasOwnProperty("isControl");)(b=a.xclass)&&d.push(b),a=a.superclass&&a.superclass.constructor;return this.componentCssClasses=d},getBaseCssClasses:function(a){for(var a=j(a),b=this.getComponentCssClasses(),d=0,c=this.get("control"),f="",h=b.length,c=c.get("prefixCls");d<
h;d++)f+=g(c,b[d],a);return o(f)},getBaseCssClass:function(a){return o(g(this.control.get("prefixCls"),this.getComponentCssClasses()[0],j(a)))},getKeyEventTarget:function(){return this.$el},_onSetWidth:function(a){this.$el.width(a)},_onSetHeight:function(a){this.$el.height(a)},_onSetContent:function(a){var b=this.$el;b.html(a);this.get("allowTextSelection")||b.unselectable()},_onSetVisible:function(a){var b=this.$el,d=this.getBaseCssClasses("hidden");a?b.removeClass(d):b.addClass(d)},_onSetHighlighted:function(a){var b=
this.getBaseCssClasses("hover");this.$el[a?"addClass":"removeClass"](b)},_onSetDisabled:function(a){var b=this.control,d=this.getBaseCssClasses("disabled");this.$el[a?"addClass":"removeClass"](d).attr("aria-disabled",a);b.get("focusable")&&this.getKeyEventTarget().attr("tabindex",a?-1:0)},_onSetActive:function(a){var b=this.getBaseCssClasses("active");this.$el[a?"addClass":"removeClass"](b).attr("aria-pressed",!!a)},_onSetFocused:function(a){var b=this.$el,d=this.getBaseCssClasses("focused");b[a?
"addClass":"removeClass"](d)},_onSetZIndex:function(a){this.$el.css("z-index",a)}},{__hooks__:{createDom:m("__createDom"),renderUI:m("__renderUI"),bindUI:m("__bindUI"),syncUI:m("__syncUI"),decorateDom:m("__decorateDom"),beforeCreateDom:m("__beforeCreateDom")},extend:function e(a,d,c){var g,h={};g=b.extend.apply(this,arguments);g.HTML_PARSER=g.HTML_PARSER||{};f.isArray(a)&&(f.each(a.concat(g),function(a){a&&f.each(a.HTML_PARSER,function(a,b){h[b]=a})}),g.HTML_PARSER=h);f.mix(g.HTML_PARSER,this.HTML_PARSER,
!1);g.extend=e;return g},ATTRS:{control:{setter:function(a){this.control=a}},xtemplate:{value:p},contentTpl:{value:function(a){return a.get("content")||""}}},HTML_PARSER:{id:function(a){return(a=a[0].id)?a:void 0},content:function(a){return a.html()},disabled:function(a){return a.hasClass(this.getBaseCssClass("disabled"))}},name:"render"})});
KISSY.add("component/control",["node","./control/process","component/manager","./control/render"],function(f,k){function c(){var a,b=this;do a=b.ATTRS,b=b.superclass;while(!a||!a.xrender);return a.xrender.value}var j=k("node"),g=k("./control/process"),i=k("component/manager"),h=k("./control/render"),l=f.UA.ieMode,b=j.Gesture,m=f.Feature.isTouchGestureSupported(),h=g.extend({isControl:!0,createDom:function(){var a=this.get("xrender"),b=this.get("view"),c=this.get("id");b?b.set("control",this):this.set("view",
this.view=b=new a({control:this}));b.create();a=b.getKeyEventTarget();this.get("allowTextSelection")||a.unselectable();i.addComponent(c,this)},renderUI:function(){this.view.renderUI();this.view.bindUI()},bindUI:function(){var a=this.view.getKeyEventTarget();if(this.get("focusable"))a.on("focus",this.handleFocus,this).on("blur",this.handleBlur,this).on("keydown",this.handleKeydown,this);if(this.get("handleGestureEvents")){a=this.$el;a.on("mouseenter",this.handleMouseEnter,this).on("mouseleave",this.handleMouseLeave,
this).on("contextmenu",this.handleContextMenu,this);a.on(b.start,this.handleMouseDown,this).on(b.end,this.handleMouseUp,this).on(b.tap,this.handleClick,this);if(b.cancel)a.on(b.cancel,this.handleMouseUp,this);if(9>l)a.on("dblclick",this.handleDblClick,this)}},syncUI:function(){this.view.syncUI()},destructor:function(){i.removeComponent(this.get("id"));this.view?this.view.destroy():this.get("srcNode")&&this.get("srcNode").remove()},createComponent:function(a,b){return i.createComponent(a,b||this)},
_onSetFocused:function(a){var b=this.view.getKeyEventTarget()[0];if(a)try{b.focus()}catch(c){}else b.ownerDocument.activeElement===b&&b.ownerDocument.body.focus()},_onSetX:function(a){this.$el.offset({left:a})},_onSetY:function(a){this.$el.offset({top:a})},_onSetVisible:function(a){this.fire(a?"show":"hide")},show:function(){this.render();this.set("visible",!0);return this},hide:function(){this.set("visible",!1);return this},focus:function(){this.get("focusable")&&this.set("focused",!0)},blur:function(){this.get("focusable")&&
this.set("focused",!1)},move:function(a,b){this.set({x:a,y:b})},handleDblClick:function(a){this.get("disabled")||this.handleDblClickInternal(a)},handleDblClickInternal:function(a){this.handleClickInternal(a)},handleMouseEnter:function(a){this.get("disabled")||this.handleMouseEnterInternal(a)},handleMouseEnterInternal:function(a){this.set("highlighted",!!a)},handleMouseLeave:function(a){this.get("disabled")||this.handleMouseLeaveInternal(a)},handleMouseLeaveInternal:function(a){this.set("active",!1);
this.set("highlighted",!a)},handleMouseDown:function(a){this.get("disabled")||this.handleMouseDownInternal(a)},handleMouseDownInternal:function(a){var b;if(1===a.which||m)this.get("activeable")&&this.set("active",!0),this.get("focusable")&&this.focus(),this.get("allowTextSelection")||(b=(b=a.target.nodeName)&&b.toLowerCase(),"input"!==b&&"textarea"!==b&&"button"!==b&&a.preventDefault())},handleMouseUp:function(a){this.get("disabled")||this.handleMouseUpInternal(a)},handleMouseUpInternal:function(a){this.get("active")&&
(1===a.which||m)&&this.set("active",!1)},handleContextMenu:function(a){this.get("disabled")||this.handleContextMenuInternal(a)},handleContextMenuInternal:function(){},handleFocus:function(){this.get("disabled")||this.handleFocusInternal()},handleFocusInternal:function(){this.focus();this.fire("focus")},handleBlur:function(){this.get("disabled")||this.handleBlurInternal()},handleBlurInternal:function(){this.blur();this.fire("blur")},handleKeydown:function(a){if(!this.get("disabled")&&this.handleKeyDownInternal(a))return a.halt(),
!0},handleKeyDownInternal:function(a){if(a.keyCode===j.KeyCode.ENTER)return this.handleClickInternal(a)},handleClick:function(a){this.get("disabled")||this.handleClickInternal(a)},handleClickInternal:function(){this.get("focusable")&&this.focus()}},{name:"control",ATTRS:{id:{view:1,valueFn:function(){return f.guid("ks-component")}},content:{view:1,value:""},width:{view:1},height:{view:1},elCls:{view:1,value:[],setter:function(a){"string"===typeof a&&(a=a.split(/\s+/));return a||[]}},elStyle:{view:1,
value:{}},elAttrs:{view:1,value:{}},elBefore:{},el:{setter:function(a){this.$el=a;this.el=a[0]}},x:{},y:{},xy:{setter:function(a){var b=f.makeArray(a);b.length&&(void 0!==b[0]&&this.set("x",b[0]),void 0!==b[1]&&this.set("y",b[1]));return a},getter:function(){return[this.get("x"),this.get("y")]}},zIndex:{view:1},render:{},visible:{sync:0,value:!0,view:1},srcNode:{setter:function(a){return j.all(a)}},handleGestureEvents:{value:!0},focusable:{value:!0,view:1},allowTextSelection:{value:!1},activeable:{value:!0},
focused:{view:1},active:{view:1,value:!1},highlighted:{view:1,value:!1},prefixCls:{view:1,value:f.config("component/prefixCls")||"ks-"},prefixXClass:{},parent:{setter:function(a,b){(b=this.get("parent"))&&this.removeTarget(b);a&&this.addTarget(a)}},disabled:{view:1,value:!1},xrender:{value:h},view:{setter:function(a){this.view=a}}}});h.getDefaultRender=c;h.extend=function d(b,h,k){var j=f.makeArray(arguments),l,m=j[j.length-1];if(l=m.xclass)m.name=l;j=g.extend.apply(this,j);l&&i.setConstructorByXClass(l,
j);j.extend=d;j.getDefaultRender=c;return j};return h});
