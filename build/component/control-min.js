/*
Copyright 2014, KISSY v1.50
MIT Licensed
build time: Jan 24 20:11
*/
KISSY.add("component/control/process",["base","promise"],function(f,c){function i(b){b.fire("beforeSyncUI");b.syncUI();b.__callPluginsMethod("pluginSyncUI");b.fire("afterSyncUI")}var m=c("base"),j=m.prototype.__getHook,l=f.noop,d=c("promise").Defer,k=m.extend({bindInternal:l,syncInternal:l,initializer:function(){this._renderedDefer=new d},renderUI:l,syncUI:l,bindUI:l,onRendered:function(b){return this._renderedDefer.promise.then(b)},create:function(){this.get("created")||(this.fire("beforeCreateDom"),
this.createDom(),this.__callPluginsMethod("pluginCreateDom"),this.fire("afterCreateDom"),this.setInternal("created",!0));return this},render:function(){this.get("rendered")||(this.create(),this.fire("beforeRenderUI"),this.renderUI(),this.__callPluginsMethod("pluginRenderUI"),this.fire("afterRenderUI"),this.fire("beforeBindUI"),k.superclass.bindInternal.call(this),this.bindUI(),this.__callPluginsMethod("pluginBindUI"),this.fire("afterBindUI"),k.superclass.syncInternal.call(this),i(this),this.setInternal("rendered",
!0));return this},sync:function(){i(this)},plug:function(b){var c=this.get("plugins");this.callSuper(b);b=c[c.length-1];this.get("rendered")?(b.pluginCreateDom&&b.pluginCreateDom(this),b.pluginRenderUI&&b.pluginCreateDom(this),b.pluginBindUI&&b.pluginBindUI(this),b.pluginSyncUI&&b.pluginSyncUI(this)):this.get("created")&&b.pluginCreateDom&&b.pluginCreateDom(this);return this}},{__hooks__:{createDom:j("__createDom"),renderUI:j("__renderUI"),bindUI:j("__bindUI"),syncUI:j("__syncUI")},name:"ControlProcess",
ATTRS:{rendered:{value:!1,setter:function(c){c&&this._renderedDefer.resolve(this)}},created:{value:!1}}});return k});
KISSY.add("component/control/render-xtpl",[],function(){return function(f){var c,i=this;c=this.config.utils;var m=c.runBlockCommand,j=c.renderOutput,l=c.getProperty,d=c.runInlineCommand,k=c.getPropertyOrRunCommand;c='<div id="';var b=k(i,f,{},"id",0,1);c+=j(b,!0);c+='"\n class="';var b={},e=[];e.push("");b.params=e;d=d(i,f,b,"getBaseCssClasses",2);c+=j(d,!0);c+="\n";d={};b=[];e=l(i,f,"elCls",0,3);b.push(e);d.params=b;d.fn=function(c){var b;b="\n ";c=k(i,c,{},".",0,4);b+=j(c,!0);return b+"  \n"};c+=
m(i,f,d,"each",3);c+='\n"\n\n';d={};b=[];e=l(i,f,"elAttrs",0,8);b.push(e);d.params=b;d.fn=function(c){var b;b=" \n ";var a=k(i,c,{},"xindex",0,9);b+=j(a,!0);b+='="';c=k(i,c,{},".",0,9);b+=j(c,!0);return b+'"\n'};c+=m(i,f,d,"each",8);c+='\n\nstyle="\n';d={};b=[];l=l(i,f,"elStyle",0,13);b.push(l);d.params=b;d.fn=function(c){var b;b=" \n ";var a=k(i,c,{},"xindex",0,14);b+=j(a,!0);b+=":";c=k(i,c,{},".",0,14);b+=j(c,!0);return b+";\n"};c+=m(i,f,d,"each",13);return c+'\n">'}});
KISSY.add("component/control/render",["base","node","xtemplate/runtime","./render-xtpl","component/manager"],function(f,c){function i(g){"number"===typeof g&&(g+="px");return g}function m(g){g||(g=[""]);"string"===typeof g&&(g=g.split(/\s+/));return g}function j(g,a,b){for(var c="",h=0,f=b.length,a=g+a;h<f;h++)g=(g=b[h])?"-"+g:g,c+=" "+a+g;return c}function l(g){var a;g.target===this.control&&(a=this[p+g.type.slice(5).slice(0,-6)],a.call(this,g.newVal,g))}function d(g,a){return this.config.view.getBaseCssClasses(a.params[0])}
function k(g,a){return this.config.view.getBaseCssClass(a.params[0])}var b=c("base"),e=b.prototype.__getHook,n=f.noop,o=c("node"),a=c("xtemplate/runtime"),h=c("./render-xtpl"),s=c("component/manager"),p="_onSet",q=f.trim,t=o.all,u=f.UA,v=f.Env.host.document;return b.extend({bindInternal:n,syncInternal:n,isRender:!0,create:function(){var g=this.control.get("srcNode");g?this.decorateDom(g):this.createDom()},beforeCreateDom:function(g){var a=this.control,b,c,h,f=a.get("elAttrs"),d=a.get("elCls"),e;b=
a.getAttrs();e=a.get("elStyle");var j=a.get("elCls");for(c in b)h=b[c],h.view&&(g[c]=a.get(c));b=g.width;c=g.height;h=g.visible;g=g.zIndex;b&&(e.width=i(b));c&&(e.height=i(c));g&&(e["z-index"]=g);h||j.push(this.getBaseCssClasses("hidden"));if(e=a.get("disabled"))d.push(this.getBaseCssClasses("disabled")),f["aria-disabled"]="true";a.get("highlighted")&&d.push(this.getBaseCssClasses("hover"));a.get("focusable")&&(9>u.ieMode&&(f.hideFocus="true"),f.tabindex=e?"-1":"0")},createDom:function(){this.beforeCreateDom(this.renderData=
{},this.childrenElSelectors={},this.renderCommands={getBaseCssClasses:d,getBaseCssClass:k});var a=this.control,b;b=this.renderTpl(h)+this.renderTpl(this.get("contentTpl"))+"</div>";a.setInternal("el",this.$el=t(b));this.el=this.$el[0];this.fillChildrenElsBySelectors()},decorateDom:function(a){var b=this.control;a.attr("id")||a.attr("id",b.get("id"));var c=this.constructor.HTML_PARSER,h,d;for(h in c)d=c[h],"function"===typeof d?(d=d.call(this,a),void 0!==d&&b.setInternal(h,d)):"string"===typeof d?
b.setInternal(h,a.one(d)):f.isArray(d)&&d[0]&&b.setInternal(h,a.all(d[0]));b.setInternal("el",this.$el=a);this.el=a[0]},renderUI:function(){var a=this.control,b=this.$el;if(!a.get("srcNode")){var c=a.get("render");(a=a.get("elBefore"))?b.insertBefore(a,void 0):c?b.appendTo(c,void 0):b.appendTo(v.body,void 0)}},bindUI:function(){var a=this.control,b=a.getAttrs(),c,h;for(c in b){h=b[c];var d=f.ucfirst(c),e=this[p+d];if(h.view&&e)a.on("after"+d+"Change",l,this)}},syncUI:n,destructor:function(){this.$el&&
this.$el.remove()},$:function(a){return this.$el.all(a)},fillChildrenElsBySelectors:function(a){var b=this.$el,c=this.control,h,d,a=a||this.childrenElSelectors;for(h in a)d=a[h],"function"===typeof d?c.setInternal(h,d(b)):c.setInternal(h,this.$(f.substitute(d,this.renderData))),delete a[h]},renderTpl:function(a,b,c){b=b||this.renderData;c=c||this.renderCommands;return(new (this.get("xtemplate"))(a,{control:this.control,view:this,commands:c})).render(b)},getComponentConstructorByNode:function(a,b){var c=
b[0].className;return c?(c=c.replace(RegExp("\\b"+a,"ig"),""),s.getConstructorByXClass(c)):null},getComponentCssClasses:function(){if(this.componentCssClasses)return this.componentCssClasses;for(var a=this.control.constructor,b,c=[];a&&!a.prototype.hasOwnProperty("isControl");)(b=a.xclass)&&c.push(b),a=a.superclass&&a.superclass.constructor;return this.componentCssClasses=c},getBaseCssClasses:function(a){for(var a=m(a),b=this.getComponentCssClasses(),c=0,h=this.get("control"),d="",f=b.length,h=h.get("prefixCls");c<
f;c++)d+=j(h,b[c],a);return q(d)},getBaseCssClass:function(a){return q(j(this.control.get("prefixCls"),this.getComponentCssClasses()[0],m(a)))},getKeyEventTarget:function(){return this.$el},_onSetWidth:function(a){this.$el.width(a)},_onSetHeight:function(a){this.$el.height(a)},_onSetContent:function(a){var b=this.$el;b.html(a);this.get("allowTextSelection")||b.unselectable()},_onSetVisible:function(a){var b=this.$el,c=this.getBaseCssClasses("hidden");a?b.removeClass(c):b.addClass(c)},_onSetHighlighted:function(a){var b=
this.getBaseCssClasses("hover");this.$el[a?"addClass":"removeClass"](b)},_onSetDisabled:function(a){var b=this.control,c=this.getBaseCssClasses("disabled");this.$el[a?"addClass":"removeClass"](c).attr("aria-disabled",a);b.get("focusable")&&this.getKeyEventTarget().attr("tabindex",a?-1:0)},_onSetActive:function(a){var b=this.getBaseCssClasses("active");this.$el[a?"addClass":"removeClass"](b).attr("aria-pressed",!!a)},_onSetFocused:function(a){var b=this.$el,c=this.getBaseCssClasses("focused");b[a?
"addClass":"removeClass"](c)},_onSetZIndex:function(a){this.$el.css("z-index",a)}},{__hooks__:{createDom:e("__createDom"),renderUI:e("__renderUI"),bindUI:e("__bindUI"),syncUI:e("__syncUI"),decorateDom:e("__decorateDom"),beforeCreateDom:e("__beforeCreateDom")},extend:function r(a,c,h){var d,e={};d=b.extend.apply(this,arguments);d.HTML_PARSER=d.HTML_PARSER||{};f.isArray(a)&&(f.each(a.concat(d),function(a){a&&f.each(a.HTML_PARSER,function(a,b){e[b]=a})}),d.HTML_PARSER=e);f.mix(d.HTML_PARSER,this.HTML_PARSER,
!1);d.extend=r;return d},ATTRS:{control:{setter:function(a){this.control=a}},xtemplate:{value:a},contentTpl:{value:function(a){return a.get("content")||""}}},HTML_PARSER:{id:function(a){return(a=a[0].id)?a:void 0},content:function(a){return a.html()},disabled:function(a){return a.hasClass(this.getBaseCssClass("disabled"))}},name:"render"})});
KISSY.add("component/control",["node","./control/process","component/manager","./control/render"],function(f,c){function i(){var a,b=this;do a=b.ATTRS,b=b.superclass;while(!a||!a.xrender);return a.xrender.value}var m=c("node"),j=c("./control/process"),l=c("component/manager"),d=c("./control/render"),k=f.UA.ieMode,b=f.Feature,e=m.Gesture,n=b.isTouchGestureSupported(),o=b.isTouchEventSupported(),d=j.extend({isControl:!0,createDom:function(){var a=this.get("xrender"),b=this.get("view"),c=this.get("id");
b?b.set("control",this):this.set("view",this.view=b=new a({control:this}));b.create();a=b.getKeyEventTarget();this.get("allowTextSelection")||a.unselectable();l.addComponent(c,this)},renderUI:function(){this.view.renderUI();this.view.bindUI()},bindUI:function(){var a=this.view.getKeyEventTarget();if(this.get("focusable"))a.on("focus",this.handleFocus,this).on("blur",this.handleBlur,this).on("keydown",this.handleKeydown,this);if(this.get("handleGestureEvents")){a=this.$el;if(!o)a.on("mouseenter",this.handleMouseEnter,
this).on("mouseleave",this.handleMouseLeave,this).on("contextmenu",this.handleContextMenu,this);a.on(e.start,this.handleMouseDown,this).on(e.end,this.handleMouseUp,this).on(e.tap,this.handleClick,this);if(e.cancel)a.on(e.cancel,this.handleMouseUp,this);if(9>k)a.on("dblclick",this.handleDblClick,this)}},syncUI:function(){this.view.syncUI()},destructor:function(){l.removeComponent(this.get("id"));this.view?this.view.destroy():this.get("srcNode")&&this.get("srcNode").remove()},createComponent:function(a,
b){return l.createComponent(a,b||this)},_onSetFocused:function(a){var b=this.view.getKeyEventTarget()[0];if(a)try{b.focus()}catch(c){b,"focus error","warn"}else b.ownerDocument.activeElement===b&&b.ownerDocument.body.focus()},_onSetX:function(a){this.$el.offset({left:a})},_onSetY:function(a){this.$el.offset({top:a})},_onSetVisible:function(a){this.fire(a?"show":"hide")},show:function(){this.render();this.set("visible",!0);return this},hide:function(){this.set("visible",!1);return this},focus:function(){this.get("focusable")&&
this.set("focused",!0)},blur:function(){this.get("focusable")&&this.set("focused",!1)},move:function(a,b){this.set({x:a,y:b})},handleDblClick:function(a){this.get("disabled")||this.handleDblClickInternal(a)},handleDblClickInternal:function(a){this.handleClickInternal(a)},handleMouseEnter:function(a){this.get("disabled")||this.handleMouseEnterInternal(a)},handleMouseEnterInternal:function(a){this.set("highlighted",!!a)},handleMouseLeave:function(a){this.get("disabled")||this.handleMouseLeaveInternal(a)},
handleMouseLeaveInternal:function(a){this.set("active",!1);this.set("highlighted",!a)},handleMouseDown:function(a){this.get("disabled")||this.handleMouseDownInternal(a)},handleMouseDownInternal:function(a){var b;if(1===a.which||n)this.get("activeable")&&this.set("active",!0),this.get("focusable")&&this.focus(),this.get("allowTextSelection")||(b=(b=a.target.nodeName)&&b.toLowerCase(),"input"!==b&&"textarea"!==b&&"button"!==b&&a.preventDefault())},handleMouseUp:function(a){this.get("disabled")||this.handleMouseUpInternal(a)},
handleMouseUpInternal:function(a){this.get("active")&&(1===a.which||n)&&this.set("active",!1)},handleContextMenu:function(a){this.get("disabled")||this.handleContextMenuInternal(a)},handleContextMenuInternal:function(){},handleFocus:function(){this.get("disabled")||this.handleFocusInternal()},handleFocusInternal:function(){this.focus();this.fire("focus")},handleBlur:function(){this.get("disabled")||this.handleBlurInternal()},handleBlurInternal:function(){this.blur();this.fire("blur")},handleKeydown:function(a){if(!this.get("disabled")&&
this.handleKeyDownInternal(a))return a.halt(),!0},handleKeyDownInternal:function(a){if(a.keyCode===m.KeyCode.ENTER)return this.handleClickInternal(a)},handleClick:function(a){this.get("disabled")||this.handleClickInternal(a)},handleClickInternal:function(){this.get("focusable")&&this.focus()}},{name:"control",ATTRS:{id:{view:1,valueFn:function(){return f.guid("ks-component")}},content:{view:1,value:""},width:{view:1},height:{view:1},elCls:{view:1,value:[],setter:function(a){"string"===typeof a&&(a=
a.split(/\s+/));return a||[]}},elStyle:{view:1,value:{}},elAttrs:{view:1,value:{}},elBefore:{},el:{setter:function(a){this.$el=a;this.el=a[0]}},x:{},y:{},xy:{setter:function(a){var b=f.makeArray(a);b.length&&(void 0!==b[0]&&this.set("x",b[0]),void 0!==b[1]&&this.set("y",b[1]));return a},getter:function(){return[this.get("x"),this.get("y")]}},zIndex:{view:1},render:{},visible:{sync:0,value:!0,view:1},srcNode:{setter:function(a){return m.all(a)}},handleGestureEvents:{value:!0},focusable:{value:!0,view:1},
allowTextSelection:{value:!1},activeable:{value:!0},focused:{view:1},active:{view:1,value:!1},highlighted:{view:1,value:!1},prefixCls:{view:1,value:f.config("component/prefixCls")||"ks-"},prefixXClass:{},parent:{setter:function(a,b){(b=this.get("parent"))&&this.removeTarget(b);a&&this.addTarget(a)}},disabled:{view:1,value:!1},xrender:{value:d},view:{setter:function(a){this.view=a}}}});d.getDefaultRender=i;d.extend=function h(b,c,d){var e=f.makeArray(arguments),k,m=e[e.length-1];if(k=m.xclass)m.name=
k;e=j.extend.apply(this,e);k&&l.setConstructorByXClass(k,e);e.extend=h;e.getDefaultRender=i;return e};return d});
