/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: Aug 26 16:04
*/
KISSY.add("component/control","util,node,event/gesture/basic,event/gesture/tap,./control/manager,base,./control/render-xtpl,ua,feature,xtemplate/runtime".split(","),function(l,i,n,p){function k(a){a||(a=[""]);typeof a==="string"&&(a=a.split(/\s+/));return a}function d(a,c,b){for(var o="",e=0,d=b.length,c=a+c;e<d;e++){a=(a=b[e])?"-"+a:a;o=o+(" "+c+a)}return o}function f(a){typeof a==="number"&&(a=a+"px");return a}function j(a,c){return this.root.config.control.getBaseCssClasses(c&&c.params&&c.params[0])}
function b(a,c){return this.root.config.control.getBaseCssClass(c.params[0])}var h=i("util"),r=i("node"),g=i("event/gesture/basic"),e=i("event/gesture/tap"),m=i("./control/manager"),s=i("base"),w=i("./control/render-xtpl"),x=i("ua"),n=i("feature"),l=s.prototype.__getHook,u=n.isTouchGestureSupported(),n=h.noop,y=i("xtemplate/runtime"),v=h.trim,z=document,q=p.exports=s.extend({isControl:true,bindInternal:n,syncInternal:n,initializer:function(){var a,c,t=this.getAttrs();this.renderData={};this.childrenElSelectors=
{};this.renderCommands={getBaseCssClasses:j,getBaseCssClass:b};for(a in t){c=t[a];if(c.selector)this.childrenElSelectors[a]=c.selector}},beforeCreateDom:function(a){var c,b,o,e=this.get("elAttrs");c=this.getAttrs();var d=this.get("elStyle"),h=this.get("elCls");for(b in c){o=c[b];o.render&&(a[b]=this.get(b))}c=a.width;b=a.height;o=a.visible;a=a.zIndex;if(c)d.width=f(c);if(b)d.height=f(b);a&&(d["z-index"]=a);o||h.push(this.getBaseCssClasses("hidden"));if(this.get("disabled")){h.push(this.getBaseCssClasses("disabled"));
e["aria-disabled"]="true"}this.get("highlighted")&&h.push(this.getBaseCssClasses("hover"))},createDom:function(){var a=this.renderTpl(w)+this.renderTpl(this.get("contentTpl"))+"</div>";this.$el=r(a);this.el=this.$el[0];this.fillChildrenElsBySelectors()},decorateDom:function(a){this.$el=a;this.el=a[0];this.fillChildrenElsBySelectors();var c,b,e=this.getAttrs();for(b in e){c=e[b];if(c.parse){c=c.parse.call(this,a);c!==void 0&&this.setInternal(b,c)}}},renderUI:function(){m.addComponent(this);var a=this.$el;
this.get("allowTextSelection")||a.unselectable();if(!this.get("srcNode")){var c=this.get("render"),b=this.get("elBefore");b?a.insertBefore(b,void 0):c?a.appendTo(c,void 0):a.appendTo(z.body,void 0)}},bindUI:function(){if(this.get("focusable")){var a=this.getKeyEventTarget();a.on("focus",this.handleFocus,this).on("blur",this.handleBlur,this).on("keydown",this.handleKeydown,this);x.ieMode<9&&a.attr("hideFocus",true);a.attr("tabindex",this.get("disabled")?"-1":"0")}if(this.get("handleGestureEvents"))this.$el.on("mouseenter",
this.handleMouseEnter,this).on("mouseleave",this.handleMouseLeave,this).on("contextmenu",this.handleContextMenu,this).on(g.START,this.handleMouseDown,this).on(g.END,this.handleMouseUp,this).on(e.TAP,this.handleClick,this)},syncUI:n,create:function(){if(!this.get("created")){this.fire("beforeCreateDom");var a=this.get("srcNode");a&&this.decorateDom(a);this.beforeCreateDom(this.renderData,this.renderCommands,this.childrenElSelectors);a||this.createDom();this.__callPluginsMethod("pluginCreateDom");this.fire("afterCreateDom");
this.setInternal("created",true)}return this},render:function(){if(!this.get("rendered")){this.create();this.fire("beforeRenderUI");this.renderUI();this.__callPluginsMethod("pluginRenderUI");this.fire("afterRenderUI");this.fire("beforeBindUI");q.superclass.bindInternal.call(this);this.bindUI();this.__callPluginsMethod("pluginBindUI");this.fire("afterBindUI");this.fire("beforeSyncUI");q.superclass.syncInternal.call(this);this.syncUI();this.__callPluginsMethod("pluginSyncUI");this.fire("afterSyncUI");
this.setInternal("rendered",true)}return this},plug:function(a){var c=this.get("plugins");this.callSuper(a);a=c[c.length-1];if(this.get("rendered")){a.pluginCreateDom&&a.pluginCreateDom(this);a.pluginRenderUI&&a.pluginCreateDom(this);a.pluginBindUI&&a.pluginBindUI(this);a.pluginSyncUI&&a.pluginSyncUI(this)}else this.get("created")&&a.pluginCreateDom&&a.pluginCreateDom(this);return this},getKeyEventTarget:function(){return this.$el},handleMouseEnter:function(a){this.get("disabled")||this.handleMouseEnterInternal(a)},
handleMouseEnterInternal:function(a){this.set("highlighted",!!a)},handleMouseLeave:function(a){this.get("disabled")||this.handleMouseLeaveInternal(a)},handleMouseLeaveInternal:function(a){this.set("active",false);this.set("highlighted",!a)},handleMouseDown:function(a){this.get("disabled")||this.handleMouseDownInternal(a)},handleMouseDownInternal:function(a){var c;if(a.which===1||u){this.get("activeable")&&this.set("active",true);this.get("focusable")&&this.focus();if(!this.get("allowTextSelection")&&
a.gestureType==="mouse"){c=(c=a.target.nodeName)&&c.toLowerCase();c!=="input"&&c!=="textarea"&&c!=="button"&&a.preventDefault()}}},handleMouseUp:function(a){this.get("disabled")||this.handleMouseUpInternal(a)},handleMouseUpInternal:function(a){this.get("active")&&(a.which===1||u)&&this.set("active",false)},handleContextMenu:function(a){this.get("disabled")||this.handleContextMenuInternal(a)},handleContextMenuInternal:function(){},handleFocus:function(){this.get("disabled")||this.handleFocusInternal()},
handleFocusInternal:function(){this.focus();this.fire("focus")},handleBlur:function(){this.get("disabled")||this.handleBlurInternal()},handleBlurInternal:function(){this.blur();this.fire("blur")},handleKeydown:function(a){if(!this.get("disabled")&&this.handleKeyDownInternal(a)){a.halt();return true}},handleKeyDownInternal:function(a){if(a.keyCode===r.Event.KeyCode.ENTER)return this.handleClickInternal(a)},handleClick:function(a){this.get("disabled")||this.handleClickInternal(a)},handleClickInternal:function(){this.get("focusable")&&
this.focus()},$:function(a){return this.$el.all(a)},fillChildrenElsBySelectors:function(a){var c=this.$el,b,e,a=a||this.childrenElSelectors;for(b in a){e=a[b];e=e.call(this,c);typeof e==="string"&&(e=this.$(e));this.setInternal(b,e)}},renderTpl:function(a,c,b){c=c||this.renderData;b=b||this.renderCommands;return(new y(a,{control:this,commands:b})).render(c)},getComponentConstructorByNode:function(a,c){var b=c[0].className;if(b){for(var b=b.split(/\s+/),e=[],d=0,f=b.length;d<f;d++){var g=h.trim(b[d]);
g&&h.startsWith(g,a)&&e.push(g.substring(a.length))}b=e.join(" ");return m.getConstructorByXClass(b)}return null},getComponentCssClasses:function(){if(this.componentCssClasses)return this.componentCssClasses;for(var a=this.constructor,c,b=[];a&&!a.prototype.hasOwnProperty("isControl");){(c=a.xclass)&&b.push(c);a=a.superclass&&a.superclass.constructor}return this.componentCssClasses=b},getBaseCssClasses:function(a){for(var a=k(a),c=this.getComponentCssClasses(),b=0,e="",h=c.length,g=this.get("prefixCls");b<
h;b++)e=e+d(g,c[b],a);return v(e)},getBaseCssClass:function(a){return v(d(this.get("prefixCls"),this.getComponentCssClasses()[0],k(a)))},createComponent:function(a,c){return m.createComponent(a,c||this)},show:function(){this.render();this.set("visible",true);return this},hide:function(){this.set("visible",false);return this},focus:function(){this.get("focusable")&&this.set("focused",true)},blur:function(){this.get("focusable")&&this.set("focused",false)},move:function(a,c){this.set({x:a,y:c})},_onSetWidth:function(a){this.$el.width(a)},
_onSetHeight:function(a){this.$el.height(a)},_onSetContent:function(a){var c=this.$el;c.html(a);this.get("allowTextSelection")||c.unselectable()},_onSetVisible:function(a){var c=this.$el,b=this.getBaseCssClasses("hidden");a?c.removeClass(b):c.addClass(b);this.fire(a?"show":"hide")},_onSetHighlighted:function(a){var b=this.getBaseCssClasses("hover");this.$el[a?"addClass":"removeClass"](b)},_onSetDisabled:function(a){var b=this.getBaseCssClasses("disabled");this.$el[a?"addClass":"removeClass"](b).attr("aria-disabled",
a);this.get("focusable")&&this.getKeyEventTarget().attr("tabindex",a?-1:0)},_onSetActive:function(a){var b=this.getBaseCssClasses("active");this.$el[a?"addClass":"removeClass"](b).attr("aria-pressed",!!a)},_onSetZIndex:function(a){this.$el.css("z-index",a)},_onSetFocused:function(a){var b=this.getKeyEventTarget()[0];if(a)try{b.focus()}catch(e){}else b.ownerDocument.activeElement===b&&b.ownerDocument.body.focus();var b=this.$el,d=this.getBaseCssClasses("focused");b[a?"addClass":"removeClass"](d)},
_onSetX:function(a){this.$el.offset({left:a})},_onSetY:function(a){this.$el.offset({top:a})},destructor:function(a){m.removeComponent(this);a!==false&&this.$el&&this.$el.remove()}},{__hooks__:{beforeCreateDom:l("__beforeCreateDom"),createDom:l("__createDom"),decorateDom:l("__decorateDom"),renderUI:l("__renderUI"),bindUI:l("__bindUI"),syncUI:l("__syncUI")},name:"control",ATTRS:{contentTpl:{value:function(a,b){return b.write(a.get("content"))}},content:{parse:function(a){return a.html()},render:1,sync:0,
value:""},width:{render:1,sync:0},height:{render:1,sync:0},elCls:{render:1,valueFn:function(){return[]},setter:function(a){typeof a==="string"&&(a=a.split(/\s+/));return a||[]}},elStyle:{render:1,valueFn:function(){return{}}},elAttrs:{render:1,valueFn:function(){return{}}},x:{},y:{},xy:{setter:function(a){var b=h.makeArray(a);if(b.length){b[0]!==void 0&&this.set("x",b[0]);b[1]!==void 0&&this.set("y",b[1])}return a},getter:function(){return[this.get("x"),this.get("y")]}},zIndex:{render:1,sync:0},visible:{render:1,
sync:0,value:true},activeable:{value:true},focused:{},active:{value:false},highlighted:{render:1,sync:0,value:false},disabled:{render:1,sync:0,value:false,parse:function(a){return a.hasClass(this.getBaseCssClass("disabled"))}},rendered:{value:false},created:{value:false},render:{},id:{render:1,parse:function(a){var b=a.attr("id");if(!b){b=h.guid("ks-component");a.attr("id",b)}return b},valueFn:function(){return h.guid("ks-component")}},elBefore:{},el:{getter:function(){return this.$el}},srcNode:{setter:function(a){return r(a)}},
handleGestureEvents:{value:false},focusable:{value:false},allowTextSelection:{value:true},prefixCls:{render:1,value:"ks-"},prefixXClass:{},parent:{setter:function(a,b){(b=this.get("parent"))&&this.removeTarget(b);a&&this.addTarget(a)}}}});q.extend=function c(b,e,d){var g=h.makeArray(arguments),f;if((g=g[g.length-1])&&(f=g.xclass))g.name=f;g=s.extend.apply(this,arguments);g.extend=c;f&&m.setConstructorByXClass(f,g);return g};q.Manager=m});
KISSY.add("component/control/manager",[],function(l,i,n,p){var k=0,d,f={},j={};p.exports=d={__instances:j,addComponent:function(b){j[b.get("id")]=b},removeComponent:function(b){delete j[b.get("id")]},getComponent:function(b){return j[b]},createComponent:function(b,h){var f,g;if(b){if(!b.isControl&&h&&(b.prefixCls||(b.prefixCls=h.get("prefixCls")),!b.xclass&&b.prefixXClass))b.xclass=b.prefixXClass,b.xtype&&(b.xclass+="-"+b.xtype);if(!b.isControl&&(g=b.xclass)){f=d.getConstructorByXClass(g);if(!f)throw Error("can not find class by xclass desc : "+
g);b=new f(b)}b.isControl&&h&&b.setInternal("parent",h)}return b},getConstructorByXClass:function(b){var b=b.split(/\s+/),d=-1,j,g,e,m=null;for(g=0;g<b.length;g++)if((e=f[b[g]])&&(j=e.priority)>d)d=j,m=e.constructor;return m},setConstructorByXClass:function(b,d){f[b]={constructor:d,priority:k++}}}});
KISSY.add("component/control/render-xtpl",[],function(l,i,n,p){p.exports=function(k,d,f){var j=this.pos={line:1,col:1},b=this.root.utils.callFn,h=this.root.nativeCommands.each;d.append('<div id="');var i=k.resolve(["id"]);d.writeEscaped(i);d.append('"\r\n class="');j.line=2;j.col=27;if((b=b(this,k,{escape:1},d,["getBaseCssClasses"]))&&b.isBuffer)d=b,b=f;d.writeEscaped(b);d.append("\r\n");f={escape:1};b=[];i=k.resolve(["elCls"]);b.push(i);f.params=b;f.fn=function(b,e){e.append("\r\n ");var d=b.resolve(["this"]);
e.writeEscaped(d);e.append("\r\n");return e};j.line=3;j.col=8;d=h.call(this,k,f,d);d.append('\r\n"\r\n\r\n');f={escape:1};b=[];i=k.resolve(["elAttrs"]);b.push(i);f.params=b;f.fn=function(b,e){e.append("\r\n ");var d=b.resolve(["xindex"]);e.writeEscaped(d);e.append('="');d=b.resolve(["this"]);e.writeEscaped(d);e.append('"\r\n');return e};j.line=8;j.col=8;d=h.call(this,k,f,d);d.append('\r\n\r\nstyle="\r\n');f={escape:1};b=[];i=k.resolve(["elStyle"]);b.push(i);f.params=b;f.fn=function(b,e){e.append("\r\n ");
var d=b.resolve(["xindex"]);e.writeEscaped(d);e.append(":");d=b.resolve(["this"]);e.writeEscaped(d);e.append(";\r\n");return e};j.line=13;j.col=8;d=h.call(this,k,f,d);d.append('\r\n">');return d};p.exports.TPL_NAME=p.name});
