/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: Apr 29 14:57
*/
KISSY.add("component/control","node,event/gesture/base,event/gesture/tap,component/manager,base,./control/render-xtpl,ua,xtemplate/runtime".split(","),function(k,f){function r(a){a||(a=[""]);typeof a==="string"&&(a=a.split(/\s+/));return a}function p(a,b,d){for(var l="",c=0,h=d.length,b=a+b;c<h;c++){a=(a=d[c])?"-"+a:a;l=l+(" "+b+a)}return l}function u(a){typeof a==="number"&&(a=a+"px");return a}function e(a,b){return this.config.control.getBaseCssClasses(b&&b.params&&b.params[0])}function n(a,b){return this.config.control.getBaseCssClass(b.params[0])}
var g=f("node"),i=f("event/gesture/base"),o=f("event/gesture/tap"),j=f("component/manager"),s=f("base"),c=f("./control/render-xtpl"),y=f("ua"),m=s.prototype.__getHook,v=k.Feature.isTouchGestureSupported(),t=k.noop,z=f("xtemplate/runtime"),w=k.trim,x=g.all,A=k.Env.host.document,q=s.extend({isControl:true,bindInternal:t,syncInternal:t,initializer:function(){var a,b,d=this.getAttrs();this.renderData={};this.childrenElSelectors={};this.renderCommands={getBaseCssClasses:e,getBaseCssClass:n};for(a in d){b=
d[a];if(b.selector)this.childrenElSelectors[a]=b.selector}},beforeCreateDom:function(a){var b,d,l,c=this.get("elAttrs"),h;b=this.getAttrs();h=this.get("elStyle");var e=this.get("elCls");for(d in b){l=b[d];l.render&&(a[d]=this.get(d))}b=a.width;d=a.height;l=a.visible;a=a.zIndex;if(b)h.width=u(b);if(d)h.height=u(d);a&&(h["z-index"]=a);l||e.push(this.getBaseCssClasses("hidden"));if(h=this.get("disabled")){e.push(this.getBaseCssClasses("disabled"));c["aria-disabled"]="true"}this.get("highlighted")&&e.push(this.getBaseCssClasses("hover"));
if(this.get("focusable")){if(y.ieMode<9)c.hideFocus="true";c.tabindex=h?"-1":"0"}},createDom:function(){var a=this.renderTpl(c)+this.renderTpl(this.get("contentTpl"))+"</div>";this.$el=x(a);this.el=this.$el[0];this.fillChildrenElsBySelectors()},decorateDom:function(a){this.$el=a;this.el=a[0];this.fillChildrenElsBySelectors();var b,d,c=this.getAttrs();for(d in c){b=c[d];if(b.parse){b=b.parse.call(this,a);b!==void 0&&this.setInternal(d,b)}}},renderUI:function(){j.addComponent(this);var a=this.$el;this.get("allowTextSelection")||
a.unselectable();if(!this.get("srcNode")){var b=this.get("render"),d=this.get("elBefore");d?a.insertBefore(d,void 0):b?a.appendTo(b,void 0):a.appendTo(A.body,void 0)}},bindUI:function(){if(this.get("focusable"))this.getKeyEventTarget().on("focus",this.handleFocus,this).on("blur",this.handleBlur,this).on("keydown",this.handleKeydown,this);if(this.get("handleGestureEvents"))this.$el.on("mouseenter",this.handleMouseEnter,this).on("mouseleave",this.handleMouseLeave,this).on("contextmenu",this.handleContextMenu,
this).on(i.START,this.handleMouseDown,this).on(i.END,this.handleMouseUp,this).on(o.TAP,this.handleClick,this)},syncUI:t,create:function(){if(!this.get("created")){this.fire("beforeCreateDom");var a=this.get("srcNode");a&&this.decorateDom(a);this.beforeCreateDom(this.renderData,this.renderCommands,this.childrenElSelectors);a||this.createDom();this.__callPluginsMethod("pluginCreateDom");this.fire("afterCreateDom");this.setInternal("created",true)}return this},render:function(){if(!this.get("rendered")){this.create();
this.fire("beforeRenderUI");this.renderUI();this.__callPluginsMethod("pluginRenderUI");this.fire("afterRenderUI");this.fire("beforeBindUI");q.superclass.bindInternal.call(this);this.bindUI();this.__callPluginsMethod("pluginBindUI");this.fire("afterBindUI");this.fire("beforeSyncUI");q.superclass.syncInternal.call(this);this.syncUI();this.__callPluginsMethod("pluginSyncUI");this.fire("afterSyncUI");this.setInternal("rendered",true)}return this},plug:function(a){var b=this.get("plugins");this.callSuper(a);
a=b[b.length-1];if(this.get("rendered")){a.pluginCreateDom&&a.pluginCreateDom(this);a.pluginRenderUI&&a.pluginCreateDom(this);a.pluginBindUI&&a.pluginBindUI(this);a.pluginSyncUI&&a.pluginSyncUI(this)}else this.get("created")&&a.pluginCreateDom&&a.pluginCreateDom(this);return this},getKeyEventTarget:function(){return this.$el},handleMouseEnter:function(a){this.get("disabled")||this.handleMouseEnterInternal(a)},handleMouseEnterInternal:function(a){this.set("highlighted",!!a)},handleMouseLeave:function(a){this.get("disabled")||
this.handleMouseLeaveInternal(a)},handleMouseLeaveInternal:function(a){this.set("active",false);this.set("highlighted",!a)},handleMouseDown:function(a){this.get("disabled")||this.handleMouseDownInternal(a)},handleMouseDownInternal:function(a){var b;if(a.which===1||v){this.get("activeable")&&this.set("active",true);this.get("focusable")&&this.focus();if(!this.get("allowTextSelection")&&a.gestureType==="mouse"){b=(b=a.target.nodeName)&&b.toLowerCase();b!=="input"&&b!=="textarea"&&b!=="button"&&a.preventDefault()}}},
handleMouseUp:function(a){this.get("disabled")||this.handleMouseUpInternal(a)},handleMouseUpInternal:function(a){this.get("active")&&(a.which===1||v)&&this.set("active",false)},handleContextMenu:function(a){this.get("disabled")||this.handleContextMenuInternal(a)},handleContextMenuInternal:function(){},handleFocus:function(){this.get("disabled")||this.handleFocusInternal()},handleFocusInternal:function(){this.focus();this.fire("focus")},handleBlur:function(){this.get("disabled")||this.handleBlurInternal()},
handleBlurInternal:function(){this.blur();this.fire("blur")},handleKeydown:function(a){if(!this.get("disabled")&&this.handleKeyDownInternal(a)){a.halt();return true}},handleKeyDownInternal:function(a){if(a.keyCode===g.KeyCode.ENTER)return this.handleClickInternal(a)},handleClick:function(a){this.get("disabled")||this.handleClickInternal(a)},handleClickInternal:function(){this.get("focusable")&&this.focus()},$:function(a){return this.$el.all(a)},fillChildrenElsBySelectors:function(a){var b=this.$el,
d,c,a=a||this.childrenElSelectors;for(d in a){c=a[d];c=c.call(this,b);typeof c==="string"&&(c=this.$(c));this.setInternal(d,c)}},renderTpl:function(a,b,d){b=b||this.renderData;d=d||this.renderCommands;return(new (this.get("XTemplate"))(a,{control:this,commands:d})).render(b)},getComponentConstructorByNode:function(a,b){var d=b[0].className;if(d){d=d.replace(RegExp("\\b"+a,"ig"),"");return j.getConstructorByXClass(d)}return null},getComponentCssClasses:function(){if(this.componentCssClasses)return this.componentCssClasses;
for(var a=this.constructor,b,d=[];a&&!a.prototype.hasOwnProperty("isControl");){(b=a.xclass)&&d.push(b);a=a.superclass&&a.superclass.constructor}return this.componentCssClasses=d},getBaseCssClasses:function(a){for(var a=r(a),b=this.getComponentCssClasses(),d=0,c="",e=b.length,h=this.get("prefixCls");d<e;d++)c=c+p(h,b[d],a);return w(c)},getBaseCssClass:function(a){return w(p(this.get("prefixCls"),this.getComponentCssClasses()[0],r(a)))},createComponent:function(a,b){return j.createComponent(a,b||this)},
show:function(){this.render();this.set("visible",true);return this},hide:function(){this.set("visible",false);return this},focus:function(){this.get("focusable")&&this.set("focused",true)},blur:function(){this.get("focusable")&&this.set("focused",false)},move:function(a,b){this.set({x:a,y:b})},_onSetWidth:function(a){this.$el.width(a)},_onSetHeight:function(a){this.$el.height(a)},_onSetContent:function(a){var b=this.$el;b.html(a);this.get("allowTextSelection")||b.unselectable()},_onSetVisible:function(a){var b=
this.$el,d=this.getBaseCssClasses("hidden");a?b.removeClass(d):b.addClass(d);this.fire(a?"show":"hide")},_onSetHighlighted:function(a){var b=this.getBaseCssClasses("hover");this.$el[a?"addClass":"removeClass"](b)},_onSetDisabled:function(a){var b=this.getBaseCssClasses("disabled");this.$el[a?"addClass":"removeClass"](b).attr("aria-disabled",a);this.get("focusable")&&this.getKeyEventTarget().attr("tabindex",a?-1:0)},_onSetActive:function(a){var b=this.getBaseCssClasses("active");this.$el[a?"addClass":
"removeClass"](b).attr("aria-pressed",!!a)},_onSetZIndex:function(a){this.$el.css("z-index",a)},_onSetFocused:function(a){var b=this.getKeyEventTarget()[0];if(a)try{b.focus()}catch(d){}else b.ownerDocument.activeElement===b&&b.ownerDocument.body.focus();var b=this.$el,c=this.getBaseCssClasses("focused");b[a?"addClass":"removeClass"](c)},_onSetX:function(a){this.$el.offset({left:a})},_onSetY:function(a){this.$el.offset({top:a})},destructor:function(){j.removeComponent(this);this.$el&&this.$el.remove()}},
{__hooks__:{beforeCreateDom:m("__beforeCreateDom"),createDom:m("__createDom"),decorateDom:m("__decorateDom"),renderUI:m("__renderUI"),bindUI:m("__bindUI"),syncUI:m("__syncUI")},name:"control",ATTRS:{contentTpl:{value:function(a,b){return b.write(a.get("content"))}},content:{parse:function(a){return a.html()},render:1,sync:0,value:""},width:{render:1,sync:0},height:{render:1,sync:0},elCls:{render:1,value:[],setter:function(a){typeof a==="string"&&(a=a.split(/\s+/));return a||[]}},elStyle:{render:1,
value:{}},elAttrs:{render:1,value:{}},x:{},y:{},xy:{setter:function(a){var b=k.makeArray(a);if(b.length){b[0]!==void 0&&this.set("x",b[0]);b[1]!==void 0&&this.set("y",b[1])}return a},getter:function(){return[this.get("x"),this.get("y")]}},zIndex:{render:1,sync:0},visible:{render:1,sync:0,value:true},activeable:{value:true},focused:{},active:{value:false},highlighted:{render:1,sync:0,value:false},disabled:{render:1,sync:0,value:false,parse:function(a){return a.hasClass(this.getBaseCssClass("disabled"))}},
rendered:{value:false},created:{value:false},render:{},id:{render:1,parse:function(a){var b=a.attr("id");if(!b){b=k.guid("ks-component");a.attr("id",b)}return b},valueFn:function(){return k.guid("ks-component")}},elBefore:{},el:{getter:function(){return this.$el}},srcNode:{setter:function(a){return x(a)}},handleGestureEvents:{value:true},focusable:{value:true},allowTextSelection:{value:false},prefixCls:{render:1,value:k.config("component/prefixCls")||"ks-"},prefixXClass:{},parent:{setter:function(a,
b){(b=this.get("parent"))&&this.removeTarget(b);a&&this.addTarget(a)}},XTemplate:{value:z}}});q.extend=function b(c,e,i){var h=k.makeArray(arguments),g;if((h=h[h.length-1])&&(g=h.xclass))h.name=g;h=s.extend.apply(this,arguments);h.extend=b;g&&j.setConstructorByXClass(g,h);return h};return q});
KISSY.add("component/control/render-xtpl",[],function(k,f,r,p){f=function(f,e,n,g){var i=this.utils.callFn,o=this.nativeCommands.each;if("5.0.0"!==k.version)throw Error("current xtemplate file("+this.name+")(v5.0.0) need to be recompiled using current kissy(v"+k.version+")!");e.write('<div id="',0);var j=f.resolve(["id"],0);e.write(j,!0);e.write('"\r\n class="',0);if((i=i(this,f,{escape:1},e,["getBaseCssClasses"],0,2))&&i.isBuffer)e=i,i=g;e.write(i,!0);e.write("\r\n",0);g={escape:1};i=[];j=f.resolve(["elCls"],
0);i.push(j);g.params=i;g.fn=function(e,c){c.write("\r\n ",0);var f=e.resolve(["this"],0);c.write(f,!0);c.write("\r\n",0);return c};e=o.call(this,f,g,e,3,n);e.write('\r\n"\r\n\r\n',0);g={escape:1};i=[];j=f.resolve(["elAttrs"],0);i.push(j);g.params=i;g.fn=function(e,c){c.write("\r\n ",0);var f=e.resolve(["xindex"],0);c.write(f,!0);c.write('="',0);f=e.resolve(["this"],0);c.write(f,!0);c.write('"\r\n',0);return c};e=o.call(this,f,g,e,8,n);e.write('\r\n\r\nstyle="\r\n',0);g={escape:1};i=[];j=f.resolve(["elStyle"],
0);i.push(j);g.params=i;g.fn=function(e,c){c.write("\r\n ",0);var f=e.resolve(["xindex"],0);c.write(f,!0);c.write(":",0);f=e.resolve(["this"],0);c.write(f,!0);c.write(";\r\n",0);return c};e=o.call(this,f,g,e,13,n);e.write('\r\n">',0);return e};f.TPL_NAME=p.name;return f});
