/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: Apr 15 17:41
*/
KISSY.add("component/container",["component/control","component/manager"],function(h,f){function i(a){var b=a.component,c=this.get("children"),a=a.index;c.splice(a,0,b);c=this.get("children");b=c[a];b.setInternal("parent",this);this.get("rendered")&&this.renderChild(a);this.fire("afterAddChild",{component:b,index:a})}function j(a){var b=a.component,c,d,e=a.destroy,g=this.get("children"),a=a.index;-1!==a&&g.splice(a,1);b.setInternal("parent",null);if(e)b.destroy&&b.destroy();else if(b.get&&(d=b.el))(c=
d.parentNode)&&c.removeChild(d);this.fire("afterRemoveChild",{component:b,index:a})}var k=f("component/control"),l=f("component/manager");return k.extend({isContainer:!0,initializer:function(){var a=this.get("prefixCls"),b=this.get("defaultChildCfg");this.publish("beforeAddChild",{defaultFn:i,defaultTargetOnly:!0});this.publish("beforeRemoveChild",{defaultFn:j,defaultTargetOnly:!0});b.prefixCls=b.prefixCls||a},decorateDom:function(){var a=this,b=a.getChildrenContainerEl(),c=a.get("defaultChildCfg"),
d=c.prefixCls,e=c.xclass,g=[];b.children().each(function(b){var f=a.getComponentConstructorByNode(d,b)||e&&l.getConstructorByXClass(e);f&&g.push(new f(h.merge(c,{srcNode:b})))});a.set("children",g)},createDom:function(){this.createChildren()},renderUI:function(){this.renderChildren()},renderChildren:function(){var a,b=this.get("children");for(a=0;a<b.length;a++)this.renderChild(a)},createChildren:function(){var a,b=this.get("children");for(a=0;a<b.length;a++)this.createChild(a)},addChild:function(a,
b){var c=this.get("children");void 0===b&&(b=c.length);this.fire("beforeAddChild",{component:a,index:b});return c[b]},renderChild:function(a){var b=this.get("children");this.createChild(a).render();this.fire("afterRenderChild",{component:b[a],index:a})},createChild:function(a){var b,c,d,e;b=this.get("children")[a];e=this.getChildrenContainerEl();d=e[0];c=d.children[a]||null;b.get("rendered")?(e=b.el,e.parentNode!==d&&d.insertBefore(e,c)):(c?b.set("elBefore",c):b.set("render",e),b.create());this.fire("afterCreateChild",
{component:b,index:a});return b},removeChild:function(a,b){void 0===b&&(b=!0);this.fire("beforeRemoveChild",{component:a,index:h.indexOf(a,this.get("children")),destroy:b})},removeChildren:function(a){var b,c=[].concat(this.get("children"));for(b=0;b<c.length;b++)this.removeChild(c[b],a);return this},getChildAt:function(a){return this.get("children")[a]||null},getChildrenContainerEl:function(){return this.$el},destructor:function(){var a,b=this.get("children");for(a=0;a<b.length;a++)b[a].destroy&&
b[a].destroy()}},{ATTRS:{children:{value:[],getter:function(a){var b=null,c,d;for(c=0;c<a.length;c++)d=a[c],d.isControl||(b=b||this.get("defaultChildCfg"),h.mix(d,b,!1),a[c]=this.createComponent(d));return a},setter:function(a){var b,c;for(b=0;b<a.length;b++)c=a[b],c.isControl&&c.setInternal("parent",this)}},defaultChildCfg:{value:{}}},name:"container"})});
