/*
Copyright 2014, KISSY v1.50
MIT Licensed
build time: Feb 25 19:34
*/
KISSY.add("dd/ddm",["node","base"],function(j,c){function l(k){var a,b;if(k.touches&&1<k.touches.length)p._end();else{if(a=this.__activeToDrag)a._move(k);else if(b=this.get("activeDrag"))b._move(k),this.__needDropCheck&&g(this,k,b);(a=a||b)&&a.get("preventDefaultOnMove")&&k.preventDefault()}}function g(k,a,b){var h=k.get("validDrops"),e=b.get("mode"),c=0,d=0,g=m(b.get("node")),o=f(g);j.each(h,function(k){if(!k.get("disabled")){var h;if(h=k.getNodeFromTarget(a,b.get("dragNode")[0],b.get("node")[0]))if("point"===
e)n(m(h),b.mousePos)&&(h=f(m(h)),c?h<d&&(c=k,d=h):(c=k,d=h));else if("intersect"===e)h=f(r(g,m(h))),h>d&&(d=h,c=k);else if("strict"===e&&(h=f(r(g,m(h))),h===o))return c=k,!1}});if((h=k.get("activeDrop"))&&h!==c)h._handleOut(a),b._handleOut(a);k.setInternal("activeDrop",c);c&&(h!==c?c._handleEnter(a):c._handleOver(a))}function d(k){var a=k.get("activeDrag").get("activeHandler"),b="auto";a&&(b=a.css("cursor"));"auto"===b&&(b=k.get("dragCursor"));k._shim.css({cursor:b,display:"block"});u&&v.call(k)}
function i(a){var b=a.get("drops");a.setInternal("validDrops",[]);b.length&&j.each(b,function(a){a._active()})}function b(a){var b=a.get("drops");a.setInternal("validDrops",[]);b.length&&j.each(b,function(a){a._deActive()})}function m(a){var b=a.offset();return{left:b.left,right:b.left+(a.__ddCachedWidth||a.outerWidth()),top:b.top,bottom:b.top+(a.__ddCachedHeight||a.outerHeight())}}function n(a,b){return a.left<=b.left&&a.right>=b.left&&a.top<=b.top&&a.bottom>=b.top}function f(a){return a.top>=a.bottom||
a.left>=a.right?0:(a.right-a.left)*(a.bottom-a.top)}function r(a,b){var h=Math.max(a.top,b.top),e=Math.min(a.right,b.right),c=Math.min(a.bottom,b.bottom);return{left:Math.max(a.left,b.left),right:e,top:h,bottom:c}}function t(a){a&&(a.__ddCachedWidth=a.outerWidth(),a.__ddCachedHeight=a.outerHeight())}var q=c("node"),a=c("base"),h=j.UA,e=q.all,w=j.Env.host,o=w.document,s=e(o),B=e(w),u=6===h.ie,q=q.Gesture,x=q.move,y=q.end,a=a.extend({__activeToDrag:0,_regDrop:function(a){this.get("drops").push(a)},
_unRegDrop:function(a){var b=this.get("drops"),a=j.indexOf(a,b);-1!==a&&b.splice(a,1)},_regToDrag:function(a){this.__activeToDrag=a;s.on(y,this._end,this);s.on(x,z,this);o.body.setCapture&&o.body.setCapture()},_start:function(){var a=this.__activeToDrag;a&&(this.setInternal("activeDrag",a),this.__activeToDrag=0,a.get("shim")&&A(this),this.__needDropCheck=0,a.get("groups")&&(i(this),this.get("validDrops").length&&(t(a.get("node")),this.__needDropCheck=1)))},_addValidDrop:function(a){this.get("validDrops").push(a)},
_end:function(a){var h=this.__activeToDrag,e=this.get("activeDrag"),c=this.get("activeDrop");a&&(h&&h._move(a),e&&e._move(a));s.detach(x,z,this);s.detach(y,this._end,this);o.body.releaseCapture&&o.body.releaseCapture();h&&(h._end(a),this.__activeToDrag=0);this._shim&&this._shim.hide();e&&(e._end(a),b(this),c&&c._end(a),this.setInternal("activeDrag",null),this.setInternal("activeDrop",null))}},{ATTRS:{dragCursor:{value:"move"},clickPixelThresh:{value:3},bufferTime:{value:1},activeDrag:{},activeDrop:{},
drops:{value:[]},validDrops:{value:[]}}}),z=h.ie?j.throttle(l,30):l,A=function(a){a._shim=e('<div style="background-color:red;position:'+(u?"absolute":"fixed")+";left:0;width:100%;height:100%;top:0;cursor:"+p.get("dragCursor")+';z-index:999999;"></div>').prependTo(o.body||o.documentElement).css("opacity",0);A=d;if(u)B.on("resize scroll",v,a);d(a)},v=j.throttle(function(){var a;(a=this.get("activeDrag"))&&a.get("shim")&&this._shim.css({width:s.width(),height:s.height()})},30),p=new a;p.inRegion=n;
p.region=m;p.area=f;p.cacheWH=t;p.PREFIX_CLS="ks-dd-";return p});
KISSY.add("dd/draggable",["node","./ddm","base"],function(j,c){function l(){return!1}var g=c("node"),d=c("./ddm"),i=c("base"),b=g.all,m=j.each,n=j.UA.ie,f=d.PREFIX_CLS,r=j.Env.host.document,t,q=function(a){var b=a.target;this._checkDragStartValid(a)&&this._checkHandler(b)&&this._prepare(a)};return i.extend({initializer:function(){this.addTarget(d);this._allowMove=this.get("move")},_onSetNode:function(a){this.setInternal("dragNode",a);this.bindDragEvent()},bindDragEvent:function(){this.get("node").on(g.Gesture.start,
q,this).on("dragstart",this._fixDragStart)},detachDragEvent:function(a){a=this;a.get("node").detach(g.Gesture.start,q,a).detach("dragstart",a._fixDragStart)},_bufferTimer:null,_onSetDisabledChange:function(a){this.get("dragNode")[a?"addClass":"removeClass"](f+"-disabled")},_fixDragStart:function(a){a.preventDefault()},_checkHandler:function(a){var b=this,e=b.get("handlers"),c=0;m(e,function(e){if(e[0]===a||e.contains(a))return c=1,b.setInternal("activeHandler",e),!1});return c},_checkDragStartValid:function(a){return this.get("primaryButtonOnly")&&
1!==a.which||this.get("disabled")?0:1},_prepare:function(a){if(a){var b=this;n&&(t=r.body.onselectstart,r.body.onselectstart=l);b.get("halt")&&a.stopPropagation();j.startsWith(a.type.toLowerCase(),"mouse")&&a.preventDefault();var e=a.pageX,c=a.pageY;b.setInternal("startMousePos",b.mousePos={left:e,top:c});if(b._allowMove){var f=b.get("node").offset();b.setInternal("startNodePos",f);b.setInternal("deltaPos",{left:e-f.left,top:c-f.top})}d._regToDrag(b);if(e=b.get("bufferTime"))b._bufferTimer=setTimeout(function(){b._start(a)},
1E3*e)}},_clearBufferTimer:function(){this._bufferTimer&&(clearTimeout(this._bufferTimer),this._bufferTimer=0)},_move:function(a){var b=a.pageX,e=a.pageY;if(!this.get("dragging")){var c=this.get("startMousePos"),n=0,f=this.get("clickPixelThresh");if(Math.abs(b-c.left)>=f||Math.abs(e-c.top)>=f)this._start(a),n=1;if(!n)return}this.mousePos={left:b,top:e};a={drag:this,left:b,top:e,pageX:b,pageY:e,domEvent:a};if(c=this._allowMove)n=this.get("deltaPos"),b-=n.left,e-=n.top,a.left=b,a.top=e,this.setInternal("actualPos",
{left:b,top:e}),this.fire("dragalign",a);e=1;!1===this.fire("drag",a)&&(e=0);e&&c&&this.get("node").offset(this.get("actualPos"))},stopDrag:function(){d._end()},_end:function(a){var a=a||{},b;this._clearBufferTimer();n&&(r.body.onselectstart=t);this.get("dragging")&&(this.get("node").removeClass(f+"drag-over"),(b=d.get("activeDrop"))?this.fire("dragdrophit",{drag:this,drop:b}):this.fire("dragdropmiss",{drag:this}),this.setInternal("dragging",0),this.fire("dragend",{drag:this,pageX:a.pageX,pageY:a.pageY}))},
_handleOut:function(){this.get("node").removeClass(f+"drag-over");this.fire("dragexit",{drag:this,drop:d.get("activeDrop")})},_handleEnter:function(a){this.get("node").addClass(f+"drag-over");this.fire("dragenter",a)},_handleOver:function(a){this.fire("dragover",a)},_start:function(a){this._clearBufferTimer();this.setInternal("dragging",1);this.setInternal("dragStartMousePos",{left:a.pageX,top:a.pageY});d._start();this.fire("dragstart",{drag:this,pageX:a.pageX,pageY:a.pageY})},destructor:function(){this.detachDragEvent();
this.detach()}},{name:"Draggable",ATTRS:{node:{setter:function(a){if(!(a instanceof g))return b(a)}},clickPixelThresh:{valueFn:function(){return d.get("clickPixelThresh")}},bufferTime:{valueFn:function(){return d.get("bufferTime")}},dragNode:{},shim:{value:!1},handlers:{value:[],getter:function(a){var c=this;a.length||(a[0]=c.get("node"));m(a,function(e,n){"function"===typeof e&&(e=e.call(c));"string"===typeof e&&(e=c.get("node").one(e));e.nodeType&&(e=b(e));a[n]=e});c.setInternal("handlers",a);return a}},
activeHandler:{},dragging:{value:!1,setter:function(a){this.get("dragNode")[a?"addClass":"removeClass"](f+"dragging")}},mode:{value:"point"},disabled:{value:!1},move:{value:!1},primaryButtonOnly:{value:!0},halt:{value:!0},groups:{value:!0},startMousePos:{},dragStartMousePos:{},startNodePos:{},deltaPos:{},actualPos:{},preventDefaultOnMove:{value:!0}},inheritedStatics:{DropMode:{POINT:"point",INTERSECT:"intersect",STRICT:"strict"}}})});
KISSY.add("dd/draggable-delegate",["node","./ddm","./draggable"],function(j,c){var l=c("node"),g=c("./ddm"),d=c("./draggable"),i=g.PREFIX_CLS,b=l.all,m=function(c){var f,d;if(this._checkDragStartValid(c)){f=this.get("handlers");var m=b(c.target);(f=f.length?this._getHandler(m):m)&&(d=this._getNode(f));d&&(this.setInternal("activeHandler",f),this.setInternal("node",d),this.setInternal("dragNode",d),this._prepare(c))}};return d.extend({_onSetNode:function(){},_onSetContainer:function(){this.bindDragEvent()},
_onSetDisabledChange:function(b){this.get("container")[b?"addClass":"removeClass"](i+"-disabled")},bindDragEvent:function(){this.get("container").on(l.Gesture.start,m,this).on("dragstart",this._fixDragStart)},detachDragEvent:function(){this.get("container").detach(l.Gesture.start,m,this).detach("dragstart",this._fixDragStart)},_getHandler:function(b){for(var c=this.get("container"),d=this.get("handlers");b&&b[0]!==c[0];){for(var m=0;m<d.length;m++)if(b.test(d[m]))return b;b=b.parent()}return null},
_getNode:function(b){return b.closest(this.get("selector"),this.get("container"))}},{ATTRS:{container:{setter:function(c){return b(c)}},selector:{},handlers:{value:[],getter:0}}})});
KISSY.add("dd/droppable",["node","./ddm","base"],function(j,c){var l=c("node"),g=c("./ddm"),d=c("base"),i=g.PREFIX_CLS;return d.extend({initializer:function(){this.addTarget(g);g._regDrop(this)},getNodeFromTarget:function(b,c,d){var b=this.get("node"),f=b[0];return f===c||f===d?null:b},_active:function(){var b=g.get("activeDrag"),c=this.get("node"),d=this.get("groups"),b=b.get("groups");a:if(!0===b)d=1;else{for(var f in d)if(b[f]){d=1;break a}d=0}d?(g._addValidDrop(this),c&&(c.addClass(i+"drop-active-valid"),
g.cacheWH(c))):c&&c.addClass(i+"drop-active-invalid")},_deActive:function(){var b=this.get("node");b&&b.removeClass(i+"drop-active-valid").removeClass(i+"drop-active-invalid")},__getCustomEvt:function(b){return j.mix({drag:g.get("activeDrag"),drop:this},b)},_handleOut:function(){var b=this.__getCustomEvt();this.get("node").removeClass(i+"drop-over");this.fire("dropexit",b)},_handleEnter:function(b){b=this.__getCustomEvt(b);b.drag._handleEnter(b);this.get("node").addClass(i+"drop-over");this.fire("dropenter",
b)},_handleOver:function(b){b=this.__getCustomEvt(b);b.drag._handleOver(b);this.fire("dropover",b)},_end:function(){var b=this.__getCustomEvt();this.get("node").removeClass(i+"drop-over");this.fire("drophit",b)},destructor:function(){g._unRegDrop(this)}},{name:"Droppable",ATTRS:{node:{setter:function(b){if(b)return l.one(b)}},groups:{value:{}},disabled:{}}})});
KISSY.add("dd/droppable-delegate",["node","./ddm","./droppable"],function(j,c){function l(){var b=this.get("container"),c=[],g=this.get("selector");b.all(g).each(function(b){d.cacheWH(b);c.push(b)});this.__allNodes=c}var g=c("node"),d=c("./ddm"),i=c("./droppable").extend({initializer:function(){d.on("dragstart",l,this)},getNodeFromTarget:function(b,c,g){var f={left:b.pageX,top:b.pageY},b=this.__allNodes,i=0,l=Number.MAX_VALUE;b&&j.each(b,function(b){var a=b[0];a===g||a===c||(a=d.region(b),d.inRegion(a,
f)&&(a=d.area(a),a<l&&(l=a,i=b)))});i&&(this.setInternal("lastNode",this.get("node")),this.setInternal("node",i));return i},_handleOut:function(){this.callSuper();this.setInternal("node",0);this.setInternal("lastNode",0)},_handleOver:function(b){var c=this.get("node"),d=i.superclass._handleOut,f=this.callSuper,g=i.superclass._handleEnter,j=this.get("lastNode");j[0]!==c[0]?(this.setInternal("node",j),d.apply(this,arguments),this.setInternal("node",c),g.call(this,b)):f.call(this,b)},_end:function(b){this.callSuper(b);
this.setInternal("node",0)}},{ATTRS:{lastNode:{},selector:{},container:{setter:function(b){return g.one(b)}}}});return i});KISSY.add("dd",["dd/ddm","dd/draggable","dd/draggable-delegate","dd/droppable-delegate","dd/droppable"],function(j,c){var l=c("dd/ddm"),g=c("dd/draggable"),d=c("dd/draggable-delegate"),i=c("dd/droppable-delegate"),b=c("dd/droppable"),l={Draggable:g,DDM:l,Droppable:b,DroppableDelegate:i,DraggableDelegate:d};return KISSY.DD=l});
