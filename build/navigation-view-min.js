/*
Copyright 2014, KISSY v1.50
MIT Licensed
build time: Jan 8 13:15
*/
KISSY.add("navigation-view/controller",["base","router","promise"],function(c,a){function f(a){var b=this.getSubView(),k=this.get("navigationView");b||(b=new (this.get("SubView")),k.addChild(b),b.get("el").css("transform","translateX(-9999px) translateZ(0)"));b.controller=this;if(k.get("activeView")!==b||this.needNavigation(a))this.reload(),this.go(a);b=a.route;this[this.get("routes")[b.path]].apply(this,arguments)}var h=a("base"),d=a("router"),b=a("promise");return h.extend({router:d,initializer:function(){var a;
this.doRoute=c.bind(f,this);var b=this.get("routes");for(a in b)d.get(a,this.doRoute)},needNavigation:function(){return!0},leave:function(){},getSubView:function(){for(var a=this.get("navigationView"),b=this.get("SubView"),a=a.get("children"),k=a.length-1;0<=k;k--)if(a[k].constructor===b)return a[k]},reload:function(){this.getSubView().reset("title");this.defer=new b.Defer;this.promise=this.defer.promise},push:function(a){d.navigate(a)},go:function(a){this.get("navigationView")[a.backward?"pop":"push"](this.getSubView())},
isSubViewActive:function(){return this.get("navigationView").get("activeView")===this.getSubView()}},{ATTRS:{routes:{},SubView:{}}})});KISSY.add("navigation-view/sub-view",["component/control"],function(c,a){return a("component/control").extend({isActiveView:function(){return this.get("parent").get("activeView")===this},_onSetTitle:function(a){this.isActiveView()&&this.get("parent").get("bar").set("title",a)}},{xclass:"navigation-sub-view",ATTRS:{handleMouseEvents:{value:!1},title:{value:"..."},focusable:{value:!1}}})});
KISSY.add("navigation-view/bar-xtpl",[],function(){return function(c){var a;a=this.config.utils;var f=a.renderOutput,h=a.runInlineCommand,d=a.getPropertyOrRunCommand;a='<div class="';var b={},g=[];g.push("title-wrap");b.params=g;b=h(this,c,b,"getBaseCssClasses",1);a+=f(b,!0);a+='">\r\n    <div class="';b={};g=[];g.push("title");b.params=g;b=h(this,c,b,"getBaseCssClasses",2);a+=f(b,!0);a+='" id="ks-navigation-bar-title-';b=d(this,c,{},"id",0,2);a+=f(b,!0);a+='">';b=d(this,c,{},"title",0,2);a+=f(b,
!0);a+='</div>\r\n</div>\r\n<div class="';b={};g=[];g.push("content");b.params=g;b=h(this,c,b,"getBaseCssClasses",4);a+=f(b,!0);a+='" id="ks-navigation-bar-content-';d=d(this,c,{},"id",0,4);a+=f(d,!0);a+='">\r\n    <div class="';d={};b=[];b.push("center");d.params=b;c=h(this,c,d,"getBaseCssClasses",5);a+=f(c,!0);return a+'"></div>\r\n</div>'}});
KISSY.add("navigation-view/bar-render",["./bar-xtpl","component/control"],function(c,a){var f=a("./bar-xtpl");return a("component/control").getDefaultRender().extend({createDom:function(){this.fillChildrenElsBySelectors({titleEl:"#ks-navigation-bar-title-{id}",contentEl:"#ks-navigation-bar-content-{id}"})},_onSetTitle:function(a){this.control.get("titleEl").html(a)},_onSetBackText:function(a){this.control.get("backButton").set("content",a)}},{ATTRS:{contentTpl:{value:f}}})});
KISSY.add("navigation-view/bar",["component/control","./bar-render","button"],function(c,a){function f(a){var b;b=a.clone(!0);b[0].id=a[0].id+"-proxy";a.parent().append(b);var i=a.offset();b.css("position","absolute");b.offset(i);b.css({width:a.css("width"),height:a.css("height")});return b}function h(a,b,i){a.animate(b,{duration:0.25,useTransition:!0,easing:"ease-in-out",complete:i})}function d(a,b,i,j){var e=a.get("el"),m=a.get("titleEl"),a=Math.min(e[0].offsetWidth/3,200),l=b[0].offsetWidth,b=
e[0].offsetWidth,e=m.offset().left-e.offset().left,m=m[0].offsetWidth,d=i.width,c;j?(i=-d,d=Math.min(e-d,a)):(d=-d,i=Math.min(e,a));a={element:{from:{transform:"translateX("+i+"px) translateZ(0)"},to:{transform:"translateX(0) translateZ(0)",opacity:1}},ghost:{to:{transform:"translateX("+d+"px) translateZ(0)",opacity:0}}};l=-e+l;m>e&&(c=-e-m);j?(d=b-e-m,i=void 0!==c?c:l):(d=void 0!==c?c:l,i=Math.max(0,b-e-m));return{back:a,title:{element:{from:{transform:"translateX("+i+"px) translateZ(0)"},to:{transform:"translateX(0) translateZ(0)",
opacity:1}},ghost:{to:{transform:"translateX("+d+"px) translateZ(0)",opacity:0}}}}}var b=a("component/control"),g=a("./bar-render"),n=a("button");return b.extend({renderUI:function(){var a=this.get("prefixCls");this.set("backBtn",(new n({prefixCls:a+"navigation-bar-back-",elBefore:this.get("contentEl")[0].firstChild,visible:!1,content:this.get("backText")})).render())},forward:function(a){this.go(a,!0)},go:function(a,b,i){var j=this,e=this.get("backBtn").get("el");e.stop(!0);j.ghostBackEl&&j.ghostBackEl.stop(!0);
var c={width:e[0].offsetWidth},l=f(e);j.ghostBackEl=l;e.css("opacity",0);e[b?"show":"hide"]();b=this.get("titleEl");b.stop(!0);j.ghostBackEl&&j.ghostBackEl.stop(!0);var g=f(b.parent());j.ghostTitleEl=g;b.css("opacity",0);this.set("title",a);a=d(j,e,c,i);e.css(a.back.element.from);"none"!==e.css("display")&&h(e,a.back.element.to);b.css(a.title.element.from);h(b,a.title.element.to);"none"!==l.css("display")?h(l,a.back.ghost.to,function(){l.remove();j.ghostBackEl=null}):(l.remove(),j.ghostBackEl=null);
h(g,a.title.ghost.to,function(){g.remove();j.ghostTitleEl=null})},back:function(a,b){this.go(a,b,!0)}},{xclass:"navigation-bar",ATTRS:{handleMouseEvents:{value:!1},focusable:{value:!1},xrender:{value:g},contentEl:{view:1},titleEl:{view:1},title:{value:"",view:1},backText:{value:"Back",view:1}}})});
KISSY.add("navigation-view","node,navigation-view/controller,component/container,navigation-view/sub-view,navigation-view/bar,component/extension/content-xtpl,component/extension/content-render".split(","),function(c,a){var f=a("node").all,h=a("navigation-view/controller"),d=a("component/container"),b=a("navigation-view/sub-view"),g=a("navigation-view/bar"),n=a("component/extension/content-xtpl"),k=a("component/extension/content-render"),o=0,k=d.getDefaultRender().extend([k],{renderUI:function(){var a=
f(c.substitute('<div class="{prefixCls}navigation-view-loading"><div class="{prefixCls}navigation-view-loading-outer"><div class="{prefixCls}navigation-view-loading-inner"></div></div></div>',{prefixCls:this.control.get("prefixCls")}));this.control.get("contentEl").append(a);this.control.setInternal("loadingEl",a)}});return d.extend({renderUI:function(){this.viewStack=[];var a;this.setInternal("bar",a=(new g({elBefore:this.get("el")[0].firstChild})).render());a.get("backBtn").on("click",this.onBack,
this)},onBack:function(){history.back()},push:function(a){var b=this,e=this.get("bar");a.get("el").css("transform","translateX(-9999px) translateZ(0)");a.uuid=o++;var d,c=this.get("loadingEl");this.viewStack.push(a);if(d=this.get("activeView")){var f=d.get("el");c.stop(true);c.css("left","100%");f.stop(true);f.animate({transform:"translateX(-"+f[0].offsetWidth+"px) translateZ(0)"},{useTransition:true,easing:"ease-in-out",duration:0.25});c.show();c.animate({left:"0"},{useTransition:true,easing:"ease-in-out",
duration:0.25});this.set("activeView",null);e.forward(a.get("title"));d.controller.leave()}else e.set("title",a.get("title"));b.waitingView&&b.waitingView.controller.leave();b.waitingView=a;a.controller.promise.then(function(){if(b.waitingView&&b.waitingView.uuid===a.uuid){b.set("activeView",a);b.waitingView=null;e.set("title",a.get("title"));a.get("el").css("transform","");c.hide()}})},pop:function(){var a=this;if(this.viewStack.length>1){this.viewStack.pop();var b=this.viewStack[this.viewStack.length-
1];b.uuid=o++;var d,c=this.get("loadingEl"),f=this.get("bar");if(d=this.get("activeView")){this.animEl=d.get("el");this.animEl.stop(true);this.animEl.animate({transform:"translateX("+d.get("el")[0].offsetWidth+"px) translateZ(0)"},{useTransition:true,easing:"ease-in-out",duration:0.25});this.set("activeView",null);d.controller.leave();c.stop(true);c.css("left","-100%");c.show();c.animate({left:"0"},{useTransition:true,easing:"ease-in-out",duration:0.25})}else a.waitingView&&a.waitingView.controller.leave();
f.back(b.get("title"),this.viewStack.length>1);a.waitingView=b;b.controller.promise.then(function(){if(a.waitingView&&a.waitingView.uuid===b.uuid){a.waitingView=null;a.set("activeView",b);f.set("title",b.get("title"));b.get("el").css("transform","");c.hide()}})}}},{SubView:b,Controller:h,xclass:"navigation-view",ATTRS:{activeView:{},loadingEl:{},handleMouseEvents:{value:false},focusable:{value:false},xrender:{value:k},contentTpl:{value:n},defaultChildCfg:{value:{xclass:"navigation-sub-view"}}}})});
