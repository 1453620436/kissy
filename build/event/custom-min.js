/*
Copyright 2013, KISSY v1.50dev
MIT Licensed
build time: Nov 26 20:52
*/
KISSY.add("event/custom/observer",["event/base"],function(e,g){function a(){a.superclass.constructor.apply(this,arguments)}var i=g("event/base");e.extend(a,i.Observer,{keys:["fn","context","groups"]});return a});KISSY.add("event/custom/object",["event/base"],function(e,g){function a(g){a.superclass.constructor.call(this);e.mix(this,g)}var i=g("event/base");e.extend(a,i.Object);return a});
KISSY.add("event/custom/observable",["event/base","./observer","./object"],function(e,g){function a(){a.superclass.constructor.apply(this,arguments);this.defaultFn=null;this.defaultTargetOnly=!1;this.bubbles=!0}var i=g("event/base"),j=g("./observer"),n=g("./object"),o=i.Utils,k=k;e.extend(a,i.Observable,{on:function(b){b=new j(b);e.Config.debug&&(b.fn||"lack event handler for "+this.type);-1==this.findObserver(b)&&this.observers.push(b)},fire:function(b){var b=b||{},c=this.bubbles,d=this.currentTarget,
f,p=this.type,l=this.defaultFn,m,h=b,a;b.type=p;h instanceof n||(h.target=d,h=new n(h));h.currentTarget=d;b=this.notify(h);!1!==a&&b!=k&&(a=b);if(c&&!h.isPropagationStopped()){f=(c=d.getTargets())&&c.length||0;for(m=0;m<f&&!h.isPropagationStopped();m++)b=c[m].fire(p,h),!1!==a&&b!==k&&(a=b)}if(l&&!h.isDefaultPrevented()&&(p=h.target,b=p.getCustomEventObservable(h.type),!this.defaultTargetOnly&&!b.defaultTargetOnly||d==p))a=l.call(d,h);return a},notify:function(b){var c=[].concat(this.observers),d,
f,a=c.length,l;for(l=0;l<a&&!b.isImmediatePropagationStopped();l++)d=c[l].notify(b,this),!1!==f&&d!==k&&(f=d);return f},detach:function(b){var c,d=b.fn,f=b.context,a=this.currentTarget,k=this.observers,b=b.groups;if(k.length){b&&(c=o.getGroupsRe(b));var m,h,e,g,i=k.length;if(d||c){f=f||a;m=b=0;for(h=[];b<i;++b)if(e=k[b],g=e.context||a,f!=g||d&&d!=e.fn||c&&!e.groups.match(c))h[m++]=e;this.observers=h}else this.reset()}}});return a});
KISSY.add("event/custom/target",["event/base","./observable"],function(e,g){var a=g("event/base"),i=g("./observable"),j=a.Utils,n=j.splitAndRun,o=o;return{isTarget:1,getCustomEventObservable:function(a,b){var c,d=this.getCustomEvents();c=d&&d[a];!c&&b&&(c=d[a]=new i({currentTarget:this,type:a}));return c},fire:function(a,b){var c=this,d=o,f=c.getTargets(),e=f&&f.length,b=b||{};n(a,function(a){var f;j.fillGroupsForEvent(a,b);a=b.type;if((f=c.getCustomEventObservable(a))||e){if(f){if(!f.hasObserver()&&
!f.defaultFn&&(f.bubbles&&!e||!f.bubbles))return}else f=new i({currentTarget:c,type:a});a=f.fire(b);!1!==d&&a!==o&&(d=a)}});return d},publish:function(a,b){var c,d=this;n(a,function(a){c=d.getCustomEventObservable(a,!0);e.mix(c,b)});return d},addTarget:function(a){var b=this.getTargets();e.inArray(a,b)||b.push(a);return this},removeTarget:function(a){var b=this.getTargets(),a=e.indexOf(a,b);-1!=a&&b.splice(a,1);return this},getTargets:function(){return this["__~ks_bubble_targets"]||(this["__~ks_bubble_targets"]=
[])},getCustomEvents:function(){return this["__~ks_custom_events"]||(this["__~ks_custom_events"]={})},on:function(a,b,c){var d=this;j.batchForType(function(a,b,c){b=j.normalizeParam(a,b,c);a=b.type;if(a=d.getCustomEventObservable(a,!0))a.on(b)},0,a,b,c);return d},detach:function(a,b,c){var d=this;j.batchForType(function(a,b,c){var g=j.normalizeParam(a,b,c);(a=g.type)?(a=d.getCustomEventObservable(a,!0))&&a.detach(g):(a=d.getCustomEvents(),e.each(a,function(a){a.detach(g)}))},0,a,b,c);return d}}});
KISSY.add("event/custom",["./custom/target"],function(e,g){var a=g("./custom/target");return{Target:a,global:e.mix({},a)}});
