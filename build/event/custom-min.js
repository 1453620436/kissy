/*
Copyright 2013, KISSY v1.40dev
MIT Licensed
build time: Aug 29 19:57
*/
KISSY.add("event/custom/observer",function(b,m){function g(){g.superclass.constructor.apply(this,arguments)}b.extend(g,m.Observer,{keys:["fn","context","groups"]});return g},{requires:["event/base"]});KISSY.add("event/custom/object",function(b,m){function g(j){g.superclass.constructor.call(this);b.mix(this,j)}b.extend(g,m.Object);return g},{requires:["event/base"]});
KISSY.add("event/custom/observable",function(b,m,g,j){function i(){i.superclass.constructor.apply(this,arguments);this.defaultFn=null;this.defaultTargetOnly=!1;this.bubbles=!0}var n=j.Utils,f=f;b.extend(i,j.Observable,{on:function(a){a=new m(a);-1==this.findObserver(a)&&this.observers.push(a)},fire:function(a){var a=a||{},c=this.bubbles,d=this.currentTarget,e,k=this.type,l=this.defaultFn,o,h=a,b;a.type=k;h instanceof g||(h.target=d,h=new g(h));h.currentTarget=d;a=this.notify(h);!1!==b&&a!=f&&(b=a);
if(c&&!h.isPropagationStopped()){e=(c=d.getTargets(1))&&c.length||0;for(o=0;o<e&&!h.isPropagationStopped();o++)a=c[o].fire(k,h),!1!==b&&a!==f&&(b=a)}if(l&&!h.isDefaultPrevented()&&(k=i.getCustomEventObservable(h.target,h.type),!this.defaultTargetOnly&&!k.defaultTargetOnly||d==h.target))b=l.call(d,h);return b},notify:function(a){var c=[].concat(this.observers),d,e,k=c.length,l;for(l=0;l<k&&!a.isImmediatePropagationStopped();l++)d=c[l].notify(a,this),!1!==e&&d!==f&&(e=d);return e},detach:function(a){var c,
d=a.fn,e=a.context,k=this.currentTarget,l=this.observers,a=a.groups;if(l.length){a&&(c=n.getGroupsRe(a));var f,h,b,g,j=l.length;if(d||c){e=e||k;f=a=0;for(h=[];a<j;++a)if(b=l[a],g=b.context||k,e!=g||d&&d!=b.fn||c&&!b.groups.match(c))h[f++]=b;this.observers=h}else this.reset()}}});i.getCustomEventObservable=function(a,c,d){var e,b=i.getCustomEventObservables(a,d);e=b&&b[c];!e&&d&&(e=b[c]=new i({currentTarget:a,type:c}));return e};i.getCustomEventObservables=function(a,b){!a["__~ks_custom_events"]&&
b&&(a["__~ks_custom_events"]={});return a["__~ks_custom_events"]};return i},{requires:["./observer","./object","event/base"]});
KISSY.add("event/custom/target",function(b,m,g){var j=m.Utils,i=j.splitAndRun,n=n;return{isTarget:1,fire:function(b,a){var c=this,d=n,e=c.getTargets(1),k=e&&e.length,a=a||{};i(b,function(e){var b;j.fillGroupsForEvent(e,a);e=a.type;if((b=g.getCustomEventObservable(c,e))||k){if(b){if(!b.hasObserver()&&!b.defaultFn&&(b.bubbles&&!k||!b.bubbles))return}else b=new g({currentTarget:c,type:e});e=b.fire(a);!1!==d&&e!==n&&(d=e)}});return d},publish:function(f,a){var c,d=this;i(f,function(e){c=g.getCustomEventObservable(d,
e,1);b.mix(c,a)});return d},addTarget:function(f){var a=this.getTargets();b.inArray(f,a)||a.push(f);return this},removeTarget:function(f){var a=this.getTargets(),f=b.indexOf(f,a);-1!=f&&a.splice(f,1);return this},getTargets:function(b){b||(this["__~ks_bubble_targets"]=this["__~ks_bubble_targets"]||[]);return this["__~ks_bubble_targets"]},on:function(b,a,c){var d=this;j.batchForType(function(a,b,c){b=j.normalizeParam(a,b,c);a=b.type;if(a=g.getCustomEventObservable(d,a,1))a.on(b)},0,b,a,c);return d},
detach:function(f,a,c){var d=this;j.batchForType(function(a,c,f){var i=j.normalizeParam(a,c,f);(a=i.type)?(a=g.getCustomEventObservable(d,a,1))&&a.detach(i):(a=g.getCustomEventObservables(d),b.each(a,function(a){a.detach(i)}))},0,f,a,c);return d}}},{requires:["event/base","./observable"]});KISSY.add("event/custom",function(b,m){return{Target:m}},{requires:["./custom/target"]});
