/*
Copyright 2013, KISSY v1.40dev
MIT Licensed
build time: Sep 16 15:16
*/
KISSY.add("event/custom/observer",function(c,l){function g(){g.superclass.constructor.apply(this,arguments)}c.extend(g,l.Observer,{keys:["fn","context","groups"]});return g},{requires:["event/base"]});KISSY.add("event/custom/object",function(c,l){function g(i){g.superclass.constructor.call(this);c.mix(this,i)}c.extend(g,l.Object);return g},{requires:["event/base"]});
KISSY.add("event/custom/observable",function(c,l,g,i){function h(){h.superclass.constructor.apply(this,arguments);this.defaultFn=null;this.defaultTargetOnly=!1;this.bubbles=!0}var n=i.Utils,b=b;c.extend(h,i.Observable,{on:function(a){a=new l(a);c.Config.debug&&(a.fn||"lack event handler for "+this.type);-1==this.findObserver(a)&&this.observers.push(a)},fire:function(a){var a=a||{},f=this.bubbles,d=this.currentTarget,e,m=this.type,k=this.defaultFn,o,j=a,c;a.type=m;j instanceof g||(j.target=d,j=new g(j));
j.currentTarget=d;a=this.notify(j);!1!==c&&a!=b&&(c=a);if(f&&!j.isPropagationStopped()){e=(f=d.getTargets(1))&&f.length||0;for(o=0;o<e&&!j.isPropagationStopped();o++)a=f[o].fire(m,j),!1!==c&&a!==b&&(c=a)}if(k&&!j.isDefaultPrevented()&&(m=h.getCustomEventObservable(j.target,j.type),!this.defaultTargetOnly&&!m.defaultTargetOnly||d==j.target))c=k.call(d,j);return c},notify:function(a){var f=[].concat(this.observers),d,e,m=f.length,k;for(k=0;k<m&&!a.isImmediatePropagationStopped();k++)d=f[k].notify(a,
this),!1!==e&&d!==b&&(e=d);return e},detach:function(a){var f,d=a.fn,e=a.context,m=this.currentTarget,k=this.observers,a=a.groups;if(k.length){a&&(f=n.getGroupsRe(a));var b,c,g,i,h=k.length;if(d||f){e=e||m;b=a=0;for(c=[];a<h;++a)if(g=k[a],i=g.context||m,e!=i||d&&d!=g.fn||f&&!g.groups.match(f))c[b++]=g;this.observers=c}else this.reset()}}});h.getCustomEventObservable=function(a,f,d){var e,b=h.getCustomEventObservables(a,d);e=b&&b[f];!e&&d&&(e=b[f]=new h({currentTarget:a,type:f}));return e};h.getCustomEventObservables=
function(a,b){!a["__~ks_custom_events"]&&b&&(a["__~ks_custom_events"]={});return a["__~ks_custom_events"]};return h},{requires:["./observer","./object","event/base"]});
KISSY.add("event/custom/target",function(c,l,g){var i=l.Utils,h=i.splitAndRun,n=n;return{isTarget:1,fire:function(b,a){var f=this,d=n,e=f.getTargets(1),c=e&&e.length,a=a||{};h(b,function(e){var b;i.fillGroupsForEvent(e,a);e=a.type;if((b=g.getCustomEventObservable(f,e))||c){if(b){if(!b.hasObserver()&&!b.defaultFn&&(b.bubbles&&!c||!b.bubbles))return}else b=new g({currentTarget:f,type:e});e=b.fire(a);!1!==d&&e!==n&&(d=e)}});return d},publish:function(b,a){var f,d=this;h(b,function(e){f=g.getCustomEventObservable(d,
e,1);c.mix(f,a)});return d},addTarget:function(b){var a=this.getTargets();c.inArray(b,a)||a.push(b);return this},removeTarget:function(b){var a=this.getTargets(),b=c.indexOf(b,a);-1!=b&&a.splice(b,1);return this},getTargets:function(b){b||(this["__~ks_bubble_targets"]=this["__~ks_bubble_targets"]||[]);return this["__~ks_bubble_targets"]},on:function(b,a,c){var d=this;i.batchForType(function(a,b,c){b=i.normalizeParam(a,b,c);a=b.type;if(a=g.getCustomEventObservable(d,a,1))a.on(b)},0,b,a,c);return d},
detach:function(b,a,f){var d=this;i.batchForType(function(a,b,f){var h=i.normalizeParam(a,b,f);(a=h.type)?(a=g.getCustomEventObservable(d,a,1))&&a.detach(h):(a=g.getCustomEventObservables(d),c.each(a,function(a){a.detach(h)}))},0,b,a,f);return d}}},{requires:["event/base","./observable"]});KISSY.add("event/custom",function(c,l){return{Target:l}},{requires:["./custom/target"]});
