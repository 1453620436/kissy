/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: May 12 22:30
*/
KISSY.add("event/custom",["./custom/target","util"],function(l,d){var f=d("./custom/target"),h=d("util");return{Target:f,global:h.mix({},f)}});
KISSY.add("event/custom/target",["event/base","./observable","util"],function(l,d){var f=d("event/base"),h=d("./observable"),k=d("util"),i=f.Utils,m=i.splitAndRun;return{isTarget:1,getCustomEventObservable:function(a,b){var c,g=this.getCustomEvents();c=g&&g[a];!c&&b&&(c=g[a]=new h({currentTarget:this,type:a}));return c},fire:function(a,b){var c=this,g,n=c.getTargets(),o=n&&n.length,b=b||{};m(a,function(a){var e;i.fillGroupsForEvent(a,b);a=b.type;if((e=c.getCustomEventObservable(a))||o){if(e){if(!e.hasObserver()&&
!e.defaultFn&&(e.bubbles&&!o||!e.bubbles))return}else e=new h({currentTarget:c,type:a});a=e.fire(b);!1!==g&&void 0!==a&&(g=a)}});return g},publish:function(a,b){var c,g=this;m(a,function(a){c=g.getCustomEventObservable(a,!0);k.mix(c,b)});return g},addTarget:function(a){var b=this.getTargets();k.inArray(a,b)||b.push(a);return this},removeTarget:function(a){var b=this.getTargets(),a=k.indexOf(a,b);-1!==a&&b.splice(a,1);return this},getTargets:function(){return this["__~ks_bubble_targets"]||(this["__~ks_bubble_targets"]=
[])},getCustomEvents:function(){return this["__~ks_custom_events"]||(this["__~ks_custom_events"]={})},on:function(a,b,c){var g=this;i.batchForType(function(a,b,c){b=i.normalizeParam(a,b,c);a=b.type;if(a=g.getCustomEventObservable(a,!0))a.on(b)},0,a,b,c);return g},detach:function(a,b,c){var g=this;i.batchForType(function(a,b,c){var e=i.normalizeParam(a,b,c);(a=e.type)?(a=g.getCustomEventObservable(a,!0))&&a.detach(e):(a=g.getCustomEvents(),k.each(a,function(a){a.detach(e)}))},0,a,b,c);return g}}});
KISSY.add("event/custom/observable",["event/base","./observer","./object","util"],function(l,d){function f(){f.superclass.constructor.apply(this,arguments);this.defaultFn=null;this.defaultTargetOnly=!1;this.bubbles=!0}var h=d("event/base"),k=d("./observer"),i=d("./object"),m=h.Utils;d("util").extend(f,h.Observable,{on:function(a){a=new k(a);-1===this.findObserver(a)&&this.observers.push(a)},fire:function(a){var a=a||{},b=this.bubbles,c=this.currentTarget,g,d=this.type,f=this.defaultFn,h,e=a,j;a.type=
d;e instanceof i||(e.target=c,e=new i(e));e.currentTarget=c;a=this.notify(e);!1!==j&&void 0!==a&&(j=a);if(b&&!e.isPropagationStopped()){g=(b=c.getTargets())&&b.length||0;for(h=0;h<g&&!e.isPropagationStopped();h++)a=b[h].fire(d,e),!1!==j&&void 0!==a&&(j=a)}if(f&&!e.isDefaultPrevented()&&(d=e.target,a=d.getCustomEventObservable(e.type),!this.defaultTargetOnly&&(!a||!a.defaultTargetOnly)||c===d))j=f.call(c,e);return j},notify:function(a){var b=[].concat(this.observers),c,g,d=b.length,f;for(f=0;f<d&&
!a.isImmediatePropagationStopped();f++)c=b[f].notify(a,this),!1!==g&&void 0!==c&&(g=c);return g},detach:function(a){var b,c=a.fn,g=a.context,d=this.currentTarget,f=this.observers,a=a.groups;if(f.length){a&&(b=m.getGroupsRe(a));var h,e,j,i,k=f.length;if(c||b){g=g||d;h=a=0;for(e=[];a<k;++a)if(j=f[a],i=j.context||d,g!==i||c&&c!==j.fn||b&&!j.groups.match(b))e[h++]=j;this.observers=e}else this.reset()}}});return f});
KISSY.add("event/custom/observer",["event/base","util"],function(l,d){function f(){f.superclass.constructor.apply(this,arguments)}var h=d("event/base");d("util").extend(f,h.Observer,{keys:["fn","context","groups"]});return f});KISSY.add("event/custom/object",["event/base","util"],function(l,d){function f(d){f.superclass.constructor.call(this);k.mix(this,d)}var h=d("event/base"),k=d("util");k.extend(f,h.Object);return f});
