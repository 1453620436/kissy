/*
Copyright 2013, KISSY v1.40dev
MIT Licensed
build time: Sep 11 14:23
*/
KISSY.add("event/dom/base/utils",function(d,h){var a="ksEventTargetId_"+d.now(),b=d.Env.host.document;return{simpleAdd:b&&b.addEventListener?function(a,b,d,h){a.addEventListener&&a.addEventListener(b,d,!!h)}:function(a,b,d){a.attachEvent&&a.attachEvent("on"+b,d)},simpleRemove:b&&b.removeEventListener?function(a,b,d,h){a.removeEventListener&&a.removeEventListener(b,d,!!h)}:function(a,b,d){a.detachEvent&&a.detachEvent("on"+b,d)},data:function(b,d){return h.data(b,a,d)},removeData:function(b){return h.removeData(b,
a)}}},{requires:["dom"]});KISSY.add("event/dom/base/special",function(){return{}});
KISSY.add("event/dom/base/observer",function(d,h,a){function b(a){b.superclass.constructor.apply(this,arguments)}d.extend(b,a.Observer,{keys:"fn,filter,data,context,originalType,groups,last".split(","),notifyInternal:function(a,b){var d,m,p=a.type,k;(k=this.originalType)?a.type=k:k=p;(d=h[k])&&d.handle?(d=d.handle(a,this,b))&&0<d.length&&(m=d[0]):m=this.simpleNotify(a,b);!1===m&&a.halt();a.type=p;return m}});return b},{requires:["./special","event/base"]});
KISSY.add("event/dom/base/object",function(d,h,a){function b(){return m}function i(){return p}function l(c){var r=c.type;l.superclass.constructor.call(this);this.originalEvent=c;var e=i;"defaultPrevented"in c?e=c.defaultPrevented?b:i:"getPreventDefault"in c?e=c.getPreventDefault()?b:i:"returnValue"in c&&(e=c.returnValue===p?b:i);this.isDefaultPrevented=e;var g=[],j,f=k.concat();d.each(n,function(e){r.match(e.reg)&&(f=f.concat(e.props),e.fix&&g.push(e.fix));return a});for(e=f.length;e;)j=f[--e],this[j]=
c[j];this.target||(this.target=c.srcElement||s);3===this.target.nodeType&&(this.target=this.target.parentNode);for(e=g.length;e;)j=g[--e],j(this,c)}var s=d.Env.host.document,m=!0,p=!1,k="altKey,bubbles,cancelable,ctrlKey,currentTarget,eventPhase,metaKey,shiftKey,target,timeStamp,view,type".split(","),n=[{reg:/^key/,props:["char","charCode","key","keyCode","which"],fix:function(c,k){null==c.which&&(c.which=null!=k.charCode?k.charCode:k.keyCode);c.metaKey===a&&(c.metaKey=c.ctrlKey)}},{reg:/^touch/,
props:["touches","changedTouches","targetTouches"]},{reg:/^gesturechange$/i,props:["rotation","scale"]},{reg:/^(mousewheel|DOMMouseScroll)$/,props:[],fix:function(c,k){var e,g,j,f=k.wheelDelta,b=k.axis,d=k.wheelDeltaY,n=k.wheelDeltaX,o=k.detail;f&&(j=f/120);o&&(j=-(0==o%3?o/3:o));b!==a&&(b===c.HORIZONTAL_AXIS?(g=0,e=-1*j):b===c.VERTICAL_AXIS&&(e=0,g=j));d!==a&&(g=d/120);n!==a&&(e=-1*n/120);!e&&!g&&(g=j);e!==a&&(c.deltaX=e);g!==a&&(c.deltaY=g);j!==a&&(c.delta=j)}},{reg:/^mouse|contextmenu|click|mspointer|(^DOMMouseScroll$)/i,
props:"buttons,clientX,clientY,button,offsetX,relatedTarget,which,fromElement,toElement,offsetY,pageX,pageY,screenX,screenY".split(","),fix:function(c,k){var e,g,b=c.target,f=k.button;null==c.pageX&&null!=k.clientX&&(e=b.ownerDocument||s,g=e.documentElement,e=e.body,c.pageX=k.clientX+(g&&g.scrollLeft||e&&e.scrollLeft||0)-(g&&g.clientLeft||e&&e.clientLeft||0),c.pageY=k.clientY+(g&&g.scrollTop||e&&e.scrollTop||0)-(g&&g.clientTop||e&&e.clientTop||0));!c.which&&f!==a&&(c.which=f&1?1:f&2?3:f&4?2:0);!c.relatedTarget&&
c.fromElement&&(c.relatedTarget=c.fromElement===b?c.toElement:c.fromElement);return c}}];d.extend(l,h.Object,{constructor:l,preventDefault:function(){var a=this.originalEvent;a.preventDefault?a.preventDefault():a.returnValue=p;l.superclass.preventDefault.call(this)},stopPropagation:function(){var a=this.originalEvent;a.stopPropagation?a.stopPropagation():a.cancelBubble=m;l.superclass.stopPropagation.call(this)}});return l},{requires:["event/base"]});
KISSY.add("event/dom/base/observable",function(d,h,a,b,i,l,s){function m(a){d.mix(this,a);this.reset()}var p=s.Utils;d.extend(m,s.Observable,{setup:function(){var k=this.type,d=a[k]||{},c=this.currentTarget,r=b.data(c).handle;(!d.setup||!1===d.setup.call(c,k))&&b.simpleAdd(c,k,r)},constructor:m,reset:function(){m.superclass.reset.call(this);this.lastCount=this.delegateCount=0},notify:function(a){var b=a.target,c=a.type,d=this.currentTarget,e=this.observers,g=[],j,f,t=this.delegateCount||0,q,u;if(t&&
b.nodeType)for(;b!=d;){if(!0!==b.disabled||"click"!==c){var o={},v,l,i;q=[];for(f=0;f<t;f++)u=e[f],i=u.filter,l=i+"",v=o[l],void 0===v&&(v=o[l]=h.test(b,i)),v&&q.push(u);q.length&&g.push({currentTarget:b,currentTargetObservers:q})}b=b.parentNode||d}t<e.length&&g.push({currentTarget:d,currentTargetObservers:e.slice(t)});f=0;for(b=g.length;!a.isPropagationStopped()&&f<b;++f){c=g[f];q=c.currentTargetObservers;c=c.currentTarget;a.currentTarget=c;for(c=0;!a.isImmediatePropagationStopped()&&c<q.length;c++)d=
q[c],d=d.notify(a,this),!1!==j&&void 0!==d&&(j=d)}return j},fire:function(b,n){var b=b||{},c=""+this.type,i,e,g=a[c]||{};i=!1!==g.bubbles;var j=this.currentTarget;if(!(g.fire&&!1===g.fire.call(j,n))&&(b instanceof l||(e=b,b=new l({currentTarget:j,type:c,target:j}),d.mix(b,e)),!(g.preFire&&!1===g.preFire.call(j,b,n)))){e=j;var f=h.getWindow(e),t=f.document,g=[],q,u="on"+c,o=0;do g.push(e),e=e.parentNode||e.ownerDocument||e===t&&f;while(!n&&e&&i);e=g[o];do{b.currentTarget=e;if(i=m.getDomEventObservable(e,
c))i=i.notify(b),void 0!==i&&!1!==q&&(q=i);e[u]&&!1===e[u].call(e)&&b.preventDefault();e=g[++o]}while(!n&&e&&!b.isPropagationStopped());if(!n&&!b.isDefaultPrevented()){try{j[c]&&!d.isWindow(j)&&(m.triggeredEvent=c,j[c]())}catch(v){logger.debug("trigger action error: "+v)}m.triggeredEvent=""}return q}},on:function(b){var n=this.observers,c=a[this.type]||{},b=b instanceof i?b:new i(b);d.Config.debug&&(b.fn||"lack event handler for "+this.type);-1==this.findObserver(b)&&(b.filter?(n.splice(this.delegateCount,
0,b),this.delegateCount++):b.last?(n.push(b),this.lastCount++):n.splice(n.length-this.lastCount,0,b),c.add&&c.add.call(this.currentTarget,b))},detach:function(b){var d,c=a[this.type]||{},i="filter"in b,e=b.filter,g=b.context,j=b.fn,f=this.currentTarget,t=this.observers,b=b.groups;if(t.length){b&&(d=p.getGroupsRe(b));var q,u,o,h,l=t.length;if(j||i||d){g=g||f;q=b=0;for(u=[];b<l;++b)o=t[b],h=o.context||f,g!=h||j&&j!=o.fn||i&&(e&&e!=o.filter||!e&&!o.filter)||d&&!o.groups.match(d)?u[q++]=o:(o.filter&&
this.delegateCount&&this.delegateCount--,o.last&&this.lastCount&&this.lastCount--,c.remove&&c.remove.call(f,o));this.observers=u}else this.reset();this.checkMemory()}},checkMemory:function(){var i=this.type,h,c,l=a[i]||{},e=this.currentTarget,g=b.data(e);if(g&&(h=g.observables,this.hasObserver()||(c=g.handle,(!l.tearDown||!1===l.tearDown.call(e,i))&&b.simpleRemove(e,i,c),delete h[i]),d.isEmptyObject(h)))g.handle=null,b.removeData(e)}});m.triggeredEvent="";m.getDomEventObservable=function(a,d){var c=
b.data(a),i;c&&(i=c.observables);return i?i[d]:null};m.getDomEventObservablesHolder=function(a,d){var c=b.data(a);!c&&d&&b.data(a,c={});return c};return m},{requires:"dom,./special,./utils,./observer,./object,event/base".split(",")});
KISSY.add("event/dom/base/dom-event",function(d,h,a,b,i,l,s){function m(a,b){var c=i[b]||{},f;if(!a.originalType&&(f=c.typeFix))a.originalType=b,b=f;return b}function p(a,b,j){var f,i,h,j=d.merge(j),b=m(j,b);f=l.getDomEventObservablesHolder(a,1);if(!(h=f.handle))h=f.handle=function(a){var b=a.type,e=h.currentTarget;return l.triggeredEvent==b||"undefined"==typeof KISSY?c:(b=l.getDomEventObservable(e,b))?(a.currentTarget=e,a=new s(a),b.notify(a)):c},h.currentTarget=a;if(!(i=f.observables))i=f.observables=
{};f=i[b];f||(f=i[b]=new l({type:b,currentTarget:a}),f.setup());f.on(j);a=null}function k(a,b,c){var c=d.merge(c),b=m(c,b),a=l.getDomEventObservablesHolder(a),f=(a||{}).observables;if(a&&f)if(b)(b=f[b])&&b.detach(c);else for(b in f)f[b].detach(c)}var n=h.Utils,c=c,r={};d.mix(r,{on:function(a,c,d,f){a=b.query(a);n.batchForType(function(a,b,c,e){for(var c=n.normalizeParam(b,c,e),f,b=c.type,e=a.length-1;0<=e;e--)f=a[e],p(f,b,c)},1,a,c,d,f);return a},detach:function(a,c,d,f){a=b.query(a);n.batchForType(function(a,
b,c,e){for(var c=n.normalizeParam(b,c,e),f,d,b=c.type,e=a.length-1;0<=e;e--)if(f=a[e],k(f,b,c),c.deep&&f.getElementsByTagName){d=f.getElementsByTagName("*");for(f=d.length-1;0<=f;f--)k(d[f],b,c)}},1,a,c,d,f);return a},delegate:function(a,b,c,f,d){return r.on(a,b,{fn:f,context:d,filter:c})},undelegate:function(a,b,c,f,d){return r.detach(a,b,{fn:f,context:d,filter:c})},fire:function(a,d,j,f){var h=c,j=j||{};j.synthetic=1;n.splitAndRun(d,function(d){var g,k,m;n.fillGroupsForEvent(d,j);d=j.type;if((k=
i[d])&&k.typeFix)d=k.typeFix;a=b.query(a);for(k=a.length-1;0<=k;k--)g=a[k],m=l.getDomEventObservable(g,d),!f&&!m&&(m=new l({type:d,currentTarget:g})),m&&(g=m.fire(j,f),!1!==h&&g!==c&&(h=g))});return h},fireHandler:function(a,b,c){return r.fire(a,b,c,1)},clone:function(b,c){var i;if(i=l.getDomEventObservablesHolder(b)){var f=a.data(b);f&&f===a.data(c)&&a.removeData(c);d.each(i.observables,function(a,b){d.each(a.observers,function(a){p(c,b,a)})})}}});return r},{requires:"event/base,./utils,dom,./special,./observable,./object".split(",")});
KISSY.add("event/dom/base/key-codes",function(d){var h=d.UA,a={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,
Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,
WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(b){if(b.altKey&&!b.ctrlKey||b.metaKey||b.keyCode>=a.F1&&b.keyCode<=a.F12)return!1;switch(b.keyCode){case a.ALT:case a.CAPS_LOCK:case a.CONTEXT_MENU:case a.CTRL:case a.DOWN:case a.END:case a.ESC:case a.HOME:case a.INSERT:case a.LEFT:case a.MAC_FF_META:case a.META:case a.NUMLOCK:case a.NUM_CENTER:case a.PAGE_DOWN:case a.PAGE_UP:case a.PAUSE:case a.PRINT_SCREEN:case a.RIGHT:case a.SHIFT:case a.UP:case a.WIN_KEY:case a.WIN_KEY_RIGHT:return!1;
default:return!0}},isCharacterKey:function(b){if(b>=a.ZERO&&b<=a.NINE||b>=a.NUM_ZERO&&b<=a.NUM_MULTIPLY||b>=a.A&&b<=a.Z||h.webkit&&0==b)return!0;switch(b){case a.SPACE:case a.QUESTION_MARK:case a.NUM_PLUS:case a.NUM_MINUS:case a.NUM_PERIOD:case a.NUM_DIVISION:case a.SEMICOLON:case a.DASH:case a.EQUALS:case a.COMMA:case a.PERIOD:case a.SLASH:case a.APOSTROPHE:case a.SINGLE_QUOTE:case a.OPEN_SQUARE_BRACKET:case a.BACKSLASH:case a.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}};return a});
KISSY.add("event/dom/base/gesture",function(){return{start:"mousedown",move:"mousemove",end:"mouseup",tap:"click",singleTap:"click",doubleTap:"dblclick"}});
KISSY.add("event/dom/base/special-events",function(d,h,a){var b=b;return d.mix(a,{mousewheel:{typeFix:d.UA.gecko?"DOMMouseScroll":"mousewheel"},load:{bubbles:!1},click:{fire:function(a){return!a&&"checkbox"===""+this.type&&this.click&&"input"==this.nodeName.toLowerCase()?(this.click(),!1):b}},focus:{bubbles:!1,preFire:function(a,b){if(!b)return h.fire(this,"focusin")},fire:function(a){return!a&&this.ownerDocument&&this!==this.ownerDocument.activeElement&&this.focus?(this.focus(),!1):b}},blur:{bubbles:!1,
preFire:function(a,b){if(!b)return h.fire(this,"focusout")},fire:function(a){return!a&&this.ownerDocument&&this===this.ownerDocument.activeElement&&this.blur?(this.blur(),!1):b}}})},{requires:["./dom-event","./special"]});
KISSY.add("event/dom/base/mouseenter",function(d,h,a){d.each([{name:"mouseenter",fix:"mouseover"},{name:"mouseleave",fix:"mouseout"}],function(b){a[b.name]={typeFix:b.fix,handle:function(a,b,d){var m=a.currentTarget,p=a.relatedTarget;if(!p||p!==m&&!h.contains(m,p))return[b.simpleNotify(a,d)]}}})},{requires:["dom","./special"]});
KISSY.add("event/dom/base/valuechange",function(d,h,a,b){function i(b){if(a.hasData(b,g)){var c=a.data(b,g);clearTimeout(c);a.removeData(b,g)}}function l(a){i(a.target)}function s(b){var d=b.value,g=a.data(b,e);d!==g&&(h.fireHandler(b,c,{prevVal:g,newVal:d}),a.data(b,e,d))}function m(b){a.hasData(b,g)||a.data(b,g,setTimeout(function(){s(b);a.data(b,g,setTimeout(arguments.callee,j))},j))}function p(b){var c=b.target;"focus"==b.type&&a.data(c,e,c.value);m(c)}function k(a){s(a.target)}function n(b){a.removeData(b,
e);i(b);h.detach(b,"blur",l);h.detach(b,"webkitspeechchange",k);h.detach(b,"mousedown keyup keydown focus",p)}var c="valuechange",r=a.nodeName,e="event/valuechange/history",g="event/valuechange/poll",j=50;b[c]={setup:function(){var a=r(this);if("input"==a||"textarea"==a)n(this),h.on(this,"blur",l),h.on(this,"webkitspeechchange",k),h.on(this,"mousedown keyup keydown focus",p)},tearDown:function(){n(this)}};return h},{requires:["./dom-event","dom","./special"]});
KISSY.add("event/dom/base",function(d,h,a,b,i,l){return d.merge({add:h.on,remove:h.detach,KeyCode:b,Gesture:i,Special:l,Object:a},h)},{requires:"./base/dom-event,./base/object,./base/key-codes,./base/gesture,./base/special-events,./base/mouseenter,./base/valuechange".split(",")});
