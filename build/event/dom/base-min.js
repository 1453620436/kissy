/*
Copyright 2013, KISSY v1.50dev
MIT Licensed
build time: Nov 26 20:52
*/
KISSY.add("event/dom/base/utils",["dom"],function(j,b){var a=b("dom"),c="ksEventTargetId_"+j.now(),f=j.Env.host.document;return{simpleAdd:f&&f.addEventListener?function(a,b,c,f){a.addEventListener&&a.addEventListener(b,c,!!f)}:function(a,b,c){a.attachEvent&&a.attachEvent("on"+b,c)},simpleRemove:f&&f.removeEventListener?function(a,b,c,f){a.removeEventListener&&a.removeEventListener(b,c,!!f)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)},data:function(b,f){return a.data(b,c,f)},removeData:function(b){return a.removeData(b,
c)}}});KISSY.add("event/dom/base/special",[],function(){return{}});
KISSY.add("event/dom/base/observer",["event/base","./special"],function(j,b){function a(b){a.superclass.constructor.apply(this,arguments)}var c=b("event/base"),f=b("./special");j.extend(a,c.Observer,{keys:"fn,filter,data,context,originalType,groups,last".split(","),notifyInternal:function(a,b){var c,j,k=a.type,i;(i=this.originalType)?a.type=i:i=k;(c=f[i])&&c.handle?(c=c.handle(a,this,b))&&0<c.length&&(j=c[0]):j=this.simpleNotify(a,b);!1===j&&a.halt();a.type=k;return j}});return a});
KISSY.add("event/dom/base/object",["event/base"],function(j,b){function a(){return s}function c(){return q}function f(n){var t=n.type;f.superclass.constructor.call(this);this.originalEvent=n;var d=c;"defaultPrevented"in n?d=n.defaultPrevented?a:c:"getPreventDefault"in n?d=n.getPreventDefault()?a:c:"returnValue"in n&&(d=n.returnValue===q?a:c);this.isDefaultPrevented=d;var e=[],h,l=k.concat();j.each(i,function(a){t.match(a.reg)&&(l=l.concat(a.props),a.fix&&e.push(a.fix))});for(d=l.length;d;)h=l[--d],
this[h]=n[h];this.target||(this.target=n.srcElement||m);3===this.target.nodeType&&(this.target=this.target.parentNode);for(d=e.length;d;)h=e[--d],h(this,n)}var r=b("event/base"),m=j.Env.host.document,s=!0,q=!1,k="altKey,bubbles,cancelable,ctrlKey,currentTarget,eventPhase,metaKey,shiftKey,target,timeStamp,view,type".split(","),i=[{reg:/^key/,props:["char","charCode","key","keyCode","which"],fix:function(a,i){null==a.which&&(a.which=null!=i.charCode?i.charCode:i.keyCode);void 0===a.metaKey&&(a.metaKey=
a.ctrlKey)}},{reg:/^touch/,props:["touches","changedTouches","targetTouches"]},{reg:/^gesturechange$/i,props:["rotation","scale"]},{reg:/^(mousewheel|DOMMouseScroll)$/,props:[],fix:function(a,i){var d,e,h,l=i.wheelDelta,g=i.axis,b=i.wheelDeltaY,c=i.wheelDeltaX,f=i.detail;l&&(h=l/120);f&&(h=-(0==f%3?f/3:f));void 0!==g&&(g===a.HORIZONTAL_AXIS?(e=0,d=-1*h):g===a.VERTICAL_AXIS&&(d=0,e=h));void 0!==b&&(e=b/120);void 0!==c&&(d=-1*c/120);!d&&!e&&(e=h);void 0!==d&&(a.deltaX=d);void 0!==e&&(a.deltaY=e);void 0!==
h&&(a.delta=h)}},{reg:/^mouse|contextmenu|click|mspointer|(^DOMMouseScroll$)/i,props:"buttons,clientX,clientY,button,offsetX,relatedTarget,which,fromElement,toElement,offsetY,pageX,pageY,screenX,screenY".split(","),fix:function(a,i){var d,e,h=a.target,l=i.button;null==a.pageX&&null!=i.clientX&&(d=h.ownerDocument||m,e=d.documentElement,d=d.body,a.pageX=i.clientX+(e&&e.scrollLeft||d&&d.scrollLeft||0)-(e&&e.clientLeft||d&&d.clientLeft||0),a.pageY=i.clientY+(e&&e.scrollTop||d&&d.scrollTop||0)-(e&&e.clientTop||
d&&d.clientTop||0));!a.which&&void 0!==l&&(a.which=l&1?1:l&2?3:l&4?2:0);!a.relatedTarget&&a.fromElement&&(a.relatedTarget=a.fromElement===h?a.toElement:a.fromElement);return a}}];j.extend(f,r.Object,{constructor:f,preventDefault:function(){var a=this.originalEvent;a.preventDefault?a.preventDefault():a.returnValue=q;f.superclass.preventDefault.call(this)},stopPropagation:function(){var a=this.originalEvent;a.stopPropagation?a.stopPropagation():a.cancelBubble=s;f.superclass.stopPropagation.call(this)}});
return f});
KISSY.add("event/dom/base/observable","event/base,dom,./special,./utils,./observer,./object".split(","),function(j,b){function a(a){j.mix(this,a);this.reset()}var c=b("event/base"),f=b("dom"),r=b("./special"),m=b("./utils"),s=b("./observer"),q=b("./object"),k=c.Utils;j.extend(a,c.Observable,{setup:function(){var a=this.type,b=r[a]||{},c=this.currentTarget,d=m.data(c).handle;(!b.setup||b.setup.call(c,a)===false)&&m.simpleAdd(c,a,d)},constructor:a,reset:function(){a.superclass.reset.call(this);this.lastCount=
this.delegateCount=0},notify:function(a){var b=a.target,c=a.type,d=this.currentTarget,e=this.observers,h=[],l,g,v=this.delegateCount||0,o,u;if(v&&b.nodeType)for(;b!=d;){if(b.disabled!==true||c!=="click"){var p={},j,k,m;o=[];for(g=0;g<v;g++){u=e[g];m=u.filter;k=m+"";j=p[k];j===void 0&&(j=p[k]=f.test(b,m));j&&o.push(u)}o.length&&h.push({currentTarget:b,currentTargetObservers:o})}b=b.parentNode||d}v<e.length&&h.push({currentTarget:d,currentTargetObservers:e.slice(v)});g=0;for(b=h.length;!a.isPropagationStopped()&&
g<b;++g){c=h[g];o=c.currentTargetObservers;c=c.currentTarget;a.currentTarget=c;for(c=0;!a.isImmediatePropagationStopped()&&c<o.length;c++){d=o[c];d=d.notify(a,this);l!==false&&d!==void 0&&(l=d)}}return l},fire:function(i,b){var i=i||{},c=""+this.type,d,e,h=r[c]||{};d=h.bubbles!==false;var l=this.currentTarget;if(!(h.fire&&h.fire.call(l,b)===false)){if(!(i instanceof q)){e=i;i=new q({currentTarget:l,type:c,target:l});j.mix(i,e)}if(!(h.preFire&&h.preFire.call(l,i,b)===false)){e=l;var g=f.getWindow(e),
v=g.document,h=[],o,u="on"+c,p=0;do{h.push(e);e=e.parentNode||e.ownerDocument||e===v&&g}while(!b&&e&&d);e=h[p];do{i.currentTarget=e;if(d=a.getDomEventObservable(e,c)){d=d.notify(i);d!==void 0&&o!==false&&(o=d)}e[u]&&e[u].call(e)===false&&i.preventDefault();e=h[++p]}while(!b&&e&&!i.isPropagationStopped());if(!b&&!i.isDefaultPrevented()){try{if(l[c]&&!j.isWindow(l)){a.triggeredEvent=c;l[c]()}}catch(k){"trigger action error: "+k}a.triggeredEvent=""}return o}}},on:function(a){var c=this.observers,b=r[this.type]||
{},a=a instanceof s?a:new s(a);j.Config.debug&&(a.fn||"lack event handler for "+this.type);if(this.findObserver(a)==-1){if(a.filter){c.splice(this.delegateCount,0,a);this.delegateCount++}else if(a.last){c.push(a);this.lastCount++}else c.splice(c.length-this.lastCount,0,a);b.add&&b.add.call(this.currentTarget,a)}},detach:function(a){var c,b=r[this.type]||{},d="filter"in a,e=a.filter,h=a.context,l=a.fn,g=this.currentTarget,f=this.observers,a=a.groups;if(f.length){a&&(c=k.getGroupsRe(a));var j,u,p,m,
q=f.length;if(l||d||c){h=h||g;j=a=0;for(u=[];a<q;++a){p=f[a];m=p.context||g;if(h!=m||l&&l!=p.fn||d&&(e&&e!=p.filter||!e&&!p.filter)||c&&!p.groups.match(c))u[j++]=p;else{p.filter&&this.delegateCount&&this.delegateCount--;p.last&&this.lastCount&&this.lastCount--;b.remove&&b.remove.call(g,p)}}this.observers=u}else this.reset();this.checkMemory()}},checkMemory:function(){var a=this.type,c,b,d=r[a]||{},e=this.currentTarget,h=m.data(e);if(h){c=h.observables;if(!this.hasObserver()){b=h.handle;(!d.tearDown||
d.tearDown.call(e,a)===false)&&m.simpleRemove(e,a,b);delete c[a]}if(j.isEmptyObject(c)){h.handle=null;m.removeData(e)}}}});a.triggeredEvent="";a.getDomEventObservable=function(a,c){var b=m.data(a),d;if(b)d=b.observables;return d?d[c]:null};a.getDomEventObservablesHolder=function(a,c){var b=m.data(a);!b&&c&&m.data(a,b={});return b};return a});
KISSY.add("event/dom/base/dom-event","event/base,./utils,dom,./special,./observable,./object".split(","),function(j,b){function a(a,c){var b=q[c]||{},g;if(!a.originalType&&(g=b.typeFix)){a.originalType=c;c=g}return c}function c(c,b,d){var g,f,o,d=j.merge(d),b=a(d,b);g=k.getDomEventObservablesHolder(c,1);if(!(o=g.handle)){o=g.handle=function(a){var c=a.type,b=o.currentTarget;if(k.triggeredEvent==c||typeof KISSY=="undefined")return t;if(c=k.getDomEventObservable(b,c)){a.currentTarget=b;a=new i(a);return c.notify(a)}return t};
o.currentTarget=c}if(!(f=g.observables))f=g.observables={};g=f[b];if(!g){g=f[b]=new k({type:b,currentTarget:c});g.setup()}g.on(d);c=null}function f(c,b,d){var d=j.merge(d),b=a(d,b),c=k.getDomEventObservablesHolder(c),g=(c||{}).observables;if(c&&g)if(b)(b=g[b])&&b.detach(d);else for(b in g)g[b].detach(d)}var r=b("event/base"),m=b("./utils"),s=b("dom"),q=b("./special"),k=b("./observable"),i=b("./object"),n=r.Utils,t=t,d={on:function(a,b,d,g){a=s.query(a);n.batchForType(function(a,b,g,d){for(var g=n.normalizeParam(b,
g,d),e,b=g.type,d=a.length-1;d>=0;d--){e=a[d];c(e,b,g)}},1,a,b,d,g);return a},detach:function(a,b,c,g){a=s.query(a);n.batchForType(function(a,b,c,g){for(var c=n.normalizeParam(b,c,g),d,e,b=c.type,g=a.length-1;g>=0;g--){d=a[g];f(d,b,c);if(c.deep&&d.getElementsByTagName){e=d.getElementsByTagName("*");for(d=e.length-1;d>=0;d--)f(e[d],b,c)}}},1,a,b,c,g);return a},delegate:function(a,b,c,g,f){return d.on(a,b,{fn:g,context:f,filter:c})},undelegate:function(a,b,c,g,f){return d.detach(a,b,{fn:g,context:f,
filter:c})},fire:function(a,b,c,d){var f=t,c=c||{};c.synthetic=1;n.splitAndRun(b,function(b){var h,i,j;n.fillGroupsForEvent(b,c);b=c.type;if((i=q[b])&&i.typeFix)b=i.typeFix;a=s.query(a);for(i=a.length-1;i>=0;i--){h=a[i];j=k.getDomEventObservable(h,b);!d&&!j&&(j=new k({type:b,currentTarget:h}));if(j){h=j.fire(c,d);f!==false&&h!==t&&(f=h)}}});return f},fireHandler:function(a,b,c){return d.fire(a,b,c,1)},clone:function(a,b){var d;if(d=k.getDomEventObservablesHolder(a)){var g=m.data(a);g&&g===m.data(b)&&
m.removeData(b);j.each(d.observables,function(a,d){j.each(a.observers,function(a){c(b,d,a)})})}}};return d});
KISSY.add("event/dom/base/key-codes",[],function(j){var b=j.UA,a={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,
Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,
WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(b){var f=b.keyCode;if(b.altKey&&!b.ctrlKey||b.metaKey||f>=a.F1&&f<=a.F12)return!1;switch(f){case a.ALT:case a.CAPS_LOCK:case a.CONTEXT_MENU:case a.CTRL:case a.DOWN:case a.END:case a.ESC:case a.HOME:case a.INSERT:case a.LEFT:case a.MAC_FF_META:case a.META:case a.NUMLOCK:case a.NUM_CENTER:case a.PAGE_DOWN:case a.PAGE_UP:case a.PAUSE:case a.PRINT_SCREEN:case a.RIGHT:case a.SHIFT:case a.UP:case a.WIN_KEY:case a.WIN_KEY_RIGHT:return!1;
default:return!0}},isCharacterKey:function(c){if(c>=a.ZERO&&c<=a.NINE||c>=a.NUM_ZERO&&c<=a.NUM_MULTIPLY||c>=a.A&&c<=a.Z||b.webkit&&0==c)return!0;switch(c){case a.SPACE:case a.QUESTION_MARK:case a.NUM_PLUS:case a.NUM_MINUS:case a.NUM_PERIOD:case a.NUM_DIVISION:case a.SEMICOLON:case a.DASH:case a.EQUALS:case a.COMMA:case a.PERIOD:case a.SLASH:case a.APOSTROPHE:case a.SINGLE_QUOTE:case a.OPEN_SQUARE_BRACKET:case a.BACKSLASH:case a.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}};return a});
KISSY.add("event/dom/base/gesture",[],function(){return{start:"mousedown",move:"mousemove",end:"mouseup",tap:"click",singleTap:"click",doubleTap:"dblclick"}});
KISSY.add("event/dom/base/special-events",["./dom-event","./special"],function(j,b){var a=b("./dom-event"),c=b("./special"),f=f;return j.mix(c,{mousewheel:{typeFix:j.UA.gecko?"DOMMouseScroll":"mousewheel"},load:{bubbles:!1},click:{fire:function(a){return!a&&"checkbox"===""+this.type&&this.click&&"input"==this.nodeName.toLowerCase()?(this.click(),!1):f}},focus:{bubbles:!1,preFire:function(b,c){if(!c)return a.fire(this,"focusin")},fire:function(a){return!a&&this.ownerDocument&&this!==this.ownerDocument.activeElement&&
this.focus?(this.focus(),!1):f}},blur:{bubbles:!1,preFire:function(b,c){if(!c)return a.fire(this,"focusout")},fire:function(a){return!a&&this.ownerDocument&&this===this.ownerDocument.activeElement&&this.blur?(this.blur(),!1):f}}})});
KISSY.add("event/dom/base/mouseenter",["dom","./special"],function(j,b){var a=b("dom"),c=b("./special");j.each([{name:"mouseenter",fix:"mouseover"},{name:"mouseleave",fix:"mouseout"}],function(b){c[b.name]={typeFix:b.fix,handle:function(b,c,f){var j=b.currentTarget,k=b.relatedTarget;if(!k||k!==j&&!a.contains(j,k))return[c.simpleNotify(b,f)]}}})});
KISSY.add("event/dom/base/valuechange",["dom","./dom-event","./special"],function(j,b){function a(a){if(k.hasData(a,h)){var b=k.data(a,h);clearTimeout(b);k.removeData(a,h)}}function c(b){a(b.target)}function f(a){var b=a.value,c=k.data(a,e);b!==c&&(i.fireHandler(a,t,{prevVal:c,newVal:b}),k.data(a,e,b))}function r(a){k.hasData(a,h)||k.data(a,h,setTimeout(function(){f(a);k.data(a,h,setTimeout(arguments.callee,l))},l))}function m(a){var b=a.target;"focus"==a.type&&k.data(b,e,b.value);r(b)}function s(a){f(a.target)}
function q(b){k.removeData(b,e);a(b);i.detach(b,"blur",c);i.detach(b,"webkitspeechchange",s);i.detach(b,"mousedown keyup keydown focus",m)}var k=b("dom"),i=b("./dom-event"),n=b("./special"),t="valuechange",d=k.nodeName,e="event/valuechange/history",h="event/valuechange/poll",l=50;n[t]={setup:function(){var a=d(this);if("input"==a||"textarea"==a)q(this),i.on(this,"blur",c),i.on(this,"webkitspeechchange",s),i.on(this,"mousedown keyup keydown focus",m)},tearDown:function(){q(this)}};return i});
KISSY.add("event/dom/base","./base/dom-event,./base/object,./base/key-codes,./base/gesture,./base/special-events,./base/mouseenter,./base/valuechange".split(","),function(j,b){var a=b("./base/dom-event"),c=b("./base/object"),f=b("./base/key-codes"),r=b("./base/gesture"),m=b("./base/special-events");b("./base/mouseenter");b("./base/valuechange");return j.merge({add:a.on,remove:a.detach,KeyCode:f,Gesture:r,Special:m,Object:c},a)});
