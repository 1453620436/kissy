/*
Copyright 2014, KISSY v1.50
MIT Licensed
build time: Apr 3 23:46
*/
KISSY.add("overlay/extension/loading",["node"],function(h,d){function i(){}var f=d("node");i.prototype={loading:function(){this._loadingExtEl||(this._loadingExtEl=(new f('<div class="'+this.get("prefixCls")+'ext-loading" style="position: absolute;border: none;width: 100%;top: 0;left: 0;z-index: 99999;height:100%;*height: expression(this.parentNode.offsetHeight);"/>')).appendTo(this.$el));this._loadingExtEl.show()},unloading:function(){this._loadingExtEl&&this._loadingExtEl.hide()}};return i});
KISSY.add("overlay/extension/mask",["ua","node"],function(h,d){function i(b,g){var a=b.view.getBaseCssClasses("mask"),a=c('<div  style="width:'+(e?"expression(KISSY.DOM.docWidth())":"100%")+";left:0;top:0;height:"+(e?"expression(KISSY.DOM.docHeight())":"100%")+";position:"+(e?"absolute":"fixed")+';" class="'+a+" "+g+'">'+(e?'<iframe style="position:absolute;left:0;top:0;background:red;width: expression(this.parentNode.offsetWidth);height: expression(this.parentNode.offsetHeight);filter:alpha(opacity=0);z-index:-1;"></iframe>':
"")+"</div>").prependTo("body");a.unselectable();a.on("mousedown",function(b){b.preventDefault()});return a}function f(){}function a(b,a){var g=b.get("maskNode"),e=b.view.getBaseCssClasses("mask-hidden");a?g.removeClass(e):g.addClass(e)}function j(b,g,e,c){var k=b.effect||q;a(c,e);if(k!==q){var c=b.duration,b=b.easing,l=e?1:0;g.stop(1,1);g.css("display",e?q:"block");g[k+n[k][l]](c,function(){g.css("display","")},b)}}function b(b){var g=this.get("maskNode");if(b=b.newVal){var e=Number(this.$el.css("z-index"));
isNaN(e)||g.css("z-index",e)}j(this.get("mask"),g,b,this)}var k=d("ua"),g=d("node"),e=6===k.ie,c=g.all;f.ATTRS={mask:{value:!1},maskNode:{}};var q="none",n={fade:["Out","In"],slide:["Up","Down"]};f.prototype={__renderUI:function(){this.get("mask")&&this.set("maskNode",i(this,this.get("visible")?"":this.view.getBaseCssClasses("mask-hidden")))},__bindUI:function(){var e,a;if(a=this.get("mask")){e=this.get("maskNode");if(a.closeOnClick)e.on(g.Gesture.tap,this.close,this);this.on("afterVisibleChange",
b)}},__destructor:function(){var b;(b=this.get("maskNode"))&&b.remove()}};return f});
KISSY.add("overlay/overlay-xtpl",[],function(h,d,i,f){h=function(a,j,b,k,g){var e=this,c=e.nativeCommands,d=e.utils;if("1.50"!==j.version)throw Error("current xtemplate file("+e.name+")(v1.50) need to be recompiled using current kissy(v"+j.version+")!");var f=d.callCommand,h=c["if"],j=c.block;b.write("");c={escape:1};d=[];d.push("ks-overlay-closable");c.params=d;c.fn=function(b,a){a.write("\n    ");var c={escape:1},d=[],l=b.resolve(["closable"]);d.push(l);c.params=d;c.fn=function(b,a){a.write('\n        <a href="javascript:void(\'close\')"\n           id="ks-overlay-close-');
var c=b.resolve(["id"]);a.write(c,!0);a.write('"\n           class="');var c={escape:1},l=[];l.push("close");c.params=l;if((c=f(e,b,c,a,"getBaseCssClasses",5))&&c.isBuffer)a=c,c=g;a.write(c,!0);a.write("\"\n           role='button'>\n            <span class=\"");c={escape:1};l=[];l.push("close-x");c.params=l;if((c=f(e,b,c,a,"getBaseCssClasses",7))&&c.isBuffer)a=c,c=g;a.write(c,!0);a.write('">close</span>\n        </a>\n    ');return a};a=h.call(e,b,c,a,2,k);a.write("\n");return a};b=j.call(e,a,c,
b,1,k);b.write('\n\n<div id="ks-content-');c=a.resolve(["id"]);b.write(c,!0);b.write('"\n     class="');c={escape:1};d=[];d.push("content");c.params=d;if((c=f(e,a,c,b,"getBaseCssClasses",13))&&c.isBuffer)b=c,c=g;b.write(c,!0);b.write('">\n    ');c={escape:1};d=[];d.push("ks-overlay-content");c.params=d;c.fn=function(b,a){a.write("\n        ");var c=b.resolve(["content"]);a.write(c,!1);a.write("\n    ");return a};b=j.call(e,a,c,b,14,k);b.write("\n</div>");return b};h.TPL_NAME=f.name;return h});
KISSY.add("overlay/overlay-render",["component/container","./overlay-xtpl","component/extension/content-render"],function(h,d){var i=d("component/container"),f=d("./overlay-xtpl"),a=d("component/extension/content-render");return i.getDefaultRender().extend([a],{createDom:function(){this.fillChildrenElsBySelectors({closeBtn:"#ks-overlay-close-{id}"})}},{ATTRS:{contentTpl:{value:f}},HTML_PARSER:{closeBtn:function(a){return a.one("."+this.getBaseCssClass("close"))}}})});
KISSY.add("overlay/extension/overlay-effect",[],function(h){function d(b){var a=b.$el.clone(!0);a.css({visibility:"visible",overflow:"hidden"}).addClass(b.get("prefixCls")+"overlay-ghost");return b.__afterCreateEffectGhost(a)}function i(b,a,g){b.__effectGhost&&b.__effectGhost.stop(1,1);var e=b.$el,c=h.all,f=b.get("effect"),j=c(f.target),c=f.duration,i=h.mix(j.offset(),{width:j.width(),height:j.height()}),o=h.mix(e.offset(),{width:e.width(),height:e.height()}),m=d(b),j=f.easing;m.insertAfter(e);a?
(a=i,i=o):a=o;e.css("visibility","hidden");m.css(a);b.__effectGhost=m;m.animate(i,{Anim:f.Anim,duration:c,easing:j,complete:function(){b.__effectGhost=null;m.remove();e.css("visibility","");g()}})}function f(b,a,g){var e=b.$el,c=b.get("effect"),d=c.effect||"none",f=c.target;if("none"===d&&!f)g();else if(f)i(b,a,g);else{var b=c.duration,f=c.easing,h=a?1:0;e.stop(1,1);e.css({visibility:"visible",display:a?"none":"block"});e[d+j[d][h]]({duration:b,Anim:c.Anim,complete:function(){e.css({display:"block",
visibility:""});g()},easing:f})}}function a(){}var j={fade:["Out","In"],slide:["Up","Down"]};a.ATTRS={effect:{value:{effect:"",target:null,duration:0.5,easing:"easeOut"},setter:function(a){var d=a.effect;"string"===typeof d&&!j[d]&&(a.effect="")}}};a.prototype={__afterCreateEffectGhost:function(a){return a},_onSetVisible:function(a){var d=this;f(d,a,function(){d.fire(a?"show":"hide")})}};return a});
KISSY.add("overlay/control","component/container,component/extension/shim,component/extension/align,./extension/loading,./extension/mask,./overlay-render,./extension/overlay-effect".split(","),function(h,d){var i=d("component/container"),f=d("component/extension/shim"),a=d("component/extension/align"),j=d("./extension/loading"),b=d("./extension/mask"),k=d("./overlay-render"),g=d("./extension/overlay-effect"),e={hide:"hide",destroy:"destroy"};return i.extend([f,j,a,b,g],{bindUI:function(){var a=this,
b=a.get("closeBtn");if(b)b.on("click",function(b){a.close();b.preventDefault()})},close:function(){this[e[this.get("closeAction")]||"hide"]();return this}},{ATTRS:{contentEl:{},closable:{value:false,view:1},closeBtn:{view:1},closeAction:{value:"hide"},focusable:{value:false},allowTextSelection:{value:true},handleGestureEvents:{value:false},visible:{value:false},xrender:{value:k}},xclass:"overlay"})});
KISSY.add("overlay/dialog-xtpl",["./overlay-xtpl"],function(h,d,i,f){h=function(a,j,b,h,g){var e=this,c,i=e.nativeCommands,n=e.utils;if("1.50"!==j.version)throw Error("current xtemplate file("+e.name+")(v1.50) need to be recompiled using current kissy(v"+j.version+")!");"undefined"!==typeof f&&f.kissy&&(c=f);var p=n.callCommand,o=i.each,j=i.extend,i=i.block;b.write("");var n={},m=[];m.push("./overlay-xtpl");n.params=m;c&&(d("./overlay-xtpl"),n.params[0]=c.resolve(n.params[0]));if((c=j.call(e,a,n,
b,1,h))&&c.isBuffer)b=c,c=g;b.write(c,!1);b.write("\n");c={escape:1};j=[];j.push("ks-overlay-content");c.params=j;c.fn=function(a,b){b.write('\n    <div class="');var c={escape:1},d=[];d.push("header");c.params=d;if((c=p(e,a,c,b,"getBaseCssClasses",3))&&c.isBuffer){b=c;c=g}b.write(c,true);b.write('"\n         style="\n');var c={escape:1},d=[],f=a.resolve(["headerStyle"]);d.push(f);c.params=d;c.fn=function(b,a){a.write("\n ");var c=b.resolve(["xindex"]);a.write(c,true);a.write(":");c=b.resolve(["this"]);
a.write(c,true);a.write(";\n");return a};b=o.call(e,a,c,b,5,h);b.write('\n"\n         id="ks-stdmod-header-');c=a.resolve(["id"]);b.write(c,true);b.write('">');c=a.resolve(["headerContent"]);b.write(c,false);b.write('</div>\n\n    <div class="');c={escape:1};d=[];d.push("body");c.params=d;if((c=p(e,a,c,b,"getBaseCssClasses",11))&&c.isBuffer){b=c;c=g}b.write(c,true);b.write('"\n         style="\n');c={escape:1};d=[];f=a.resolve(["bodyStyle"]);d.push(f);c.params=d;c.fn=function(b,a){a.write("\n ");
var c=b.resolve(["xindex"]);a.write(c,true);a.write(":");c=b.resolve(["this"]);a.write(c,true);a.write(";\n");return a};b=o.call(e,a,c,b,13,h);b.write('\n"\n         id="ks-stdmod-body-');c=a.resolve(["id"]);b.write(c,true);b.write('">');c=a.resolve(["bodyContent"]);b.write(c,false);b.write('</div>\n\n    <div class="');c={escape:1};d=[];d.push("footer");c.params=d;if((c=p(e,a,c,b,"getBaseCssClasses",19))&&c.isBuffer){b=c;c=g}b.write(c,true);b.write('"\n         style="\n');c={escape:1};d=[];f=a.resolve(["footerStyle"]);
d.push(f);c.params=d;c.fn=function(a,b){b.write("\n ");var c=a.resolve(["xindex"]);b.write(c,true);b.write(":");c=a.resolve(["this"]);b.write(c,true);b.write(";\n");return b};b=o.call(e,a,c,b,21,h);b.write('\n"\n         id="ks-stdmod-footer-');c=a.resolve(["id"]);b.write(c,true);b.write('">');c=a.resolve(["footerContent"]);b.write(c,false);b.write('</div>\n    <div tabindex="0"></div>\n');return b};return b=i.call(e,a,c,b,2,h)};h.TPL_NAME=f.name;return h});
KISSY.add("overlay/dialog-render",["./overlay-render","./dialog-xtpl"],function(h,d){var i=d("./overlay-render"),f=d("./dialog-xtpl");return i.extend({beforeCreateDom:function(a){h.mix(a.elAttrs,{role:"dialog","aria-labelledby":"ks-stdmod-header-"+this.control.get("id")})},createDom:function(){this.fillChildrenElsBySelectors({header:"#ks-stdmod-header-{id}",body:"#ks-stdmod-body-{id}",footer:"#ks-stdmod-footer-{id}"})},getChildrenContainerEl:function(){return this.control.get("body")},_onSetBodyStyle:function(a){this.control.get("body").css(a)},
_onSetHeaderStyle:function(a){this.control.get("header").css(a)},_onSetFooterStyle:function(a){this.control.get("footer").css(a)},_onSetBodyContent:function(a){var d;d=this.control.get("body");d.html(a)},_onSetHeaderContent:function(a){var d;d=this.control.get("header");d.html(a)},_onSetFooterContent:function(a){var d;d=this.control.get("footer");d.html(a)}},{ATTRS:{contentTpl:{value:f}},HTML_PARSER:{header:function(a){return a.one("."+this.getBaseCssClass("header"))},body:function(a){return a.one("."+
this.getBaseCssClass("body"))},footer:function(a){return a.one("."+this.getBaseCssClass("footer"))},headerContent:function(a){return a.one("."+this.getBaseCssClass("header")).html()},bodyContent:function(a){return a.one("."+this.getBaseCssClass("body")).html()},footerContent:function(a){return(a=a.one("."+this.getBaseCssClass("footer")))&&a.html()}}})});
KISSY.add("overlay/dialog",["./control","./dialog-render","node"],function(h,d){var i=d("./control"),f=d("./dialog-render"),a=d("node"),i=i.extend({__afterCreateEffectGhost:function(b){var a=this.get("body");b.all("."+this.get("prefixCls")+"stdmod-body").css({height:a.height(),width:a.width()}).html("");return b},handleKeyDownInternal:function(b){if(this.get("escapeToClose")&&b.keyCode===a.KeyCode.ESC){if("select"!==b.target.nodeName.toLowerCase()||b.target.disabled)this.close(),b.halt()}else a:if(b.keyCode===
j){var d=this.$el,g=a.all(b.target),e=d.last();if(g.equals(d)&&b.shiftKey)e[0].focus(),b.halt();else if(g.equals(e)&&!b.shiftKey)this.focus(),b.halt();else if(g.equals(d)||d.contains(g))break a;b.halt()}},_onSetVisible:function(a,d){var g=this.el;if(a)this.__lastActive=g.ownerDocument.activeElement,this.focus(),g.setAttribute("aria-hidden","false");else{g.setAttribute("aria-hidden","true");try{this.__lastActive&&this.__lastActive.focus()}catch(e){}}this.callSuper(a,d)}},{ATTRS:{header:{view:1},body:{view:1},
footer:{view:1},bodyStyle:{value:{},view:1},footerStyle:{value:{},view:1},headerStyle:{value:{},view:1},headerContent:{value:"",view:1},bodyContent:{value:"",view:1},footerContent:{value:"",view:1},closable:{value:!0},xrender:{value:f},focusable:{value:!0},escapeToClose:{value:!0}},xclass:"dialog"}),j=a.KeyCode.TAB;return i});
KISSY.add("overlay/popup",["./control"],function(h,d){function i(){var d=this,e=d.get("trigger"),c;d.__mouseEnterPopup=function(e){a.call(d);c=h.later(function(){b.call(d,e);c=void 0},1E3*d.get("mouseDelay"))};e.on("mouseenter",d.__mouseEnterPopup);d._mouseLeavePopup=function(){c&&(c.cancel(),c=void 0);f.call(d)};e.on("mouseleave",d._mouseLeavePopup)}function f(){var a=this;a._hiddenTimer=h.later(function(){k.call(a)},1E3*a.get("mouseDelay"))}function a(){this._hiddenTimer&&(this._hiddenTimer.cancel(),
this._hiddenTimer=void 0)}function j(){var a=this;a.__clickPopup=function(d){d.preventDefault();a.get("toggle")?(a.get("visible")?k:b).call(a,d):b.call(a,d)};a.get("trigger").on("click",a.__clickPopup)}function b(a){this.set("currentTrigger",h.one(a.target));this.show()}function k(){this.set("currentTrigger",void 0);this.hide()}return d("./control").extend({initializer:function(){this.get("trigger")&&("mouse"===this.get("triggerType")?i.call(this):j.call(this))},bindUI:function(){if(this.get("trigger")&&
"mouse"===this.get("triggerType"))this.$el.on("mouseleave",f,this).on("mouseenter",a,this)},destructor:function(){var b=this.$el,d=this.get("trigger");d&&(this.__clickPopup&&d.detach("click",this.__clickPopup),this.__mouseEnterPopup&&d.detach("mouseenter",this.__mouseEnterPopup),this._mouseLeavePopup&&d.detach("mouseleave",this._mouseLeavePopup));b&&b.detach("mouseleave",f,this).detach("mouseenter",a,this)}},{ATTRS:{trigger:{setter:function(a){return h.all(a)}},triggerType:{value:"click"},currentTrigger:{},
mouseDelay:{value:0.1},toggle:{value:!1}},xclass:"popup"})});KISSY.add("overlay",["overlay/control","overlay/dialog","overlay/popup"],function(h,d){var i=d("overlay/control"),f=d("overlay/dialog"),a=d("overlay/popup");i.Dialog=f;h.Dialog=f;i.Popup=a;return h.Overlay=i});
