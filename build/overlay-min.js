/*
Copyright 2013, KISSY v1.50dev
MIT Licensed
build time: Nov 26 22:03
*/
KISSY.add("overlay/extension/loading",["node"],function(j,h){function c(){}var e=h("node");c.prototype={loading:function(){this._loadingExtEl||(this._loadingExtEl=(new e("<div class='"+this.get("prefixCls")+"ext-loading' style='position: absolute;border: none;width: 100%;top: 0;left: 0;z-index: 99999;height:100%;*height: expression(this.parentNode.offsetHeight);'/>")).appendTo(this.$el));this._loadingExtEl.show()},unloading:function(){var a=this._loadingExtEl;a&&a.hide()}};return c});
KISSY.add("overlay/extension/mask",["node"],function(j,h){function c(b){b=b.view.getBaseCssClasses("mask");b=l("<div  style='width:"+(n?"expression(KISSY.DOM.docWidth())":"100%")+";left:0;top:0;height:"+(n?"expression(KISSY.DOM.docHeight())":"100%")+";position:"+(n?"absolute":"fixed")+";' class='"+b+"'>"+(n?"<iframe style='position:absolute;left:0;top:0;background:red;width: expression(this.parentNode.offsetWidth);height: expression(this.parentNode.offsetHeight);filter:alpha(opacity=0);z-index:-1;'></iframe>":
"")+"</div>").prependTo("body");b.unselectable();b.on("mousedown",function(b){b.preventDefault()});return b}function e(){}function a(b,a){var k=b.get("maskNode"),d=b.view.getBaseCssClasses("mask-hidden");a?k.removeClass(d):k.addClass(d)}function b(b,k,d,f){var c=b.effect||i;a(f,d);if(c!=i){var f=b.duration,b=b.easing,e=d?1:0;k.stop(1,1);k.css("display",d?i:"block");k[c+g[c][e]](f,function(){k.css("display","")},b)}}function k(a){var k=this.get("maskNode");if(a=a.newVal){var d=Number(this.$el.css("z-index"));
isNaN(d)||k.css("z-index",d)}b(this.get("mask"),k,a,this)}var f=j.UA,d=h("node"),n=6===f.ie,l=d.all;e.ATTRS={mask:{value:!1},maskNode:{}};var i="none",g={fade:["Out","In"],slide:["Up","Down"]};e.prototype={__renderUI:function(){this.get("mask")&&this.set("maskNode",c(this))},__bindUI:function(){var b,a;if(a=this.get("mask")){b=this.get("maskNode");if(a.closeOnClick)b.on(d.Gesture.tap,this.close,this);this.on("afterVisibleChange",k)}},__destructor:function(){var b;(b=this.get("maskNode"))&&b.remove()}};
return e});
KISSY.add("overlay/close-xtpl",[],function(){return function(j,h,c){var e,a=this;e=this.config.utils;var h=e.runBlockCommand,b=e.getExpression,k=e.getPropertyOrRunCommand;e="";var f={},d=[],n=k(a,j,{},"closable",0,1,c,!0);d.push(n);f.params=d;f.fn=function(d){var f;f='\n<a href="javascript:void(\'close\')"\n   id="ks-overlay-close-';var g=k(a,d,{},"id",0,3,c,!1);f+=b(g,!0);f+='"\n   class="';var g={},e=[];e.push("close");g.params=e;g=k(a,d,g,"getBaseCssClasses",0,4,!0,c);f=f+g+"\"\n   role='button'>\n    <span class=\"";g=
{};e=[];e.push("close-x");g.params=e;d=k(a,d,g,"getBaseCssClasses",0,6,!0,c);return f+d+'">close</span>\n</a>\n'};e+=h(a,j,f,"if",1);return e+"\n"}});
KISSY.add("overlay/overlay-xtpl",["overlay/close-xtpl","component/extension/content-xtpl"],function(j,h,c,e){return function(a,b,k){var f,b=this.config.utils;"undefined"!=typeof e&&e.kissy&&(f=e);var d=b.getPropertyOrRunCommand,b="",c={},l=[];l.push("overlay/close-xtpl");c.params=l;f&&(h("overlay/close-xtpl"),c.params[0]=f.resolveByName(c.params[0]));c=d(this,a,c,"include",0,1,!1,k);b=b+c+"\n";c={};l=[];l.push("component/extension/content-xtpl");c.params=l;f&&(h("component/extension/content-xtpl"),
c.params[0]=f.resolveByName(c.params[0]));a=d(this,a,c,"include",0,2,!1,k);return b+a}});
KISSY.add("overlay/overlay-render",["component/container","./overlay-xtpl","component/extension/content-render"],function(j,h){var c=h("component/container"),e=h("./overlay-xtpl"),a=h("component/extension/content-render");return c.getDefaultRender().extend([a],{createDom:function(){this.fillChildrenElsBySelectors({closeBtn:"#ks-overlay-close-{id}"})}},{ATTRS:{contentTpl:{value:e}},HTML_PARSER:{closeBtn:function(b){return b.one("."+this.getBaseCssClass("close"))}}})});
KISSY.add("overlay/extension/overlay-effect",[],function(j){function h(b){var a=b.$el.clone(!0);a.css({visibility:"visible",overflow:"hidden"}).addClass(b.get("prefixCls")+"overlay-ghost");return b.__afterCreateEffectGhost(a)}function c(b,a,d){b.__effectGhost&&b.__effectGhost.stop(1,1);var c=b.$el,e=j.all,i=b.get("effect"),g=e(i.target),e=i.duration,g=j.mix(g.offset(),{width:g.width(),height:g.height()}),m=j.mix(c.offset(),{width:c.width(),height:c.height()}),o=h(b),i=i.easing;o.insertAfter(c);a?
(a=g,g=m):a=m;c.css("visibility","hidden");o.css(a);b.__effectGhost=o;o.animate(g,{duration:e,easing:i,complete:function(){b.__effectGhost=null;o.remove();c.css("visibility","");d()}})}function e(a,f,d){var e=a.$el,h=a.get("effect"),i=h.effect||"none",g=h.target;"none"==i&&!g?d():g?c(a,f,d):(a=h.duration,h=h.easing,g=f?1:0,e.stop(1,1),e.css({visibility:"visible",display:f?"none":"block"}),e[i+b[i][g]](a,function(){e.css({display:"block",visibility:""});d()},h))}function a(){}var b={fade:["Out","In"],
slide:["Up","Down"]};a.ATTRS={effect:{value:{effect:"",target:null,duration:0.5,easing:"easeOut"},setter:function(a){var c=a.effect;"string"==typeof c&&!b[c]&&(a.effect="")}}};a.prototype={__afterCreateEffectGhost:function(b){return b},_onSetVisible:function(b){var a=this;e(a,b,function(){a.fire(b?"show":"hide")})}};return a});
KISSY.add("overlay/control","component/container,component/extension/shim,component/extension/align,./extension/loading,./extension/mask,./overlay-render,./extension/overlay-effect".split(","),function(j,h){var c=h("component/container"),e=h("component/extension/shim"),a=h("component/extension/align"),b=h("./extension/loading"),k=h("./extension/mask"),f=h("./overlay-render"),d=h("./extension/overlay-effect"),n={hide:"hide",destroy:"destroy"};return c.extend([e,b,a,k,d],{bindUI:function(){var b=this,
a=b.get("closeBtn");if(a)a.on("click",function(a){b.close();a.preventDefault()})},close:function(){this[n[this.get("closeAction")]||"hide"]();return this}},{ATTRS:{contentEl:{},closable:{value:false,view:1},closeBtn:{view:1},closeAction:{value:"hide"},focusable:{value:false},allowTextSelection:{value:true},handleMouseEvents:{value:false},visible:{value:false},xrender:{value:f}},xclass:"overlay"})});
KISSY.add("overlay/dialog-xtpl",["overlay/close-xtpl"],function(j,h,c,e){return function(a,b,c){var f=this,d,b=this.config.utils;"undefined"!=typeof e&&e.kissy&&(d=e);var j=b.runBlockCommand,l=b.getExpression,i=b.getPropertyOrRunCommand,b="",g={},m=[];m.push("overlay/close-xtpl");g.params=m;d&&(h("overlay/close-xtpl"),g.params[0]=d.resolveByName(g.params[0]));d=i(f,a,g,"include",0,1,!1,c);b=b+d+'\n<div id="ks-content-';d=i(f,a,{},"id",0,2,c,!1);b+=l(d,!0);b+='"\n     class="';d={};g=[];g.push("content");
d.params=g;d=i(f,a,d,"getBaseCssClasses",0,3,!0,c);b=b+d+'">\n    <div class="';d={};g=[];g.push("header");d.params=g;d=i(f,a,d,"getBaseCssClasses",0,4,!0,c);b=b+d+'"\n         style="\n';d={};g=[];m=i(f,a,{},"headerStyle",0,6,c,!0);g.push(m);d.params=g;d.fn=function(b){var a;a=" \n ";var d=i(f,b,{},"xindex",0,7,c,false);a=a+l(d,true);a=a+":";b=i(f,b,{},".",0,7,c,false);a=a+l(b,true);return a+";\n"};b+=j(f,a,d,"each",6);b+='\n"\n         id="ks-stdmod-header-';d=i(f,a,{},"id",0,10,c,!1);b+=l(d,!0);
b+='">';d=i(f,a,{},"headerContent",0,10,c,!1);b+=l(d,!1);b+='</div>\n\n    <div class="';d={};g=[];g.push("body");d.params=g;d=i(f,a,d,"getBaseCssClasses",0,12,!0,c);b=b+d+'"\n         style="\n';d={};g=[];m=i(f,a,{},"bodyStyle",0,14,c,!0);g.push(m);d.params=g;d.fn=function(b){var a;a=" \n ";var d=i(f,b,{},"xindex",0,15,c,false);a=a+l(d,true);a=a+":";b=i(f,b,{},".",0,15,c,false);a=a+l(b,true);return a+";\n"};b+=j(f,a,d,"each",14);b+='\n"\n         id="ks-stdmod-body-';d=i(f,a,{},"id",0,18,c,!1);b+=
l(d,!0);b+='">';d=i(f,a,{},"bodyContent",0,18,c,!1);b+=l(d,!1);b+='</div>\n\n    <div class="';d={};g=[];g.push("footer");d.params=g;d=i(f,a,d,"getBaseCssClasses",0,20,!0,c);b=b+d+'"\n         style="\n';d={};g=[];m=i(f,a,{},"footerStyle",0,22,c,!0);g.push(m);d.params=g;d.fn=function(b){var a;a=" \n ";var d=i(f,b,{},"xindex",0,23,c,false);a=a+l(d,true);a=a+":";b=i(f,b,{},".",0,23,c,false);a=a+l(b,true);return a+";\n"};b+=j(f,a,d,"each",22);b+='\n"\n         id="ks-stdmod-footer-';j=i(f,a,{},"id",
0,26,c,!1);b+=l(j,!0);b+='">';a=i(f,a,{},"footerContent",0,26,c,!1);b+=l(a,!1);return b+'</div>\n</div>\n<div tabindex="0"></div>'}});
KISSY.add("overlay/dialog-render",["./overlay-render","./dialog-xtpl"],function(j,h){var c=h("./overlay-render"),e=h("./dialog-xtpl");return c.extend({beforeCreateDom:function(a){j.mix(a.elAttrs,{role:"dialog","aria-labelledby":"ks-stdmod-header-"+this.control.get("id")})},createDom:function(){this.fillChildrenElsBySelectors({header:"#ks-stdmod-header-{id}",body:"#ks-stdmod-body-{id}",footer:"#ks-stdmod-footer-{id}"})},getChildrenContainerEl:function(){return this.control.get("body")},_onSetBodyStyle:function(a){this.control.get("body").css(a)},
_onSetHeaderStyle:function(a){this.control.get("header").css(a)},_onSetFooterStyle:function(a){this.control.get("footer").css(a)},_onSetBodyContent:function(a){var b;b=this.control.get("body");b.html(a)},_onSetHeaderContent:function(a){var b;b=this.control.get("header");b.html(a)},_onSetFooterContent:function(a){var b;b=this.control.get("footer");b.html(a)}},{ATTRS:{contentTpl:{value:e}},HTML_PARSER:{header:function(a){return a.one("."+this.getBaseCssClass("header"))},body:function(a){return a.one("."+
this.getBaseCssClass("body"))},footer:function(a){return a.one("."+this.getBaseCssClass("footer"))},headerContent:function(a){return a.one("."+this.getBaseCssClass("header")).html()},bodyContent:function(a){return a.one("."+this.getBaseCssClass("body")).html()},footerContent:function(a){return(a=a.one("."+this.getBaseCssClass("footer")))&&a.html()}}})});
KISSY.add("overlay/dialog",["./control","./dialog-render","node"],function(j,h){var c=h("./control"),e=h("./dialog-render"),a=h("node"),c=c.extend({__afterCreateEffectGhost:function(a){var b=this.get("body");a.all("."+this.get("prefixCls")+"stdmod-body").css({height:b.height(),width:b.width()}).html("");return a},handleKeyDownInternal:function(c){if(this.get("escapeToClose")&&c.keyCode===a.KeyCode.ESC){if("select"!=c.target.nodeName.toLowerCase()||c.target.disabled)this.close(),c.halt()}else a:if(c.keyCode==
b){var e=this.$el,d=a.all(c.target),h=e.last();if(d.equals(el)&&c.shiftKey)h[0].focus(),c.halt();else if(d.equals(h)&&!c.shiftKey)this.focus(),c.halt();else if(d.equals(e)||e.contains(d))break a;c.halt()}},_onSetVisible:function(a,b){var c=this.el;if(a)this.__lastActive=c.ownerDocument.activeElement,this.focus(),c.setAttribute("aria-hidden","false");else{c.setAttribute("aria-hidden","true");try{this.__lastActive&&this.__lastActive.focus()}catch(e){}}this.callSuper(a,b)}},{ATTRS:{header:{view:1},body:{view:1},
footer:{view:1},bodyStyle:{value:{},view:1},footerStyle:{value:{},view:1},headerStyle:{value:{},view:1},headerContent:{value:"",view:1},bodyContent:{value:"",view:1},footerContent:{value:"",view:1},closable:{value:!0},xrender:{value:e},focusable:{value:!0},escapeToClose:{value:!0}},xclass:"dialog"}),b=a.KeyCode.TAB;return c});
KISSY.add("overlay/popup",["./control"],function(j,h){return h("./control").extend({initializer:function(){var c=this;c.get("trigger")&&("mouse"===c.get("triggerType")?(c._bindTriggerMouse(),c.on("afterRenderUI",function(){c._bindContainerMouse()})):c._bindTriggerClick())},_bindTriggerMouse:function(){var c=this,e=c.get("trigger"),a;c.__mouseEnterPopup=function(b){c._clearHiddenTimer();a=j.later(function(){c._showing(b);a=void 0},1E3*c.get("mouseDelay"))};e.on("mouseenter",c.__mouseEnterPopup);c._mouseLeavePopup=
function(){a&&(a.cancel(),a=void 0);c._setHiddenTimer()};e.on("mouseleave",c._mouseLeavePopup)},_bindContainerMouse:function(){this.$el.on("mouseleave",this._setHiddenTimer,this).on("mouseenter",this._clearHiddenTimer,this)},_setHiddenTimer:function(){var c=this;c._hiddenTimer=j.later(function(){c._hiding()},1E3*c.get("mouseDelay"))},_clearHiddenTimer:function(){this._hiddenTimer&&(this._hiddenTimer.cancel(),this._hiddenTimer=void 0)},_bindTriggerClick:function(){var c=this;c.__clickPopup=function(e){e.preventDefault();
if(c.get("toggle"))c[c.get("visible")?"_hiding":"_showing"](e);else c._showing(e)};c.get("trigger").on("click",c.__clickPopup)},_showing:function(c){this.set("currentTrigger",j.one(c.target));this.show()},_hiding:function(){this.set("currentTrigger",void 0);this.hide()},destructor:function(){var c=this.$el,e=this.get("trigger");e&&(this.__clickPopup&&e.detach("click",this.__clickPopup),this.__mouseEnterPopup&&e.detach("mouseenter",this.__mouseEnterPopup),this._mouseLeavePopup&&e.detach("mouseleave",
this._mouseLeavePopup));c.detach("mouseleave",this._setHiddenTimer,this).detach("mouseenter",this._clearHiddenTimer,this)}},{ATTRS:{trigger:{setter:function(c){return j.all(c)}},triggerType:{value:"click"},currentTrigger:{},mouseDelay:{value:0.1},toggle:{value:!1}},xclass:"popup"})});KISSY.add("overlay",["overlay/control","overlay/dialog","overlay/popup"],function(j,h){var c=h("overlay/control"),e=h("overlay/dialog"),a=h("overlay/popup");c.Dialog=e;j.Dialog=e;c.Popup=a;return j.Overlay=c});
