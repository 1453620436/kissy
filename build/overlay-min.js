/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: Apr 10 18:48
*/
KISSY.add("overlay/extension/loading",["node"],function(k,g){function j(){}var i=g("node");j.prototype={loading:function(){this._loadingExtEl||(this._loadingExtEl=(new i('<div class="'+this.get("prefixCls")+'ext-loading" style="position: absolute;border: none;width: 100%;top: 0;left: 0;z-index: 99999;height:100%;*height: expression(this.parentNode.offsetHeight);"/>')).appendTo(this.$el));this._loadingExtEl.show()},unloading:function(){this._loadingExtEl&&this._loadingExtEl.hide()}};return j});
KISSY.add("overlay/extension/mask",["ua","node","event/gesture/tap"],function(k,g){function j(b,d){var m=b.getBaseCssClasses("mask"),m=a('<div  style="width:'+(c?"expression(KISSY.DOM.docWidth())":"100%")+";left:0;top:0;height:"+(c?"expression(KISSY.DOM.docHeight())":"100%")+";position:"+(c?"absolute":"fixed")+';" class="'+m+" "+d+'">'+(c?'<iframe style="position:absolute;left:0;top:0;background:red;width: expression(this.parentNode.offsetWidth);height: expression(this.parentNode.offsetHeight);filter:alpha(opacity=0);z-index:-1;"></iframe>':
"")+"</div>").prependTo("body");m.unselectable();m.on("mousedown",function(b){b.preventDefault()});return m}function i(){}function n(b,d){var m=b.get("maskNode"),f=b.getBaseCssClasses("mask-hidden");d?m.removeClass(f):m.addClass(f)}function e(b,d,m,f){var a=b.effect||o;n(f,m);if(a!==o){var f=b.duration,b=b.easing,c=m?1:0;d.stop(1,1);d.css("display",m?o:"block");d[a+l[a][c]](f,function(){d.css("display","")},b)}}function h(b){var d=this.get("maskNode");if(b=b.newVal){var a=Number(this.$el.css("z-index"));
isNaN(a)||d.css("z-index",a)}e(this.get("mask"),d,b,this)}var d=g("ua"),b=g("node"),c=6===d.ie,a=b.all,q=g("event/gesture/tap").TAP;i.ATTRS={mask:{value:!1},maskNode:{}};var o="none",l={fade:["Out","In"],slide:["Up","Down"]};i.prototype={__renderUI:function(){this.get("mask")&&this.set("maskNode",j(this,this.get("visible")?"":this.getBaseCssClasses("mask-hidden")))},__bindUI:function(){var b,d;if(d=this.get("mask")){b=this.get("maskNode");if(d.closeOnClick)b.on(q,this.close,this);this.on("afterVisibleChange",
h)}},__destructor:function(){var b;(b=this.get("maskNode"))&&b.remove()}};return i});
KISSY.add("overlay/extension/overlay-effect",[],function(k){function g(d){var b=d.$el.clone(!0);b.css({visibility:"visible",overflow:"hidden"}).addClass(d.get("prefixCls")+"overlay-ghost");return d.__afterCreateEffectGhost(b)}function j(d,b){d.__effectGhost&&d.__effectGhost.stop(1,1);var c=d.$el,a=k.all,h=d.get("effect"),e=a(h.target),a=h.duration,l=k.mix(e.offset(),{width:e.width(),height:e.height()}),i=k.mix(c.offset(),{width:c.width(),height:c.height()}),p=g(d),m=h.easing;p.insertAfter(c);b?(e=
l,l=i):e=i;c.css("visibility","hidden");p.css(e);d.__effectGhost=p;p.animate(l,{Anim:h.Anim,duration:a,easing:m,complete:function(){d.__effectGhost=null;p.remove();c.css("visibility","")}})}function i(d,b){var c=d.$el,a=d.get("effect"),e=a.effect||"none",g=a.target;if("none"!==e||g)if(g)j(d,b);else{var g=a.duration,i=a.easing,k=b?1:0;c.stop(1,1);c.css({visibility:"visible",display:b?"none":"block"});c[e+h[e][k]]({duration:g,Anim:a.Anim,complete:function(){c.css({display:"block",visibility:""})},easing:i})}}
function n(d){i(this,d.newVal)}function e(){}var h={fade:["Out","In"],slide:["Up","Down"]};e.ATTRS={effect:{value:{effect:"",target:null,duration:0.5,easing:"easeOut"},setter:function(d){var b=d.effect;"string"===typeof b&&!h[b]&&(d.effect="")}}};e.prototype={__afterCreateEffectGhost:function(d){return d},__bindUI:function(){this.on("afterVisibleChange",n,this)}};return e});
KISSY.add("overlay/overlay-xtpl",[],function(k,g,j,i){g=function(g,e,h,d){var b=this,c=b.nativeCommands,a=b.utils;if("5.0.0"!==k.version)throw Error("current xtemplate file("+b.name+")(v5.0.0) need to be recompiled using current kissy(v"+k.version+")!");var i=a.callCommand,j=c["if"],c=c.block;e.write("");var a={escape:1},l=[];l.push("ks-overlay-closable");a.params=l;a.fn=function(a,c){c.write("\n    ");var m={escape:1},f=[],e=a.resolve(["closable"]);f.push(e);m.params=f;m.fn=function(a,c){c.write('\n        <a href="javascript:void(\'close\')"\n           class="');
var f={escape:1},h=[];h.push("close");f.params=h;if((f=i(b,a,f,c,"getBaseCssClasses",4))&&f.isBuffer)c=f,f=d;c.write(f,!0);c.write("\"\n           role='button'>\n            <span class=\"");f={escape:1};h=[];h.push("close-x");f.params=h;if((f=i(b,a,f,c,"getBaseCssClasses",6))&&f.isBuffer)c=f,f=d;c.write(f,!0);c.write('">close</span>\n        </a>\n    ');return c};c=j.call(b,a,m,c,2,h);c.write("\n");return c};e=c.call(b,g,a,e,1,h);e.write('\n\n<div class="');a={escape:1};l=[];l.push("content");
a.params=l;if((a=i(b,g,a,e,"getBaseCssClasses",11))&&a.isBuffer)e=a,a=d;e.write(a,!0);e.write('">\n    ');a={escape:1};l=[];l.push("ks-overlay-content");a.params=l;a.fn=function(b,d){d.write("\n        ");var c=b.resolve(["content"]);d.write(c,!1);d.write("\n    ");return d};e=c.call(b,g,a,e,12,h);e.write("\n</div>");return e};g.TPL_NAME=i.name;return g});
KISSY.add("overlay/control","component/container,component/extension/shim,component/extension/align,./extension/loading,./extension/mask,./extension/overlay-effect,component/extension/content-box,./overlay-xtpl".split(","),function(k,g){var j=g("component/container"),i=g("component/extension/shim"),n=g("component/extension/align"),e=g("./extension/loading"),h=g("./extension/mask"),d=g("./extension/overlay-effect"),b=g("component/extension/content-box"),c=g("./overlay-xtpl"),a={hide:"hide",destroy:"destroy"};
return j.extend([b,i,e,n,h,d],{bindUI:function(){var b=this,d=b.get("closeBtn");if(d)d.on("click",function(d){b.close();d.preventDefault()})},close:function(){this[a[this.get("closeAction")]||"hide"]();return this}},{ATTRS:{contentEl:{},closable:{value:false,sync:0,render:1,parse:function(){return!!this.get("closeBtn")}},closeBtn:{selector:function(){return"."+this.getBaseCssClass("close")}},closeAction:{value:"hide"},focusable:{value:false},allowTextSelection:{value:true},handleGestureEvents:{value:false},
visible:{value:false},contentTpl:{value:c}},xclass:"overlay"})});
KISSY.add("overlay/dialog-xtpl",["./overlay-xtpl"],function(k,g,j,i){j=function(j,e,h,d){var b=this,c=b.nativeCommands,a=b.utils;if("5.0.0"!==k.version)throw Error("current xtemplate file("+b.name+")(v5.0.0) need to be recompiled using current kissy(v"+k.version+")!");var q=a.callCommand,o=c.each,a=c.extend,c=c.block;e.write("");var l={},r=[];r.push("./overlay-xtpl");l.params=r;g("./overlay-xtpl");l.params[0]=i.resolve(l.params[0]);if((a=a.call(b,j,l,e,1,h))&&a.isBuffer)e=a,a=d;e.write(a,!1);e.write("\n");
a={escape:1};l=[];l.push("ks-overlay-content");a.params=l;a.fn=function(c,a){a.write('\n    <div class="');var f={escape:1},e=[];e.push("header");f.params=e;if((f=q(b,c,f,a,"getBaseCssClasses",3))&&f.isBuffer)a=f,f=d;a.write(f,!0);a.write('"\n         style="\n');var f={escape:1},e=[],g=c.resolve(["headerStyle"]);e.push(g);f.params=e;f.fn=function(b,a){a.write("\n ");var c=b.resolve(["xindex"]);a.write(c,!0);a.write(":");c=b.resolve(["this"]);a.write(c,!0);a.write(";\n");return a};a=o.call(b,c,f,
a,5,h);a.write('\n">');f=c.resolve(["headerContent"]);a.write(f,!1);a.write('</div>\n\n    <div class="');f={escape:1};e=[];e.push("body");f.params=e;if((f=q(b,c,f,a,"getBaseCssClasses",10))&&f.isBuffer)a=f,f=d;a.write(f,!0);a.write('"\n         style="\n');f={escape:1};e=[];g=c.resolve(["bodyStyle"]);e.push(g);f.params=e;f.fn=function(b,a){a.write("\n ");var c=b.resolve(["xindex"]);a.write(c,!0);a.write(":");c=b.resolve(["this"]);a.write(c,!0);a.write(";\n");return a};a=o.call(b,c,f,a,12,h);a.write('\n">');
f=c.resolve(["bodyContent"]);a.write(f,!1);a.write('</div>\n\n    <div class="');f={escape:1};e=[];e.push("footer");f.params=e;if((f=q(b,c,f,a,"getBaseCssClasses",17))&&f.isBuffer)a=f,f=d;a.write(f,!0);a.write('"\n         style="\n');f={escape:1};e=[];g=c.resolve(["footerStyle"]);e.push(g);f.params=e;f.fn=function(b,a){a.write("\n ");var c=b.resolve(["xindex"]);a.write(c,!0);a.write(":");c=b.resolve(["this"]);a.write(c,!0);a.write(";\n");return a};a=o.call(b,c,f,a,19,h);a.write('\n">');f=c.resolve(["footerContent"]);
a.write(f,!1);a.write('</div>\n    <div tabindex="0"></div>\n');return a};return e=c.call(b,j,a,e,2,h)};j.TPL_NAME=i.name;return j});
KISSY.add("overlay/dialog",["./control","node","./dialog-xtpl"],function(k,g){var j=g("./control"),i=g("node"),n=g("./dialog-xtpl"),j=j.extend({beforeCreateDom:function(e){k.mix(e.elAttrs,{role:"dialog","aria-labelledby":"ks-stdmod-header-"+this.get("id")})},getChildrenContainerEl:function(){return this.get("body")},__afterCreateEffectGhost:function(e){var d=this.get("body");e.all("."+this.get("prefixCls")+"stdmod-body").css({height:d.height(),width:d.width()}).html("");return e},handleKeyDownInternal:function(h){if(this.get("escapeToClose")&&
h.keyCode===i.KeyCode.ESC){if("select"!==h.target.nodeName.toLowerCase()||h.target.disabled)this.close(),h.halt()}else a:if(h.keyCode===e){var d=this.$el,b=i.all(h.target),c=d.last();if(b.equals(d)&&h.shiftKey)c[0].focus(),h.halt();else if(b.equals(c)&&!h.shiftKey)this.focus(),h.halt();else if(b.equals(d)||d.contains(b))break a;h.halt()}},_onSetVisible:function(e,d){var b=this.el;this.callSuper(e,d);if(e)this.__lastActive=b.ownerDocument.activeElement,this.focus(),b.setAttribute("aria-hidden","false");
else{b.setAttribute("aria-hidden","true");try{this.__lastActive&&this.__lastActive.focus()}catch(c){}}},_onSetBodyContent:function(e){var d;d=this.get("body");d.html(e)},_onSetHeaderContent:function(e){var d;d=this.get("header");d.html(e)},_onSetFooterContent:function(e){var d;d=this.get("footer");d.html(e)}},{ATTRS:{contentTpl:{value:n},header:{selector:function(){return"."+this.getBaseCssClass("header")}},body:{selector:function(){return"."+this.getBaseCssClass("body")}},footer:{selector:function(){return"."+
this.getBaseCssClass("footer")}},bodyStyle:{value:{},sync:0},footerStyle:{value:{},render:1},headerStyle:{value:{},render:1},headerContent:{value:"",sync:0,render:1,parse:function(){return this.get("header").html()}},bodyContent:{value:"",sync:0,render:1,parse:function(){return this.get("body").html()}},footerContent:{value:"",sync:0,render:1,parse:function(){return this.get("footer").html()}},closable:{value:!0},focusable:{value:!0},escapeToClose:{value:!0}},xclass:"dialog"}),e=i.KeyCode.TAB;return j});
KISSY.add("overlay/popup",["./control"],function(k,g){function j(){var b=this,c=b.get("trigger"),a;b.__mouseEnterPopup=function(c){n.call(b);a=k.later(function(){h.call(b,c);a=void 0},1E3*b.get("mouseDelay"))};c.on("mouseenter",b.__mouseEnterPopup);b._mouseLeavePopup=function(){a&&(a.cancel(),a=void 0);i.call(b)};c.on("mouseleave",b._mouseLeavePopup)}function i(){var b=this,c=1E3*b.get("mouseDelay");b._hiddenTimer=k.later(function(){d.call(b)},c)}function n(){this._hiddenTimer&&(this._hiddenTimer.cancel(),
this._hiddenTimer=void 0)}function e(){var b=this;b.__clickPopup=function(c){c.preventDefault();b.get("toggle")?(b.get("visible")?d:h).call(b,c):h.call(b,c)};b.get("trigger").on("click",b.__clickPopup)}function h(b){this.set("currentTrigger",k.one(b.target));this.show()}function d(){this.set("currentTrigger",void 0);this.hide()}return g("./control").extend({initializer:function(){this.get("trigger")&&("mouse"===this.get("triggerType")?j.call(this):e.call(this))},bindUI:function(){if(this.get("trigger")&&
"mouse"===this.get("triggerType"))this.$el.on("mouseleave",i,this).on("mouseenter",n,this)},destructor:function(){var b=this.$el,c=this.get("trigger");c&&(this.__clickPopup&&c.detach("click",this.__clickPopup),this.__mouseEnterPopup&&c.detach("mouseenter",this.__mouseEnterPopup),this._mouseLeavePopup&&c.detach("mouseleave",this._mouseLeavePopup));b&&b.detach("mouseleave",i,this).detach("mouseenter",n,this)}},{ATTRS:{trigger:{setter:function(b){return k.all(b)}},triggerType:{value:"click"},currentTrigger:{},
mouseDelay:{value:0.1},toggle:{value:!1}},xclass:"popup"})});KISSY.add("overlay",["overlay/control","overlay/dialog","overlay/popup"],function(k,g){var j=g("overlay/control"),i=g("overlay/dialog"),n=g("overlay/popup");j.Dialog=i;k.Dialog=i;j.Popup=n;return k.Overlay=j});
