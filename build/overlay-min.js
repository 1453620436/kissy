/*
Copyright 2014, KISSY v1.50
MIT Licensed
build time: Mar 24 03:01
*/
KISSY.add("overlay/extension/loading",["node"],function(f,h){function a(){}var e=h("node");a.prototype={loading:function(){this._loadingExtEl||(this._loadingExtEl=(new e('<div class="'+this.get("prefixCls")+'ext-loading" style="position: absolute;border: none;width: 100%;top: 0;left: 0;z-index: 99999;height:100%;*height: expression(this.parentNode.offsetHeight);"/>')).appendTo(this.$el));this._loadingExtEl.show()},unloading:function(){var b=this._loadingExtEl;b&&b.hide()}};return a});
KISSY.add("overlay/extension/mask",["node"],function(f,h){function a(c,b){var a=c.view.getBaseCssClasses("mask"),a=d('<div  style="width:'+(g?"expression(KISSY.DOM.docWidth())":"100%")+";left:0;top:0;height:"+(g?"expression(KISSY.DOM.docHeight())":"100%")+";position:"+(g?"absolute":"fixed")+';" class="'+a+" "+b+'">'+(g?'<iframe style="position:absolute;left:0;top:0;background:red;width: expression(this.parentNode.offsetWidth);height: expression(this.parentNode.offsetHeight);filter:alpha(opacity=0);z-index:-1;"></iframe>':
"")+"</div>").prependTo("body");a.unselectable();a.on("mousedown",function(c){c.preventDefault()});return a}function e(){}function b(c,a){var b=c.get("maskNode"),d=c.view.getBaseCssClasses("mask-hidden");a?b.removeClass(d):b.addClass(d)}function j(c,a,d,g){var p=c.effect||i;b(g,d);if(p!==i){var g=c.duration,c=c.easing,q=d?1:0;a.stop(1,1);a.css("display",d?i:"block");a[p+o[p][q]](g,function(){a.css("display","")},c)}}function c(c){var a=this.get("maskNode");if(c=c.newVal){var b=Number(this.$el.css("z-index"));
isNaN(b)||a.css("z-index",b)}j(this.get("mask"),a,c,this)}var k=f.UA,m=h("node"),g=6===k.ie,d=m.all;e.ATTRS={mask:{value:!1},maskNode:{}};var i="none",o={fade:["Out","In"],slide:["Up","Down"]};e.prototype={__renderUI:function(){this.get("mask")&&this.set("maskNode",a(this,this.get("visible")?"":this.view.getBaseCssClasses("mask-hidden")))},__bindUI:function(){var a,b;if(b=this.get("mask")){a=this.get("maskNode");if(b.closeOnClick)a.on(m.Gesture.tap,this.close,this);this.on("afterVisibleChange",c)}},
__destructor:function(){var c;(c=this.get("maskNode"))&&c.remove()}};return e});
KISSY.add("overlay/overlay-xtpl",[],function(f,h,a,e){f=function(a,e,c,k,h){var g=this,d=g.nativeCommands,i=g.utils;if("1.50"!==e.version)throw Error("current xtemplate file("+g.name+")(v1.50) need to be recompiled using current kissy(v"+e.version+")!");var f=i.callCommand,n=d["if"],e=d.block;c.write("");d={escape:1};i=[];i.push("ks-overlay-closable");d.params=i;d.fn=function(c,a){a.write("\n    ");var b={escape:1},d=[],q=c.resolve(["closable"]);d.push(q);b.params=d;b.fn=function(c,a){a.write('\n        <a href="javascript:void(\'close\')"\n           id="ks-overlay-close-');
var b=c.resolve(["id"]);a.write(b,!0);a.write('"\n           class="');var b={escape:1},d=[];d.push("close");b.params=d;if((b=f(g,c,b,a,"getBaseCssClasses",5))&&b.isBuffer)a=b,b=h;a.write(b,!0);a.write("\"\n           role='button'>\n            <span class=\"");b={escape:1};d=[];d.push("close-x");b.params=d;if((b=f(g,c,b,a,"getBaseCssClasses",7))&&b.isBuffer)a=b,b=h;a.write(b,!0);a.write('">close</span>\n        </a>\n    ');return a};a=n.call(g,c,b,a,2,k);a.write("\n");return a};c=e.call(g,a,d,
c,1,k);c.write('\n\n<div id="ks-content-');d=a.resolve(["id"]);c.write(d,!0);c.write('"\n     class="');d={escape:1};i=[];i.push("content");d.params=i;if((d=f(g,a,d,c,"getBaseCssClasses",13))&&d.isBuffer)c=d,d=h;c.write(d,!0);c.write('">\n    ');d={escape:1};i=[];i.push("ks-overlay-content");d.params=i;d.fn=function(a,c){c.write("\n        ");var b=a.resolve(["content"]);c.write(b,!1);c.write("\n    ");return c};c=e.call(g,a,d,c,14,k);c.write("\n</div>");return c};f.TPL_NAME=e.name;return f});
KISSY.add("overlay/overlay-render",["component/container","./overlay-xtpl","component/extension/content-render"],function(f,h){var a=h("component/container"),e=h("./overlay-xtpl"),b=h("component/extension/content-render");return a.getDefaultRender().extend([b],{createDom:function(){this.fillChildrenElsBySelectors({closeBtn:"#ks-overlay-close-{id}"})}},{ATTRS:{contentTpl:{value:e}},HTML_PARSER:{closeBtn:function(a){return a.one("."+this.getBaseCssClass("close"))}}})});
KISSY.add("overlay/extension/overlay-effect",[],function(f){function h(a){var b=a.$el.clone(!0);b.css({visibility:"visible",overflow:"hidden"}).addClass(a.get("prefixCls")+"overlay-ghost");return a.__afterCreateEffectGhost(b)}function a(a,b,e){a.__effectGhost&&a.__effectGhost.stop(1,1);var g=a.$el,d=f.all,i=a.get("effect"),j=d(i.target),d=i.duration,j=f.mix(j.offset(),{width:j.width(),height:j.height()}),n=f.mix(g.offset(),{width:g.width(),height:g.height()}),l=h(a),i=i.easing;l.insertAfter(g);b?
(b=j,j=n):b=n;g.css("visibility","hidden");l.css(b);a.__effectGhost=l;l.animate(j,{duration:d,easing:i,complete:function(){a.__effectGhost=null;l.remove();g.css("visibility","");e()}})}function e(b,e,h){var g=b.$el,d=b.get("effect"),i=d.effect||"none",f=d.target;"none"===i&&!f?h():f?a(b,e,h):(b=d.duration,d=d.easing,f=e?1:0,g.stop(1,1),g.css({visibility:"visible",display:e?"none":"block"}),g[i+j[i][f]](b,function(){g.css({display:"block",visibility:""});h()},d))}function b(){}var j={fade:["Out","In"],
slide:["Up","Down"]};b.ATTRS={effect:{value:{effect:"",target:null,duration:0.5,easing:"easeOut"},setter:function(a){var b=a.effect;"string"===typeof b&&!j[b]&&(a.effect="")}}};b.prototype={__afterCreateEffectGhost:function(a){return a},_onSetVisible:function(a){var b=this;e(b,a,function(){b.fire(a?"show":"hide")})}};return b});
KISSY.add("overlay/control","component/container,component/extension/shim,component/extension/align,./extension/loading,./extension/mask,./overlay-render,./extension/overlay-effect".split(","),function(f,h){var a=h("component/container"),e=h("component/extension/shim"),b=h("component/extension/align"),j=h("./extension/loading"),c=h("./extension/mask"),k=h("./overlay-render"),m=h("./extension/overlay-effect"),g={hide:"hide",destroy:"destroy"};return a.extend([e,j,b,c,m],{bindUI:function(){var a=this,
b=a.get("closeBtn");if(b)b.on("click",function(b){a.close();b.preventDefault()})},close:function(){this[g[this.get("closeAction")]||"hide"]();return this}},{ATTRS:{contentEl:{},closable:{value:false,view:1},closeBtn:{view:1},closeAction:{value:"hide"},focusable:{value:false},allowTextSelection:{value:true},handleGestureEvents:{value:false},visible:{value:false},xrender:{value:k}},xclass:"overlay"})});
KISSY.add("overlay/dialog-xtpl",["./overlay-xtpl"],function(f,h,a,e){f=function(a,f,c,k,m){var g=this,d,i=g.nativeCommands,o=g.utils;if("1.50"!==f.version)throw Error("current xtemplate file("+g.name+")(v1.50) need to be recompiled using current kissy(v"+f.version+")!");"undefined"!==typeof e&&e.kissy&&(d=e);var n=o.callCommand,l=i.each,f=i.extend,i=i.block;c.write("");var o={},r=[];r.push("./overlay-xtpl");o.params=r;d&&(h("./overlay-xtpl"),o.params[0]=d.resolveByName(o.params[0]));if((d=f.call(g,
a,o,c,1,k))&&d.isBuffer)c=d,d=m;c.write(d,!1);c.write("\n");d={escape:1};f=[];f.push("ks-overlay-content");d.params=f;d.fn=function(a,b){b.write('\n    <div class="');var c={escape:1},d=[];d.push("header");c.params=d;if((c=n(g,a,c,b,"getBaseCssClasses",3))&&c.isBuffer){b=c;c=m}b.write(c,true);b.write('"\n         style="\n');var c={escape:1},d=[],e=a.resolve(["headerStyle"]);d.push(e);c.params=d;c.fn=function(b,a){a.write("\n ");var c=b.resolve(["xindex"]);a.write(c,true);a.write(":");c=b.resolve(["this"]);
a.write(c,true);a.write(";\n");return a};b=l.call(g,a,c,b,5,k);b.write('\n"\n         id="ks-stdmod-header-');c=a.resolve(["id"]);b.write(c,true);b.write('">');c=a.resolve(["headerContent"]);b.write(c,false);b.write('</div>\n\n    <div class="');c={escape:1};d=[];d.push("body");c.params=d;if((c=n(g,a,c,b,"getBaseCssClasses",11))&&c.isBuffer){b=c;c=m}b.write(c,true);b.write('"\n         style="\n');c={escape:1};d=[];e=a.resolve(["bodyStyle"]);d.push(e);c.params=d;c.fn=function(a,b){b.write("\n ");
var c=a.resolve(["xindex"]);b.write(c,true);b.write(":");c=a.resolve(["this"]);b.write(c,true);b.write(";\n");return b};b=l.call(g,a,c,b,13,k);b.write('\n"\n         id="ks-stdmod-body-');c=a.resolve(["id"]);b.write(c,true);b.write('">');c=a.resolve(["bodyContent"]);b.write(c,false);b.write('</div>\n\n    <div class="');c={escape:1};d=[];d.push("footer");c.params=d;if((c=n(g,a,c,b,"getBaseCssClasses",19))&&c.isBuffer){b=c;c=m}b.write(c,true);b.write('"\n         style="\n');c={escape:1};d=[];e=a.resolve(["footerStyle"]);
d.push(e);c.params=d;c.fn=function(b,a){a.write("\n ");var c=b.resolve(["xindex"]);a.write(c,true);a.write(":");c=b.resolve(["this"]);a.write(c,true);a.write(";\n");return a};b=l.call(g,a,c,b,21,k);b.write('\n"\n         id="ks-stdmod-footer-');c=a.resolve(["id"]);b.write(c,true);b.write('">');c=a.resolve(["footerContent"]);b.write(c,false);b.write('</div>\n    <div tabindex="0"></div>\n');return b};return c=i.call(g,a,d,c,2,k)};f.TPL_NAME=e.name;return f});
KISSY.add("overlay/dialog-render",["./overlay-render","./dialog-xtpl"],function(f,h){var a=h("./overlay-render"),e=h("./dialog-xtpl");return a.extend({beforeCreateDom:function(a){f.mix(a.elAttrs,{role:"dialog","aria-labelledby":"ks-stdmod-header-"+this.control.get("id")})},createDom:function(){this.fillChildrenElsBySelectors({header:"#ks-stdmod-header-{id}",body:"#ks-stdmod-body-{id}",footer:"#ks-stdmod-footer-{id}"})},getChildrenContainerEl:function(){return this.control.get("body")},_onSetBodyStyle:function(a){this.control.get("body").css(a)},
_onSetHeaderStyle:function(a){this.control.get("header").css(a)},_onSetFooterStyle:function(a){this.control.get("footer").css(a)},_onSetBodyContent:function(a){var e;e=this.control.get("body");e.html(a)},_onSetHeaderContent:function(a){var e;e=this.control.get("header");e.html(a)},_onSetFooterContent:function(a){var e;e=this.control.get("footer");e.html(a)}},{ATTRS:{contentTpl:{value:e}},HTML_PARSER:{header:function(a){return a.one("."+this.getBaseCssClass("header"))},body:function(a){return a.one("."+
this.getBaseCssClass("body"))},footer:function(a){return a.one("."+this.getBaseCssClass("footer"))},headerContent:function(a){return a.one("."+this.getBaseCssClass("header")).html()},bodyContent:function(a){return a.one("."+this.getBaseCssClass("body")).html()},footerContent:function(a){return(a=a.one("."+this.getBaseCssClass("footer")))&&a.html()}}})});
KISSY.add("overlay/dialog",["./control","./dialog-render","node"],function(f,h){var a=h("./control"),e=h("./dialog-render"),b=h("node"),a=a.extend({__afterCreateEffectGhost:function(a){var b=this.get("body");a.all("."+this.get("prefixCls")+"stdmod-body").css({height:b.height(),width:b.width()}).html("");return a},handleKeyDownInternal:function(a){if(this.get("escapeToClose")&&a.keyCode===b.KeyCode.ESC){if("select"!==a.target.nodeName.toLowerCase()||a.target.disabled)this.close(),a.halt()}else a:if(a.keyCode===
j){var e=this.$el,f=b.all(a.target),g=e.last();if(f.equals(e)&&a.shiftKey)g[0].focus(),a.halt();else if(f.equals(g)&&!a.shiftKey)this.focus(),a.halt();else if(f.equals(e)||e.contains(f))break a;a.halt()}},_onSetVisible:function(a,b){var e=this.el;if(a)this.__lastActive=e.ownerDocument.activeElement,this.focus(),e.setAttribute("aria-hidden","false");else{e.setAttribute("aria-hidden","true");try{this.__lastActive&&this.__lastActive.focus()}catch(f){}}this.callSuper(a,b)}},{ATTRS:{header:{view:1},body:{view:1},
footer:{view:1},bodyStyle:{value:{},view:1},footerStyle:{value:{},view:1},headerStyle:{value:{},view:1},headerContent:{value:"",view:1},bodyContent:{value:"",view:1},footerContent:{value:"",view:1},closable:{value:!0},xrender:{value:e},focusable:{value:!0},escapeToClose:{value:!0}},xclass:"dialog"}),j=b.KeyCode.TAB;return a});
KISSY.add("overlay/popup",["./control"],function(f,h){return h("./control").extend({initializer:function(){var a=this;a.get("trigger")&&("mouse"===a.get("triggerType")?(a._bindTriggerMouse(),a.on("afterRenderUI",function(){a._bindContainerMouse()})):a._bindTriggerClick())},_bindTriggerMouse:function(){var a=this,e=a.get("trigger"),b;a.__mouseEnterPopup=function(e){a._clearHiddenTimer();b=f.later(function(){a._showing(e);b=void 0},1E3*a.get("mouseDelay"))};e.on("mouseenter",a.__mouseEnterPopup);a._mouseLeavePopup=
function(){b&&(b.cancel(),b=void 0);a._setHiddenTimer()};e.on("mouseleave",a._mouseLeavePopup)},_bindContainerMouse:function(){this.$el.on("mouseleave",this._setHiddenTimer,this).on("mouseenter",this._clearHiddenTimer,this)},_setHiddenTimer:function(){var a=this;a._hiddenTimer=f.later(function(){a._hiding()},1E3*a.get("mouseDelay"))},_clearHiddenTimer:function(){this._hiddenTimer&&(this._hiddenTimer.cancel(),this._hiddenTimer=void 0)},_bindTriggerClick:function(){var a=this;a.__clickPopup=function(e){e.preventDefault();
if(a.get("toggle"))a[a.get("visible")?"_hiding":"_showing"](e);else a._showing(e)};a.get("trigger").on("click",a.__clickPopup)},_showing:function(a){this.set("currentTrigger",f.one(a.target));this.show()},_hiding:function(){this.set("currentTrigger",void 0);this.hide()},destructor:function(){var a=this.$el,e=this.get("trigger");e&&(this.__clickPopup&&e.detach("click",this.__clickPopup),this.__mouseEnterPopup&&e.detach("mouseenter",this.__mouseEnterPopup),this._mouseLeavePopup&&e.detach("mouseleave",
this._mouseLeavePopup));a.detach("mouseleave",this._setHiddenTimer,this).detach("mouseenter",this._clearHiddenTimer,this)}},{ATTRS:{trigger:{setter:function(a){return f.all(a)}},triggerType:{value:"click"},currentTrigger:{},mouseDelay:{value:0.1},toggle:{value:!1}},xclass:"popup"})});KISSY.add("overlay",["overlay/control","overlay/dialog","overlay/popup"],function(f,h){var a=h("overlay/control"),e=h("overlay/dialog"),b=h("overlay/popup");a.Dialog=e;f.Dialog=e;a.Popup=b;return f.Overlay=a});
