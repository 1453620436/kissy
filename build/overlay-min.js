/*
Copyright 2014, KISSY v1.50
MIT Licensed
build time: Apr 4 12:24
*/
KISSY.add("overlay/extension/loading",["node"],function(j,g){function i(){}var h=g("node");i.prototype={loading:function(){this._loadingExtEl||(this._loadingExtEl=(new h('<div class="'+this.get("prefixCls")+'ext-loading" style="position: absolute;border: none;width: 100%;top: 0;left: 0;z-index: 99999;height:100%;*height: expression(this.parentNode.offsetHeight);"/>')).appendTo(this.$el));this._loadingExtEl.show()},unloading:function(){this._loadingExtEl&&this._loadingExtEl.hide()}};return i});
KISSY.add("overlay/extension/mask",["ua","node"],function(j,g){function i(d,f){var a=d.view.getBaseCssClasses("mask"),a=b('<div  style="width:'+(c?"expression(KISSY.DOM.docWidth())":"100%")+";left:0;top:0;height:"+(c?"expression(KISSY.DOM.docHeight())":"100%")+";position:"+(c?"absolute":"fixed")+';" class="'+a+" "+f+'">'+(c?'<iframe style="position:absolute;left:0;top:0;background:red;width: expression(this.parentNode.offsetWidth);height: expression(this.parentNode.offsetHeight);filter:alpha(opacity=0);z-index:-1;"></iframe>':
"")+"</div>").prependTo("body");a.unselectable();a.on("mousedown",function(d){d.preventDefault()});return a}function h(){}function a(d,f){var a=d.get("maskNode"),b=d.view.getBaseCssClasses("mask-hidden");f?a.removeClass(b):a.addClass(b)}function e(d,f,b,c){var n=d.effect||m;a(c,b);if(n!==m){var c=d.duration,d=d.easing,e=b?1:0;f.stop(1,1);f.css("display",b?m:"block");f[n+q[n][e]](c,function(){f.css("display","")},d)}}function f(d){var f=this.get("maskNode");if(d=d.newVal){var a=Number(this.$el.css("z-index"));
isNaN(a)||f.css("z-index",a)}e(this.get("mask"),f,d,this)}var k=g("ua"),d=g("node"),c=6===k.ie,b=d.all;h.ATTRS={mask:{value:!1},maskNode:{}};var m="none",q={fade:["Out","In"],slide:["Up","Down"]};h.prototype={__renderUI:function(){this.get("mask")&&this.set("maskNode",i(this,this.get("visible")?"":this.view.getBaseCssClasses("mask-hidden")))},__bindUI:function(){var a,b;if(b=this.get("mask")){a=this.get("maskNode");if(b.closeOnClick)a.on(d.Gesture.tap,this.close,this);this.on("afterVisibleChange",
f)}},__destructor:function(){var d;(d=this.get("maskNode"))&&d.remove()}};return h});
KISSY.add("overlay/overlay-xtpl",[],function(j,g,i,h){g=function(a,e,f,k){var d=this,c=d.nativeCommands,b=d.utils;if("1.50"!==j.version)throw Error("current xtemplate file("+d.name+")(v1.50) need to be recompiled using current kissy(v"+j.version+")!");var g=b.callCommand,i=c["if"],c=c.block;e.write("");var b={escape:1},h=[];h.push("ks-overlay-closable");b.params=h;b.fn=function(a,b){b.write("\n    ");var c={escape:1},n=[],e=a.resolve(["closable"]);n.push(e);c.params=n;c.fn=function(a,f){f.write('\n        <a href="javascript:void(\'close\')"\n           id="ks-overlay-close-');
var b=a.resolve(["id"]);f.write(b,!0);f.write('"\n           class="');var b={escape:1},c=[];c.push("close");b.params=c;if((b=g(d,a,b,f,"getBaseCssClasses",5))&&b.isBuffer)f=b,b=k;f.write(b,!0);f.write("\"\n           role='button'>\n            <span class=\"");b={escape:1};c=[];c.push("close-x");b.params=c;if((b=g(d,a,b,f,"getBaseCssClasses",7))&&b.isBuffer)f=b,b=k;f.write(b,!0);f.write('">close</span>\n        </a>\n    ');return f};b=i.call(d,a,c,b,2,f);b.write("\n");return b};e=c.call(d,a,b,
e,1,f);e.write('\n\n<div id="ks-content-');b=a.resolve(["id"]);e.write(b,!0);e.write('"\n     class="');b={escape:1};h=[];h.push("content");b.params=h;if((b=g(d,a,b,e,"getBaseCssClasses",13))&&b.isBuffer)e=b,b=k;e.write(b,!0);e.write('">\n    ');b={escape:1};h=[];h.push("ks-overlay-content");b.params=h;b.fn=function(d,b){b.write("\n        ");var f=d.resolve(["content"]);b.write(f,!1);b.write("\n    ");return b};e=c.call(d,a,b,e,14,f);e.write("\n</div>");return e};g.TPL_NAME=h.name;return g});
KISSY.add("overlay/overlay-render",["component/container","./overlay-xtpl","component/extension/content-render"],function(j,g){var i=g("component/container"),h=g("./overlay-xtpl"),a=g("component/extension/content-render");return i.getDefaultRender().extend([a],{createDom:function(){this.fillChildrenElsBySelectors({closeBtn:"#ks-overlay-close-{id}"})}},{ATTRS:{contentTpl:{value:h}},HTML_PARSER:{closeBtn:function(a){return a.one("."+this.getBaseCssClass("close"))}}})});
KISSY.add("overlay/extension/overlay-effect",[],function(j){function g(f){var a=f.$el.clone(!0);a.css({visibility:"visible",overflow:"hidden"}).addClass(f.get("prefixCls")+"overlay-ghost");return f.__afterCreateEffectGhost(a)}function i(f,a,d){f.__effectGhost&&f.__effectGhost.stop(1,1);var c=f.$el,b=j.all,e=f.get("effect"),h=b(e.target),b=e.duration,i=j.mix(h.offset(),{width:h.width(),height:h.height()}),o=j.mix(c.offset(),{width:c.width(),height:c.height()}),p=g(f),h=e.easing;p.insertAfter(c);a?
(a=i,i=o):a=o;c.css("visibility","hidden");p.css(a);f.__effectGhost=p;p.animate(i,{Anim:e.Anim,duration:b,easing:h,complete:function(){f.__effectGhost=null;p.remove();c.css("visibility","");d()}})}function h(f,a,d){var c=f.$el,b=f.get("effect"),h=b.effect||"none",g=b.target;if("none"===h&&!g)d();else if(g)i(f,a,d);else{var f=b.duration,g=b.easing,j=a?1:0;c.stop(1,1);c.css({visibility:"visible",display:a?"none":"block"});c[h+e[h][j]]({duration:f,Anim:b.Anim,complete:function(){c.css({display:"block",
visibility:""});d()},easing:g})}}function a(){}var e={fade:["Out","In"],slide:["Up","Down"]};a.ATTRS={effect:{value:{effect:"",target:null,duration:0.5,easing:"easeOut"},setter:function(a){var g=a.effect;"string"===typeof g&&!e[g]&&(a.effect="")}}};a.prototype={__afterCreateEffectGhost:function(a){return a},_onSetVisible:function(a){var e=this;h(e,a,function(){e.fire(a?"show":"hide")})}};return a});
KISSY.add("overlay/control","component/container,component/extension/shim,component/extension/align,./extension/loading,./extension/mask,./overlay-render,./extension/overlay-effect".split(","),function(j,g){var i=g("component/container"),h=g("component/extension/shim"),a=g("component/extension/align"),e=g("./extension/loading"),f=g("./extension/mask"),k=g("./overlay-render"),d=g("./extension/overlay-effect"),c={hide:"hide",destroy:"destroy"};return i.extend([h,e,a,f,d],{bindUI:function(){var a=this,
d=a.get("closeBtn");if(d)d.on("click",function(d){a.close();d.preventDefault()})},close:function(){this[c[this.get("closeAction")]||"hide"]();return this}},{ATTRS:{contentEl:{},closable:{value:false,view:1},closeBtn:{view:1},closeAction:{value:"hide"},focusable:{value:false},allowTextSelection:{value:true},handleGestureEvents:{value:false},visible:{value:false},xrender:{value:k}},xclass:"overlay"})});
KISSY.add("overlay/dialog-xtpl",["./overlay-xtpl"],function(j,g,i,h){i=function(a,e,f,i){var d=this,c=d.nativeCommands,b=d.utils;if("1.50"!==j.version)throw Error("current xtemplate file("+d.name+")(v1.50) need to be recompiled using current kissy(v"+j.version+")!");var m=b.callCommand,q=c.each,b=c.extend,c=c.block;e.write("");var l={},o=[];o.push("./overlay-xtpl");l.params=o;g("./overlay-xtpl");l.params[0]=h.resolve(l.params[0]);if((b=b.call(d,a,l,e,1,f))&&b.isBuffer)e=b,b=i;e.write(b,!1);e.write("\n");
b={escape:1};l=[];l.push("ks-overlay-content");b.params=l;b.fn=function(a,b){b.write('\n    <div class="');var c={escape:1},e=[];e.push("header");c.params=e;if((c=m(d,a,c,b,"getBaseCssClasses",3))&&c.isBuffer)b=c,c=i;b.write(c,!0);b.write('"\n         style="\n');var c={escape:1},e=[],g=a.resolve(["headerStyle"]);e.push(g);c.params=e;c.fn=function(b,a){a.write("\n ");var c=b.resolve(["xindex"]);a.write(c,!0);a.write(":");c=b.resolve(["this"]);a.write(c,!0);a.write(";\n");return a};b=q.call(d,a,c,
b,5,f);b.write('\n"\n         id="ks-stdmod-header-');c=a.resolve(["id"]);b.write(c,!0);b.write('">');c=a.resolve(["headerContent"]);b.write(c,!1);b.write('</div>\n\n    <div class="');c={escape:1};e=[];e.push("body");c.params=e;if((c=m(d,a,c,b,"getBaseCssClasses",11))&&c.isBuffer)b=c,c=i;b.write(c,!0);b.write('"\n         style="\n');c={escape:1};e=[];g=a.resolve(["bodyStyle"]);e.push(g);c.params=e;c.fn=function(b,a){a.write("\n ");var c=b.resolve(["xindex"]);a.write(c,!0);a.write(":");c=b.resolve(["this"]);
a.write(c,!0);a.write(";\n");return a};b=q.call(d,a,c,b,13,f);b.write('\n"\n         id="ks-stdmod-body-');c=a.resolve(["id"]);b.write(c,!0);b.write('">');c=a.resolve(["bodyContent"]);b.write(c,!1);b.write('</div>\n\n    <div class="');c={escape:1};e=[];e.push("footer");c.params=e;if((c=m(d,a,c,b,"getBaseCssClasses",19))&&c.isBuffer)b=c,c=i;b.write(c,!0);b.write('"\n         style="\n');c={escape:1};e=[];g=a.resolve(["footerStyle"]);e.push(g);c.params=e;c.fn=function(a,b){b.write("\n ");var c=a.resolve(["xindex"]);
b.write(c,!0);b.write(":");c=a.resolve(["this"]);b.write(c,!0);b.write(";\n");return b};b=q.call(d,a,c,b,21,f);b.write('\n"\n         id="ks-stdmod-footer-');c=a.resolve(["id"]);b.write(c,!0);b.write('">');c=a.resolve(["footerContent"]);b.write(c,!1);b.write('</div>\n    <div tabindex="0"></div>\n');return b};return e=c.call(d,a,b,e,2,f)};i.TPL_NAME=h.name;return i});
KISSY.add("overlay/dialog-render",["./overlay-render","./dialog-xtpl"],function(j,g){var i=g("./overlay-render"),h=g("./dialog-xtpl");return i.extend({beforeCreateDom:function(a){j.mix(a.elAttrs,{role:"dialog","aria-labelledby":"ks-stdmod-header-"+this.control.get("id")})},createDom:function(){this.fillChildrenElsBySelectors({header:"#ks-stdmod-header-{id}",body:"#ks-stdmod-body-{id}",footer:"#ks-stdmod-footer-{id}"})},getChildrenContainerEl:function(){return this.control.get("body")},_onSetBodyStyle:function(a){this.control.get("body").css(a)},
_onSetHeaderStyle:function(a){this.control.get("header").css(a)},_onSetFooterStyle:function(a){this.control.get("footer").css(a)},_onSetBodyContent:function(a){var e;e=this.control.get("body");e.html(a)},_onSetHeaderContent:function(a){var e;e=this.control.get("header");e.html(a)},_onSetFooterContent:function(a){var e;e=this.control.get("footer");e.html(a)}},{ATTRS:{contentTpl:{value:h}},HTML_PARSER:{header:function(a){return a.one("."+this.getBaseCssClass("header"))},body:function(a){return a.one("."+
this.getBaseCssClass("body"))},footer:function(a){return a.one("."+this.getBaseCssClass("footer"))},headerContent:function(a){return a.one("."+this.getBaseCssClass("header")).html()},bodyContent:function(a){return a.one("."+this.getBaseCssClass("body")).html()},footerContent:function(a){return(a=a.one("."+this.getBaseCssClass("footer")))&&a.html()}}})});
KISSY.add("overlay/dialog",["./control","./dialog-render","node"],function(j,g){var i=g("./control"),h=g("./dialog-render"),a=g("node"),i=i.extend({__afterCreateEffectGhost:function(a){var e=this.get("body");a.all("."+this.get("prefixCls")+"stdmod-body").css({height:e.height(),width:e.width()}).html("");return a},handleKeyDownInternal:function(f){if(this.get("escapeToClose")&&f.keyCode===a.KeyCode.ESC){if("select"!==f.target.nodeName.toLowerCase()||f.target.disabled)this.close(),f.halt()}else a:if(f.keyCode===
e){var g=this.$el,d=a.all(f.target),c=g.last();if(d.equals(g)&&f.shiftKey)c[0].focus(),f.halt();else if(d.equals(c)&&!f.shiftKey)this.focus(),f.halt();else if(d.equals(g)||g.contains(d))break a;f.halt()}},_onSetVisible:function(a,e){var d=this.el;if(a)this.__lastActive=d.ownerDocument.activeElement,this.focus(),d.setAttribute("aria-hidden","false");else{d.setAttribute("aria-hidden","true");try{this.__lastActive&&this.__lastActive.focus()}catch(c){}}this.callSuper(a,e)}},{ATTRS:{header:{view:1},body:{view:1},
footer:{view:1},bodyStyle:{value:{},view:1},footerStyle:{value:{},view:1},headerStyle:{value:{},view:1},headerContent:{value:"",view:1},bodyContent:{value:"",view:1},footerContent:{value:"",view:1},closable:{value:!0},xrender:{value:h},focusable:{value:!0},escapeToClose:{value:!0}},xclass:"dialog"}),e=a.KeyCode.TAB;return i});
KISSY.add("overlay/popup",["./control"],function(j,g){function i(){var d=this,c=d.get("trigger"),b;d.__mouseEnterPopup=function(c){a.call(d);b=j.later(function(){f.call(d,c);b=void 0},1E3*d.get("mouseDelay"))};c.on("mouseenter",d.__mouseEnterPopup);d._mouseLeavePopup=function(){b&&(b.cancel(),b=void 0);h.call(d)};c.on("mouseleave",d._mouseLeavePopup)}function h(){var a=this;a._hiddenTimer=j.later(function(){k.call(a)},1E3*a.get("mouseDelay"))}function a(){this._hiddenTimer&&(this._hiddenTimer.cancel(),
this._hiddenTimer=void 0)}function e(){var a=this;a.__clickPopup=function(c){c.preventDefault();a.get("toggle")?(a.get("visible")?k:f).call(a,c):f.call(a,c)};a.get("trigger").on("click",a.__clickPopup)}function f(a){this.set("currentTrigger",j.one(a.target));this.show()}function k(){this.set("currentTrigger",void 0);this.hide()}return g("./control").extend({initializer:function(){this.get("trigger")&&("mouse"===this.get("triggerType")?i.call(this):e.call(this))},bindUI:function(){if(this.get("trigger")&&
"mouse"===this.get("triggerType"))this.$el.on("mouseleave",h,this).on("mouseenter",a,this)},destructor:function(){var d=this.$el,c=this.get("trigger");c&&(this.__clickPopup&&c.detach("click",this.__clickPopup),this.__mouseEnterPopup&&c.detach("mouseenter",this.__mouseEnterPopup),this._mouseLeavePopup&&c.detach("mouseleave",this._mouseLeavePopup));d&&d.detach("mouseleave",h,this).detach("mouseenter",a,this)}},{ATTRS:{trigger:{setter:function(a){return j.all(a)}},triggerType:{value:"click"},currentTrigger:{},
mouseDelay:{value:0.1},toggle:{value:!1}},xclass:"popup"})});KISSY.add("overlay",["overlay/control","overlay/dialog","overlay/popup"],function(j,g){var i=g("overlay/control"),h=g("overlay/dialog"),a=g("overlay/popup");i.Dialog=h;j.Dialog=h;i.Popup=a;return j.Overlay=i});
