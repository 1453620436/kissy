/*
Copyright 2014, KISSY v1.50
MIT Licensed
build time: Feb 27 13:01
*/
KISSY.add("navigation-view/bar/bar-xtpl",[],function(){var k=function(g,a,d){var l=this,e=a.escapeHtml,m=l.utils.callCommand,j=l.nativeCommands["if"],a="",n={},k=[],p=g.resolve(["withTitle"]);k.push(p);n.params=k;n.fn=function(a){var b;b='\r\n<div class="';var c={},o=[];o.push("title-wrap");c.params=o;c=m(l,a,c,"getBaseCssClasses",2);b+=e(c);b+='">\r\n    <div class="';c={};o=[];o.push("title");c.params=o;c=m(l,a,c,"getBaseCssClasses",3);b+=e(c);b+='" id="ks-navigation-bar-title-';c=a.resolve(["id"]);
b+=e(c);b+='">';a=a.resolve(["title"]);b+=e(a);return b+"</div>\r\n</div>\r\n"};a+=j.call(l,g,n,d);a+='\r\n<div class="';d={};j=[];j.push("content");d.params=j;d=m(l,g,d,"getBaseCssClasses",6);a+=e(d);a+='" id="ks-navigation-bar-content-';d=g.resolve(["id"]);a+=e(d);a+='">\r\n    <div class="';d={};j=[];j.push("center");d.params=j;d=m(l,g,d,"getBaseCssClasses",7);a+=e(d);a+='" id="ks-navigation-bar-center-';g=g.resolve(["id"]);a+=e(g);return a+'"></div>\r\n</div>'};k.TPL_NAME="navigation-view/sub-modules/bar/src/bar/bar.xtpl.html";
return k});
KISSY.add("navigation-view/bar/bar-render",["./bar-xtpl","component/control"],function(k,g){var a=g("./bar-xtpl");return g("component/control").getDefaultRender().extend({createDom:function(){var a={centerEl:"#ks-navigation-bar-center-{id}",contentEl:"#ks-navigation-bar-content-{id}"};this.control._withTitle&&(a.titleEl="#ks-navigation-bar-title-{id}");this.fillChildrenElsBySelectors(a)},_onSetTitle:function(a){this.control._withTitle&&this.control.get("titleEl").html(a)},_onSetBackText:function(a){this.control._backBtn&&this.control._backBtn.set("content",
a)}},{ATTRS:{contentTpl:{value:a}}})});
KISSY.add("navigation-view/bar",["component/control","./bar/bar-render","button"],function(k,g){function a(b){var c;c=b.clone(!0);c[0].id=b[0].id+"-proxy";b.parent().append(c);var a=b.offset();c.css("position","absolute");c.offset(a);c.css({width:b.css("width"),height:b.css("height")});return c}function d(b,c,a){b.animate(c,{duration:0.25,useTransition:!0,easing:"ease-in-out",complete:a})}function l(b,c,a,h){var f=b.get("el"),d=b.get("titleEl"),b=Math.min(f[0].offsetWidth/3,200),g=c[0].offsetWidth,
c=f[0].offsetWidth,f=d.offset().left-f.offset().left,d=d[0].offsetWidth,i=a.width,e;h?(a=-i,i=Math.min(f-i,b)):(i=-i,a=Math.min(f,b));b={element:{from:{transform:"translateX("+a+"px) translateZ(0)"},to:{transform:"translateX(0) translateZ(0)",opacity:1}},ghost:{to:{transform:"translateX("+i+"px) translateZ(0)",opacity:0}}};g=-f+g;d>f&&(e=-f-d);h?(i=c-f-d,a=void 0!==e?e:g):(i=void 0!==e?e:g,a=Math.max(0,c-f-d));return{back:b,title:{element:{from:{transform:"translateX("+a+"px) translateZ(0)"},to:{transform:"translateX(0) translateZ(0)",
opacity:1}},ghost:{to:{transform:"translateX("+i+"px) translateZ(0)",opacity:0}}}}}function e(){this.fire("backward")}function m(){this.get("navigationView").pop()}function j(b){this.set("title",b.newView.get("title")||"")}function n(b){var a=b.newView,d=b.backward;if(b.oldView)this[d?"backward":"forward"](a.get("title")||"")}var r=g("component/control"),p=g("./bar/bar-render"),q=g("button");return r.extend({initializer:function(){this._withTitle=this.get("withTitle");this._stack=[];this.publish("backward",
{defaultFn:m,defaultTargetOnly:!0})},renderUI:function(){var b=this.get("prefixCls");this._buttons={};this.get("withBackButton")&&(this._backBtn=(new q({prefixCls:b+"navigation-bar-",elCls:b+"navigation-bar-backward",elBefore:this.get("contentEl")[0].firstChild,visible:!1,content:this.get("backText")})).render())},bindUI:function(){if(this._backBtn)this._backBtn.on("click",e,this);var b=this.get("navigationView");b.on("afterInnerViewChange",j,this);b.on("beforeInnerViewChange",n,this)},addButton:function(b,
a){var d=this.get("prefixCls");a.prefixCls=d+"navigation-bar-";!a.elBefore&&!a.render&&(d=a.align=a.align||"left","left"===d?a.elBefore=this.get("centerEl"):"right"===d&&(a.render=this.get("contentEl")),delete a.align);this._buttons[b]=(new q(a)).render();return this._buttons[b]},insertButtonBefore:function(a,c,d){c.elBefore=d.get("el");return this.addButton(a,c)},removeButton:function(a){this._buttons[a].destroy();delete this._buttons[a]},getButton:function(a){return this._buttons[a]},forward:function(a){this._stack.push(a);
this.go(a,!0)},go:function(b,c,g){var h=this,f=h._backBtn;if(!f||!h._withTitle){if(h._withTitle&&h.get("titleEl").html(b),f)f[c?"show":"hide"]()}else{var e=f.get("el");e.stop(!0);h.ghostBackEl&&h.ghostBackEl.stop(!0);var j={width:e[0].offsetWidth},i=a(e);h.ghostBackEl=i;e.css("opacity",0);f[c?"show":"hide"]();h.ghostBackEl&&h.ghostBackEl.stop(!0);c=l(h,e,j,g);e.css(c.back.element.from);f.get("visible")&&d(e,c.back.element.to);"none"!==i.css("display")?d(i,c.back.ghost.to,function(){i.remove();h.ghostBackEl=
null}):(i.remove(),h.ghostBackEl=null);f=h.get("titleEl");f.stop(!0);var k=a(f.parent());h.ghostTitleEl=k;f.css("opacity",0);h.set("title",b);f.css(c.title.element.from);d(f,c.title.element.to);d(k,c.title.ghost.to,function(){k.remove();h.ghostTitleEl=null})}},backward:function(a){this._stack.length&&(this._stack.pop(),this.go(a,this._stack.length,!0))}},{xclass:"navigation-bar",ATTRS:{handleGestureEvents:{value:!1},focusable:{value:!1},xrender:{value:p},centerEl:{},contentEl:{},titleEl:{},title:{value:"",
view:1},withBackButton:{value:1},withTitle:{value:1,view:1},backText:{value:"Back",view:1}}})});
