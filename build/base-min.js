/*
Copyright 2013, KISSY v1.50dev
MIT Licensed
build time: Nov 19 01:54
*/
KISSY.add("base",["attribute","event/custom"],function(f){function i(a,b){return function(c){return function(){b?c.apply(this,arguments):this.callSuper.apply(this,arguments);var d=arguments.callee.__owner__.__extensions__||[];b&&d.reverse();var e=arguments,g;if(g=d&&d.length)for(var h=0;h<g;h++){var f=d[h]&&(!a?d[h]:d[h].prototype[a]);f&&f.apply(this,e||[])}b?this.callSuper.apply(this,arguments):c.apply(this,arguments)}}}function k(a){var b=this.constructor;for(this.userConfig=a;b;){var c=b[l];if(c){var d=
void 0;for(d in c)this.addAttr(d,c[d],!1)}b=b.superclass?b.superclass.constructor:null}if(a)for(var e in a)this.setInternal(e,a[e]);var a=this.get("listeners"),g;for(g in a)this.on(g,a[g]);this.initializer();s(this);m.call(this,"pluginInitializer");this.bindInternal();this.syncInternal()}function t(a){p(a,this,this.__hooks__||{});f.mix(this.prototype,a)}function u(a){var b;a.target==this&&(b=this[n+a.type.slice(5).slice(0,-6)],b.call(this,a.newVal,a))}function s(a){var b=a.get("plugins");f.each(b,
function(a,d){"function"===typeof a&&(b[d]=new a)})}function q(a){return function(){return a.apply(this,arguments)}}function p(a,b,c){if(b.__extensions__.length)for(d in c)a[d]=a[d]||r;for(var d in c)d in a&&(a[d]=c[d](a[d]));f.each(a,function(e,c){if("function"==typeof e){var d=0;if(e.__owner__){var f=e.__owner__;delete e.__owner__;delete e.__name__;var d=e.__wrapped__=1,j=q(e);j.__owner__=f;j.__name__=c;f.prototype[c]=j}else e.__wrapped__&&(d=1);d&&(a[c]=e=q(e));e.__owner__=b;e.__name__=c}})}function m(a){var b,
c=this.get("plugins");if(b=c.length)for(var d=0;d<b;d++)c[d][a]&&c[d][a](this)}var v=this.require("attribute"),w=this.require("event/custom");this.exports=k;var l="ATTRS",o=f.ucfirst,n="_onSet",r=f.noop;f.augment(k,v,w.Target,{initializer:r,__getHook:i,__callPluginsMethod:m,callSuper:function(){var a,b,c=arguments;"function"==typeof this&&this.__name__?(a=this,b=c[0],c=Array.prototype.slice.call(c,1)):(a=arguments.callee.caller,a.__wrapped__&&(a=a.caller),b=this);var d=a.__name__;if(d)return a=a.__owner__.superclass[d],
!a?void 0:a.apply(b,c||[])},bindInternal:function(){var a=this.getAttrs(),b,c;for(b in a)if(c=n+o(b),this[c])this.on("after"+o(b)+"Change",u)},syncInternal:function(){var a=[],b;b=this.constructor;for(var c=this.getAttrs();b;)a.push(b),b=b.superclass&&b.superclass.constructor;a.reverse();for(b=0;b<a.length;b++){var d=a[b].ATTRS||{},e;for(e in d)if(e in c){var g,f;(f=this[n+o(e)])&&0!==c[e].sync&&void 0!==(g=this.get(e))&&f.call(this,g)}}},plug:function(a){"function"===typeof a&&(a=new a);a.pluginInitializer&&
a.pluginInitializer(this);this.get("plugins").push(a);return this},unplug:function(a){var b=[],c=this,d="string"==typeof a;f.each(c.get("plugins"),function(e){var f=0,h;a&&(d?(h=e.get&&e.get("pluginId")||e.pluginId,h!=a&&(b.push(e),f=1)):e!=a&&(b.push(e),f=1));f||e.pluginDestructor(c)});c.setInternal("plugins",b);return c},getPlugin:function(a){var b=null;f.each(this.get("plugins"),function(c){if((c.get&&c.get("pluginId")||c.pluginId)==a)return b=c,!1});return b},destructor:f.noop,destroy:function(){this.get("destroyed")||
(m.call(this,"pluginDestructor"),this.destructor(),this.set("destroyed",!0),this.fire("destroy"),this.detach())}});f.mix(k,{__hooks__:{initializer:i(),destructor:i("__destructor",!0)},ATTRS:{plugins:{value:[]},destroyed:{value:!1},listeners:{value:[]}},extend:function b(c,d,e){var g;f.isArray(c)||(e=d,d=c,c=[]);e=e||{};d=f.merge(d);g=d.hasOwnProperty("constructor")?d.constructor:function(){this.callSuper.apply(this,arguments)};d.constructor=g;var h=this.__hooks__;h&&(e.__hooks__=f.merge(h,e.__hooks__));
g.__extensions__=c;p(d,g,e.__hooks__||{});h=this.prototype;h=h.__inheritedStatics__=h.__inheritedStatics__||e.inheritedStatics;e.inheritedStatics&&h!==e.inheritedStatics&&f.mix(h,e.inheritedStatics);h&&f.mix(g,h);delete e.inheritedStatics;f.extend(g,this,d,e);if(c.length){var i={},j={};f.each(c.concat(g),function(b){if(b){f.each(b[l],function(b,c){var d=i[c]=i[c]||{};f.mix(d,b)});var b=b.prototype,c;for(c in b)b.hasOwnProperty(c)&&(j[c]=b[c])}});g[l]=i;j.constructor=g;f.augment(g,j)}g.extend=g.extend||
b;g.addMembers=t;return g}})});
