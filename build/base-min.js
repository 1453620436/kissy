/*
Copyright 2013, KISSY v1.40dev
MIT Licensed
build time: Sep 11 12:42
*/
KISSY.add("base/attribute",function(h,w,j){function k(a,c){return"string"==typeof c?a[c]:c}function u(a,c,g,b,m,e,d,f){d=d||g;return a.fire(c+h.ucfirst(g)+"Change",h.mix({attrName:d,subAttrName:e,prevVal:b,newVal:m},f))}function n(a,c,g){var b=a[c];!g&&!b&&(a[c]=b={});return b||{}}function i(a){return n(a,"__attrs")}function l(a){return n(a,"__attrVals")}function v(a,c){for(var g=0,b=c.length;a!=j&&g<b;g++)a=a[c[g]];return a}function q(a){var c;-1!==a.indexOf(".")&&(c=a.split("."),a=c.shift());return{path:c,
name:a}}function r(a,c,g){var b=g;if(c){var a=b=a===j?{}:h.clone(a),m=c.length-1;if(0<=m){for(var d=0;d<m;d++)a=a[c[d]];a!=j&&(a[c[d]]=g)}}return b}function s(a,c,g,b,m){var e,f,i;e=q(c);var k=c,c=e.name;e=e.path;i=a.get(c);var o=c,l=n(a,"__defaultBeforeFns");l[o]||(l[o]=1,o="before"+h.ucfirst(o)+"Change",a.publish(o,{defaultFn:t}));e&&(f=v(i,e));if(!b.force&&(!e&&i===g||e&&f===g))return j;g=r(i,e,g);g=h.mix({attrName:c,subAttrName:k,prevVal:i,newVal:g,_opts:b,_attrs:m,target:a},b.data);if(b.silent){if(d===
t.call(a,g))return d}else if(d===a.fire("before"+h.ucfirst(c)+"Change",g))return d;return a}function t(a){if(a.target!==this)return j;var c=a.newVal,g=a.prevVal,b=a.attrName,e=a.subAttrName,f=a._attrs,a=a._opts,c=this.setInternal(b,c);if(c===d)return c;a.silent||(c=l(this)[b],u(this,"after",b,g,c,e,null,a.data),f?f.push({prevVal:g,newVal:c,attrName:b,subAttrName:e}):u(this,"","*",[g],[c],[e],[b],a.data));return j}function p(){}function b(a,c){var b=i(a),e=n(b,c,1),d=e.valueFn;if(d&&(d=k(a,d)))d=d.call(a),
d!==j&&(e.value=d),delete e.valueFn,b[c]=e;return e.value}function e(a,c,b,e){var d,f;d=q(c);c=d.name;if(d=d.path)f=a.get(c),b=r(f,d,b);if((d=n(i(a),c).validator)&&(d=k(a,d)))if(a=d.call(a,b,c,e),a!==j&&!0!==a)return a;return j}p.INVALID={};var f=p.INVALID,d=!1;h.augment(p,w.Target,{getAttrs:function(){return i(this)},getAttrVals:function(){var a={},c,b=i(this);for(c in b)a[c]=this.get(c);return a},addAttr:function(a,c,b){var d=i(this),e,c=h.clone(c);(e=d[a])?h.mix(e,c,b):d[a]=c;return this},addAttrs:function(a,
c){var b=this;h.each(a,function(a,c){b.addAttr(c,a)});c&&b.set(c);return b},hasAttr:function(a){return i(this).hasOwnProperty(a)},removeAttr:function(a){this.hasAttr(a)&&(delete i(this)[a],delete l(this)[a]);return this},set:function(a,c,b){if(h.isPlainObject(a)){var b=c||{},c=Object(a),f=[],m,i=[];for(a in c)(m=e(this,a,c[a],c))!==j&&i.push(m);if(i.length)return b.error&&b.error(i),d;for(a in c)s(this,a,c[a],b,f);var k=[],l=[],n=[],o=[];h.each(f,function(a){l.push(a.prevVal);n.push(a.newVal);k.push(a.attrName);
o.push(a.subAttrName)});k.length&&u(this,"","*",l,n,o,k,b.data);return this}b=b||{};m=e(this,a,c);return m!==j?(b.error&&b.error(m),d):s(this,a,c,b)},setInternal:function(a,b){var e=j,h=n(i(this),a).setter;if(h&&(h=k(this,h)))e=h.call(this,b,a);if(e===f)return d;e!==j&&(b=e);l(this)[a]=b;return j},get:function(a){var c,e=l(this),d,f;-1!==a.indexOf(".")&&(c=a.split("."),a=c.shift());d=n(i(this),a,1).getter;f=a in e?e[a]:b(this,a);if(d&&(d=k(this,d)))f=d.call(this,f,a);!(a in e)&&f!==j&&(e[a]=f);c&&
(f=v(f,c));return f},reset:function(a,c){if("string"==typeof a)return this.hasAttr(a)?this.set(a,b(this,a),c):this;var c=a,e=i(this),d={};for(a in e)d[a]=b(this,a);this.set(d,c);return this}});return p},{requires:["event/custom"]});
KISSY.add("base",function(h,w){function j(b,e){return function(f){return function(){e?f.apply(this,arguments):this.callSuper.apply(this,arguments);var d=arguments.callee.__owner__.__extensions__||[];e&&d.reverse();var a=arguments,c;if(c=d&&d.length)for(var g=0;g<c;g++){var h=d[g]&&(!b?d[g]:d[g].prototype[b]);h&&h.apply(this,a||[])}e?this.callSuper.apply(this,arguments):f.apply(this,arguments)}}}function k(b){var e=this.constructor;for(this.userConfig=b;e;){var f=e[r];if(f){var d=void 0;for(d in f)this.addAttr(d,
f[d],!1)}e=e.superclass?e.superclass.constructor:null}if(b)for(var a in b)this.setInternal(a,b[a]);var b=this.get("listeners"),c;for(c in b)this.on(c,b[c]);this.initializer();i(this);q.call(this,"pluginInitializer");this.bindInternal();this.syncInternal()}function u(b){v(b,this,this.__hooks__||{});h.mix(this.prototype,b)}function n(b){var e;b.target==this&&(e=this[t+b.type.slice(5).slice(0,-6)],e.call(this,b.newVal,b))}function i(b){var e=b.get("plugins");h.each(e,function(b,d){"function"===typeof b&&
(e[d]=new b)})}function l(b){return function(){return b.apply(this,arguments)}}function v(b,e,f){if(e.__extensions__.length)for(d in f)b[d]=b[d]||p;for(var d in f)d in b&&(b[d]=f[d](b[d]));h.each(b,function(a,c){if("function"==typeof a){var d=0;if(a.__owner__){var f=a.__owner__;delete a.__owner__;delete a.__name__;var d=a.__wrapped__=1,h=l(a);h.__owner__=f;h.__name__=c;f.prototype[c]=h}else a.__wrapped__&&(d=1);d&&(b[c]=a=l(a));a.__owner__=e;a.__name__=c}})}function q(b){var e,f=this.get("plugins");
if(e=f.length)for(var d=0;d<e;d++)f[d][b]&&f[d][b](this)}var r="ATTRS",s=h.ucfirst,t="_onSet",p=h.noop;h.augment(k,w,{initializer:p,__getHook:j,__callPluginsMethod:q,callSuper:function(){var b,e,f=arguments;"function"==typeof this&&this.__name__?(b=this,e=f[0],f=Array.prototype.slice.call(f,1)):(b=arguments.callee.caller,b.__wrapped__&&(b=b.caller),e=this);var d=b.__name__;if(d)return b=b.__owner__.superclass[d],!b?void 0:b.apply(e,f||[])},bindInternal:function(){var b=this.getAttrs(),e,f;for(e in b)if(f=
t+s(e),this[f])this.on("after"+s(e)+"Change",n)},syncInternal:function(){var b=[],e;e=this.constructor;for(var f=this.getAttrs();e;)b.push(e),e=e.superclass&&e.superclass.constructor;b.reverse();for(e=0;e<b.length;e++){var d=b[e].ATTRS||{},a;for(a in d)if(a in f){var c,g;(g=this[t+s(a)])&&0!==f[a].sync&&void 0!==(c=this.get(a))&&g.call(this,c)}}},plug:function(b){"function"===typeof b&&(b=new b);b.pluginInitializer&&b.pluginInitializer(this);this.get("plugins").push(b);return this},unplug:function(b){var e=
[],f=this,d="string"==typeof b;h.each(f.get("plugins"),function(a){var c=0,g;b&&(d?(g=a.get&&a.get("pluginId")||a.pluginId,g!=b&&(e.push(a),c=1)):a!=b&&(e.push(a),c=1));c||a.pluginDestructor(f)});f.setInternal("plugins",e);return f},getPlugin:function(b){var e=null;h.each(this.get("plugins"),function(f){if((f.get&&f.get("pluginId")||f.pluginId)==b)return e=f,!1});return e},destructor:h.noop,destroy:function(){this.get("destroyed")||(q.call(this,"pluginDestructor"),this.destructor(),this.set("destroyed",
!0),this.fire("destroy"),this.detach())}});h.mix(k,{name:"Base",__hooks__:{initializer:j(),destructor:j("__destructor",!0)},ATTRS:{plugins:{value:[]},destroyed:{value:!1},listeners:{value:[]}},extend:function e(f,d,a){var c;h.isArray(f)||(a=d,d=f,f=[]);a=a||{};d=h.merge(d);c=d.hasOwnProperty("constructor")?d.constructor:function(){this.callSuper.apply(this,arguments)};d.constructor=c;var g=this.__hooks__;g&&(a.__hooks__=h.merge(g,a.__hooks__));c.__extensions__=f;v(d,c,a.__hooks__||{});g=this.prototype;
g=g.__inheritedStatics__=g.__inheritedStatics__||a.inheritedStatics;a.inheritedStatics&&g!==a.inheritedStatics&&h.mix(g,a.inheritedStatics);g&&h.mix(c,g);delete a.inheritedStatics;h.extend(c,this,d,a);if(f.length){var i={},j={};h.each(f.concat(c),function(a){if(a){h.each(a[r],function(a,c){var d=i[c]=i[c]||{};h.mix(d,a)});var a=a.prototype,c;for(c in a)a.hasOwnProperty(c)&&(j[c]=a[c])}});c[r]=i;j.constructor=c;h.augment(c,j)}c.extend=c.extend||e;c.addMembers=u;return c}});k.INVALID=w.INVALID;return h.Base=
k},{requires:["base/attribute","event/custom"]});
