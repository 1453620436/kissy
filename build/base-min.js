/*
Copyright 2013, KISSY v1.50dev
MIT Licensed
build time: Nov 25 12:01
*/
KISSY.add("base",["attribute"],function(e,q){function i(c,a){return function(d){return function(){a?d.apply(this,arguments):this.callSuper.apply(this,arguments);var b=arguments.callee.__owner__.__extensions__||[];a&&b.reverse();var f=arguments,h;if(h=b&&b.length)for(var g=0;g<h;g++){var e=b[g]&&(!c?b[g]:b[g].prototype[c]);e&&e.apply(this,f||[])}a?this.callSuper.apply(this,arguments):d.apply(this,arguments)}}}function n(c){var a=this.__hooks__,d=this.prototype;if(this.__extensions__.length&&a)for(var b in a)if(!d.hasOwnProperty(b)||
c.hasOwnProperty(b))c[b]=c[b]||o;return r.call(this,c)}function s(c){var a;c.target==this&&(a=this[j+c.type.slice(5).slice(0,-6)],a.call(this,c.newVal,c))}function t(c){var a=c.get("plugins");e.each(a,function(c,b){"function"===typeof c&&(a[b]=new c)})}function k(c){var a,d=this.get("plugins");if(a=d.length)for(var b=0;b<a;b++)d[b][c]&&d[b][c](this)}var p=q("attribute"),l=e.ucfirst,j="_onSet",o=e.noop,m=p.extend({constructor:function(){this.callSuper.apply(this,arguments);var c=this.get("listeners"),
a;for(a in c)this.on(a,c[a]);this.initializer();t(this);k.call(this,"pluginInitializer");this.bindInternal();this.syncInternal()},initializer:o,__getHook:i,__callPluginsMethod:k,bindInternal:function(){var c=this.getAttrs(),a,d;for(a in c)if(d=j+l(a),this[d])this.on("after"+l(a)+"Change",s)},syncInternal:function(){var c=[],a;a=this.constructor;for(var d=this.getAttrs();a;)c.push(a),a=a.superclass&&a.superclass.constructor;c.reverse();for(a=0;a<c.length;a++){var b=c[a].ATTRS||{},f;for(f in b)if(f in
d){var e,g;(g=this[j+l(f)])&&0!==d[f].sync&&void 0!==(e=this.get(f))&&g.call(this,e)}}},plug:function(c){"function"===typeof c&&(c=new c);c.pluginInitializer&&c.pluginInitializer(this);this.get("plugins").push(c);return this},unplug:function(c){var a=[],d=this,b="string"==typeof c;e.each(d.get("plugins"),function(f){var e=0,g;c&&(b?(g=f.get&&f.get("pluginId")||f.pluginId,g!=c&&(a.push(f),e=1)):f!=c&&(a.push(f),e=1));e||f.pluginDestructor(d)});d.setInternal("plugins",a);return d},getPlugin:function(c){var a=
null;e.each(this.get("plugins"),function(d){if((d.get&&d.get("pluginId")||d.pluginId)==c)return a=d,!1});return a},destructor:e.noop,destroy:function(){this.get("destroyed")||(k.call(this,"pluginDestructor"),this.destructor(),this.set("destroyed",!0),this.fire("destroy"),this.detach())}});e.mix(m,{__hooks__:{initializer:i(),destructor:i("__destructor",!0)},ATTRS:{plugins:{value:[]},destroyed:{value:!1},listeners:{value:[]}},extend:function a(d,b,f){e.isArray(d)||(f=b,b=d,d=[]);f=f||{};b=b||{};b=p.extend.call(this,
b,f);b.__extensions__=d;n.call(b,{});if(d.length){var h={},g={};e.each(d.concat(b),function(a){if(a){e.each(a.ATTRS,function(a,b){var d=h[b]=h[b]||{};e.mix(d,a)});var a=a.prototype,b;for(b in a)a.hasOwnProperty(b)&&(g[b]=a[b])}});b.ATTRS=h;g.constructor=b;e.augment(b,g)}b.extend=f.extend||a;b.addMembers=n;return b}});var r=m.addMembers;return m});
