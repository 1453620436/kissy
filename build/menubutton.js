/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: Aug 26 16:09
*/
KISSY.add("menubutton",["menubutton/control","menubutton/select","menubutton/option"],function(f,c,h,e){f=c("menubutton/control");h=c("menubutton/select");f.Select=h;f.Option=c("menubutton/option");e.exports=f});
KISSY.add("menubutton/control",["button","component/extension/content-box","node","./menubutton-xtpl","util"],function(f,c,h,e){function k(a){a.target.isMenuItem&&this.get("collapseOnClick")&&this.set("collapsed",!0)}function d(a){a.target.isMenu&&(a=a.newVal,this.el.setAttribute("aria-activedescendant",a&&a.el.id||""))}var f=c("button"),h=c("component/extension/content-box"),i=c("node").Event.KeyCode,l=c("./menubutton-xtpl"),g=c("util");e.exports=f.extend([h],{isMenuButton:1,decorateDom:function(a){var b=
this.get("prefixCls"),a=a.one("."+b+"popupmenu"),d=a[0].ownerDocument.body;d.insertBefore(a[0],d.firstChild);this.setInternal("menu",new (this.getComponentConstructorByNode(b,a))({srcNode:a,prefixCls:b}))},beforeCreateDom:function(a){g.mix(a.elAttrs,{"aria-expanded":"false","aria-haspopup":"true"})},_onSetCollapsed:function(a){var b=this.get("menu"),d=this.$el,c=this.getBaseCssClass("open");d[a?"removeClass":"addClass"](c).attr("aria-expanded",!a);a?b.hide():b.get("visible")||(a={node:d,points:["bl",
"tl"],overflow:{adjustX:1,adjustY:1}},g.mix(b.get("align"),a,!1),this.get("matchElWidth")&&(b.render(),a=b.get("el"),a=(parseInt(a.css("borderLeftWidth"),10)||0)+(parseInt(a.css("borderRightWidth"),10)||0),b.set("width",b.get("align").node[0].offsetWidth-a)),b.show(),d.attr("aria-haspopup",b.get("el").attr("id")))},bindUI:function(){this.on("afterHighlightedItemChange",d,this);this.on("click",k,this)},handleKeyDownInternal:function(a){var b=a.keyCode,d=""+a.type,c=this.get("menu");if(b===i.SPACE){if(a.preventDefault(),
"keyup"!==d)return}else if("keydown"!==d)return;if(c.get("rendered")&&c.get("visible"))return a=c.handleKeyDownInternal(a),b===i.ESC?(this.set("collapsed",!0),!0):a;if(b===i.SPACE||b===i.DOWN||b===i.UP)return this.set("collapsed",!1),!0},handleClickInternal:function(){this.set("collapsed",!this.get("collapsed"))},handleBlurInternal:function(a){this.callSuper(a);this.set("collapsed",!0)},addItem:function(a,b){this.get("menu").addChild(a,b)},removeItem:function(a,b){this.get("menu").removeChild(a,b)},
removeItems:function(a){var b=this.get("menu");b&&(b.removeChildren?b.removeChildren(a):b.children&&(b.children=[]))},getItemAt:function(a){var b=this.get("menu");return b.get("rendered")&&b.getChildAt(a)},_onSetDisabled:function(a){this.callSuper(a);a||this.set("collapsed",!0)},destructor:function(){this.get("menu").destroy()}},{ATTRS:{handleGestureEvents:{value:!0},focusable:{value:!0},allowTextSelection:{value:!1},contentTpl:{value:l},matchElWidth:{value:!0},collapseOnClick:{value:!1},menu:{getter:function(a){a=
a||{};a.isControl||(a.xclass=a.xclass||"popupmenu",a=this.createComponent(a),this.setInternal("menu",a));return a},setter:function(a){a.isControl&&a.setInternal("parent",this)}},collapsed:{value:!0,render:1,sync:0}},xclass:"menu-button"})});
KISSY.add("menubutton/menubutton-xtpl",[],function(f,c,h,e){e.exports=function(c,d,f){var e=this.pos={line:1,col:1},g=this.root.utils.callFn;d.append('<div class="');var a={escape:1},b=[];b.push("content");a.params=b;e.line=1;e.col=33;if((a=g(this,c,a,d,["getBaseCssClasses"]))&&a.isBuffer)d=a,a=f;d.writeEscaped(a);d.append('">');a=c.resolve(["content"]);d.write(a);d.append('</div>\r\n<div class="');a={escape:1};b=[];b.push("dropdown");a.params=b;e.line=2;e.col=32;if((a=g(this,c,a,d,["getBaseCssClasses"]))&&
a.isBuffer)d=a,a=f;d.writeEscaped(a);d.append('">\r\n    <div class="');a={escape:1};b=[];b.push("dropdown-inner");a.params=b;e.line=3;e.col=36;if((c=g(this,c,a,d,["getBaseCssClasses"]))&&c.isBuffer)d=c,c=f;d.writeEscaped(c);d.append('">\r\n    </div>\r\n</div>');return d};e.exports.TPL_NAME=e.name});
KISSY.add("menubutton/select",["node","./control","util"],function(f,c,h,e){function k(a){var j=a.get("menu"),j=j.children||j.get&&j.get("children")||[],a=a.get("value"),b,c;for(c=0;c<j.length;c++)if(b=j[c],d(b)===a)return b;return null}function d(a){var b;if(a)if(a.get){if(void 0===(b=a.get("value")))b=a.get("textContent")||a.get("content")}else if(void 0===(b=a.value))b=a.textContent||a.content;return b}function i(a){var b=a.get("menu"),c=a.get("value"),a=b&&b.get&&b.get("children");m.each(a,function(a){a&&
a.set&&a.set("selected",d(a)===c)})}function l(a){var b=k(this),c=this.get("menu");a.target===c&&((a=b||c.getChildAt(0))&&a.set("highlighted",!0),b&&b.set("selected",!0))}function g(a){var b=k(a),c=b&&(b.textContent||b.get&&b.get("textContent")),b=b&&(b.content||b.get&&b.get("content"));a.set("content",c||b||a.get("defaultCaption"))}function a(a){a=a.target;if(a.isMenuItem){var a=d(a),b=this.get("value");this.set("value",a);a!==b&&this.fire("change",{prevVal:b,newVal:a})}}var b=c("node"),f=c("./control"),
m=c("util"),n=f.extend({bindUI:function(){this.on("click",a,this);this.on("show",l,this)},removeItems:function(){this.callSuper.apply(this,arguments);this.set("value",null)},removeItem:function(a,b){this.callSuper(a,b);a.get("value")===this.get("value")&&this.set("value",null)},_onSetValue:function(){i(this);g(this)},_onSetDefaultCaption:function(){g(this)}},{ATTRS:{value:{},defaultCaption:{value:""},collapseOnClick:{value:!0}},decorate:function(a,c){a=b(a);c=c||{};c.elBefore=a;var d,f=[],e,g=null,
h=a.val();a.all("option").each(function(a){var b={xclass:"option",content:a.text(),elCls:a.attr("class"),value:a.val()};h===a.val()&&(g={content:b.content,value:b.value});f.push(b)});c.menu=c.menu||c.menuCfg||{};c.menu.children=f;delete c.menuCfg;e=(new n(m.mix(c,g))).render();if(d=a.attr("name")){var i=b('<input type="hidden" name="'+d+'" value="'+h+'">').insertBefore(a,void 0);e.on("afterValueChange",function(a){i.val(a.newVal||"")})}a.remove();return e},xclass:"select"});e.exports=n});
KISSY.add("menubutton/option",["menu"],function(f,c,h,e){f=c("menu");e.exports=f.RadioItem.extend({},{ATTRS:{textContent:{}},xclass:"option"})});
