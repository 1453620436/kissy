/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: May 8 11:54
*/
KISSY.add("menubutton",["menubutton/control","menubutton/select","menubutton/option"],function(h,c){var f=c("menubutton/control"),i=c("menubutton/select"),j=c("menubutton/option");f.Select=i;f.Option=j;return f});
KISSY.add("menubutton/control",["node","button","component/extension/content-box","./menubutton-xtpl"],function(h,c){function f(a){a.target.isMenuItem&&this.get("collapseOnClick")&&this.set("collapsed",!0)}function i(a){a.target.isMenu&&(a=a.newVal,this.el.setAttribute("aria-activedescendant",a&&a.el.id||""))}var j=c("node"),e=c("button"),l=c("component/extension/content-box"),g=j.KeyCode,j=c("./menubutton-xtpl");return e.extend([l],{isMenuButton:1,decorateDom:function(a){var b=this.get("prefixCls"),
a=a.one("."+b+"popupmenu"),k=a[0].ownerDocument.body;k.insertBefore(a[0],k.firstChild);this.setInternal("menu",new (this.getComponentConstructorByNode(b,a))({srcNode:a,prefixCls:b}))},beforeCreateDom:function(a){h.mix(a.elAttrs,{"aria-expanded":!1,"aria-haspopup":!0})},_onSetCollapsed:function(a){var b=this.get("menu"),k=this.$el,d=this.getBaseCssClass("open");k[a?"removeClass":"addClass"](d).attr("aria-expanded",!a);a?b.hide():b.get("visible")||(a={node:k,points:["bl","tl"],overflow:{adjustX:1,adjustY:1}},
h.mix(b.get("align"),a,!1),this.get("matchElWidth")&&(b.render(),a=b.get("el"),a=(parseInt(a.css("borderLeftWidth"),10)||0)+(parseInt(a.css("borderRightWidth"),10)||0),b.set("width",b.get("align").node[0].offsetWidth-a)),b.show(),k.attr("aria-haspopup",b.get("el").attr("id")))},bindUI:function(){this.on("afterHighlightedItemChange",i,this);this.on("click",f,this)},handleKeyDownInternal:function(a){var b=a.keyCode,k=""+a.type,d=this.get("menu");if(b===g.SPACE){if(a.preventDefault(),"keyup"!==k)return}else if("keydown"!==
k)return;if(d.get("rendered")&&d.get("visible"))return a=d.handleKeyDownInternal(a),b===g.ESC?(this.set("collapsed",!0),!0):a;if(b===g.SPACE||b===g.DOWN||b===g.UP)return this.set("collapsed",!1),!0},handleClickInternal:function(){this.set("collapsed",!this.get("collapsed"))},handleBlurInternal:function(a){this.callSuper(a);this.set("collapsed",!0)},addItem:function(a,b){this.get("menu").addChild(a,b)},removeItem:function(a,b){this.get("menu").removeChild(a,b)},removeItems:function(a){var b=this.get("menu");
b&&(b.removeChildren?b.removeChildren(a):b.children&&(b.children=[]))},getItemAt:function(a){var b=this.get("menu");return b.get("rendered")&&b.getChildAt(a)},_onSetDisabled:function(a){this.callSuper(a);a||this.set("collapsed",!0)},destructor:function(){this.get("menu").destroy()}},{ATTRS:{contentTpl:{value:j},matchElWidth:{value:!0},collapseOnClick:{value:!1},menu:{getter:function(a){a=a||{};a.isControl||(a.xclass=a.xclass||"popupmenu",a=this.createComponent(a),this.setInternal("menu",a));return a},
setter:function(a){a.isControl&&a.setInternal("parent",this)}},collapsed:{value:!0,render:1,sync:0}},xclass:"menu-button"})});
KISSY.add("menubutton/menubutton-xtpl",[],function(h,c,f,i){c=function(c,e,f,g){f=this.utils.callFn;if("5.0.0"!==h.version)throw Error("current xtemplate file("+this.name+")(v5.0.0) need to be recompiled using current kissy(v"+h.version+")!");e.write('<div class="',0);var a={escape:1},b=[];b.push("content");a.params=b;if((a=f(this,c,a,e,["getBaseCssClasses"],0,1))&&a.isBuffer)e=a,a=g;e.write(a,!0);e.write('">',0);a=c.resolve(["content"],0);e.write(a,!1);e.write('</div>\r\n<div class="',0);a={escape:1};
b=[];b.push("dropdown");a.params=b;if((a=f(this,c,a,e,["getBaseCssClasses"],0,2))&&a.isBuffer)e=a,a=g;e.write(a,!0);e.write('">\r\n    <div class="',0);a={escape:1};b=[];b.push("dropdown-inner");a.params=b;if((c=f(this,c,a,e,["getBaseCssClasses"],0,3))&&c.isBuffer)e=c,c=g;e.write(c,!0);e.write('">\r\n    </div>\r\n</div>',0);return e};c.TPL_NAME=i.name;return c});
KISSY.add("menubutton/select",["node","./control"],function(h,c){function f(a){var d=a.get("menu"),d=d.children||d.get&&d.get("children")||[],a=a.get("value"),b,c;for(c=0;c<d.length;c++)if(b=d[c],i(b)===a)return b;return null}function i(a){var d;if(a)if(a.get){if(void 0===(d=a.get("value")))d=a.get("textContent")||a.get("content")}else if(void 0===(d=a.value))d=a.textContent||a.content;return d}function j(a){var d=a.get("menu"),b=a.get("value"),a=d&&d.get&&d.get("children");h.each(a,function(a){a&&
a.set&&a.set("selected",i(a)===b)})}function e(a){var b=f(this),c=this.get("menu");a.target===c&&((a=b||c.getChildAt(0))&&a.set("highlighted",!0),b&&b.set("selected",!0))}function l(a){var b=f(a),c=b&&(b.textContent||b.get&&b.get("textContent")),b=b&&(b.content||b.get&&b.get("content"));a.set("content",c||b||a.get("defaultCaption"))}function g(a){a=a.target;if(a.isMenuItem){var a=i(a),b=this.get("value");this.set("value",a);a!==b&&this.fire("change",{prevVal:b,newVal:a})}}var a=c("node"),b=c("./control").extend({bindUI:function(){this.on("click",
g,this);this.on("show",e,this)},removeItems:function(){this.callSuper.apply(this,arguments);this.set("value",null)},removeItem:function(a,b){this.callSuper(a,b);a.get("value")===this.get("value")&&this.set("value",null)},_onSetValue:function(){j(this);l(this)},_onSetDefaultCaption:function(){l(this)}},{ATTRS:{value:{},defaultCaption:{value:""},collapseOnClick:{value:!0}},decorate:function(c,d){c=h.one(c);d=d||{};d.elBefore=c;var e,f=[],g,i=null,j=c.val();c.all("option").each(function(a){var b={xclass:"option",
content:a.text(),elCls:a.attr("class"),value:a.val()};j===a.val()&&(i={content:b.content,value:b.value});f.push(b)});h.mix(d,{menu:h.mix({children:f},d.menuCfg)});delete d.menuCfg;g=(new b(h.mix(d,i))).render();if(e=c.attr("name")){var l=(new a('<input type="hidden" name="'+e+'" value="'+j+'">')).insertBefore(c,void 0);g.on("afterValueChange",function(a){l.val(a.newVal||"")})}c.remove();return g},xclass:"select"});return b});
KISSY.add("menubutton/option",["menu"],function(h,c){return c("menu").Item.extend({},{ATTRS:{selectable:{value:!0},textContent:{}},xclass:"option"})});
