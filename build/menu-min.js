/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: Apr 10 18:48
*/
KISSY.add("menu/control",["node","component/container","component/extension/delegate-children"],function(i,b){function e(d){d.target.isMenu&&(d=d.newVal,this.el.setAttribute("aria-activedescendant",d&&d.el.id||""))}var h=b("node"),a=b("component/container"),c=b("component/extension/delegate-children"),j=h.KeyCode;return a.extend([c],{isMenu:1,beforeCreateDom:function(d){d.elAttrs.role="menu"},bindUI:function(){this.on("afterHighlightedItemChange",e,this)},_onSetHighlightedItem:function(d,c){var a;
d&&c&&(a=c.prevVal)&&a.set("highlighted",!1,{data:{byPassSetHighlightedItem:1}})},_onSetVisible:function(d,c){this.callSuper(d,c);var a;!d&&(a=this.get("highlightedItem"))&&a.set("highlighted",!1)},getRootMenu:function(){return this},handleMouseEnterInternal:function(d){this.callSuper(d);if((d=this.getRootMenu())&&d._popupAutoHideTimer)clearTimeout(d._popupAutoHideTimer),d._popupAutoHideTimer=null;this.focus()},handleBlurInternal:function(d){this.callSuper(d);var a;(a=this.get("highlightedItem"))&&
a.set("highlighted",!1)},_getNextEnabledHighlighted:function(d,a){var c=this.get("children"),f=c.length,j=d;do{var b=c[d];if(!b.get("disabled")&&!1!==b.get("visible"))return c[d];d=(d+a+f)%f}while(d!==j)},handleKeyDownInternal:function(d){var a=this.get("highlightedItem");if(a&&a.handleKeyDownInternal(d))return!0;var c=this.get("children"),f=c.length;if(0!==f){var b;switch(d.keyCode){case j.ESC:(a=this.get("highlightedItem"))&&a.set("highlighted",!1);break;case j.HOME:b=this._getNextEnabledHighlighted(0,
1);break;case j.END:b=this._getNextEnabledHighlighted(f-1,-1);break;case j.UP:a?(d=i.indexOf(a,c),f=(d-1+f)%f):f-=1;b=this._getNextEnabledHighlighted(f,-1);break;case j.DOWN:a?(d=i.indexOf(a,c),f=(d+1+f)%f):f=0,b=this._getNextEnabledHighlighted(f,1)}if(b)return b.set("highlighted",!0,{data:{fromKeyboard:1}}),!0}},containsElement:function(a){var c=this.$el;if(!this.get("visible")||!c)return!1;if(c&&(c[0]===a||c.contains(a)))return!0;for(var c=this.get("children"),b=0,f=c.length;b<f;b++){var j=c[b];
if(j.containsElement&&j.containsElement(a))return!0}return!1}},{ATTRS:{highlightedItem:{value:null},defaultChildCfg:{value:{xclass:"menuitem"}}},xclass:"menu"})});
KISSY.add("menu/menuitem",["component/control","node"],function(i,b){var e=b("component/control"),h=b("node").all;return e.extend({isMenuItem:1,beforeCreateDom:function(a){a.elAttrs.role=a.selectable?"menuitemradio":"menuitem";a.selected&&a.elCls.push(this.getBaseCssClasses("selected"))},handleClickInternal:function(a){this.callSuper(a);a.preventDefault();this.get("selectable")&&this.set("selected",!0);this.fire("click");return!0},_onSetHighlighted:function(a,c){var b=this.get("parent");this.callSuper(a,
c);if(!c||!c.byPassSetHighlightedItem)this.get("rendered")?b.set("highlightedItem",a?this:null):a&&b.set("highlightedItem",this);if(a){var d=this.$el;(b=d.parent(function(a){return"visible"!==h(a).css("overflow")},b.get("el").parent()))&&d.scrollIntoView(b,{alignWithTop:!0,allowHorizontalScroll:!0,onlyScrollIfNeeded:!0})}},_onSetSelected:function(a){var c=this.getBaseCssClasses("selected");this.$el[a?"addClass":"removeClass"](c)},containsElement:function(a){var c=this.$el;return c&&(c[0]===a||c.contains(a))}},
{ATTRS:{focusable:{value:!1},handleGestureEvents:{value:!1},selectable:{sync:0,render:1,parse:function(a){return a.hasClass(this.getBaseCssClass("selectable"))}},value:{},selected:{sync:0,render:1}},xclass:"menuitem"})});
KISSY.add("menu/check-menuitem-xtpl",["component/extension/content-xtpl"],function(i,b,e,h){e=function(a,c,j,d){var e=this.nativeCommands,g=this.utils;if("5.0.0"!==i.version)throw Error("current xtemplate file("+this.name+")(v5.0.0) need to be recompiled using current kissy(v"+i.version+")!");g=g.callCommand;e=e.include;c.write('<div class="');var f={escape:1},k=[];k.push("checkbox");f.params=k;if((g=g(this,a,f,c,"getBaseCssClasses",1))&&g.isBuffer)c=g,g=d;c.write(g,!0);c.write('">\n</div>\n');g=
{};f=[];f.push("component/extension/content-xtpl");g.params=f;b("component/extension/content-xtpl");g.params[0]=h.resolve(g.params[0]);if((a=e.call(this,a,g,c,3,j))&&a.isBuffer)c=a,a=d;c.write(a,!1);return c};e.TPL_NAME=h.name;return e});
KISSY.add("menu/check-menuitem",["./menuitem","component/extension/content-box","./check-menuitem-xtpl"],function(i,b){var e=b("./menuitem"),h=b("component/extension/content-box"),a=b("./check-menuitem-xtpl");return e.extend([h],{beforeCreateDom:function(a){a.checked&&a.elCls.push(this.getBaseCssClasses("checked"))},_onSetChecked:function(a){var b=this.getBaseCssClasses("checked");this.$el[a?"addClass":"removeClass"](b)},handleClickInternal:function(a){this.callSuper(a);this.set("checked",!this.get("checked"));
this.fire("click");return!0}},{ATTRS:{checked:{render:1,sync:0},contentTpl:{value:a}},xclass:"check-menuitem"})});
KISSY.add("menu/submenu-xtpl",[],function(i,b,e,h){b=function(a,c,b,d){b=this.utils;if("5.0.0"!==i.version)throw Error("current xtemplate file("+this.name+")(v5.0.0) need to be recompiled using current kissy(v"+i.version+")!");b=b.callCommand;c.write('<div class="');var e={escape:1},g=[];g.push("content");e.params=g;if((b=b(this,a,e,c,"getBaseCssClasses",1))&&b.isBuffer)c=b,b=d;c.write(b,!0);c.write('">');d=a.resolve(["content"]);c.write(d,!1);c.write('</div>\n<span class="');a=a.resolve(["prefixCls"]);
c.write(a,!0);c.write('submenu-arrow">\u25ba</span>');return c};b.TPL_NAME=h.name;return b});
KISSY.add("menu/submenu",["node","./submenu-xtpl","./menuitem","component/extension/content-box"],function(i,b){function e(a){var b=a.target;b!==this&&b.isMenuItem&&a.newVal&&(this.clearHidePopupMenuTimers(),this.get("highlighted")||(this.set("highlighted",!0),b.set("highlighted",!1),b.set("highlighted",!0)))}function h(){var a=this.get("menu"),b={node:this.$el,points:["tr","tl"],overflow:{adjustX:1,adjustY:1}};i.mix(a.get("align"),b,!1);a.show();this.el.setAttribute("aria-haspopup",a.get("el").attr("id"))}
function a(){this.get("menu").hide()}var c=b("node"),j=b("./submenu-xtpl"),d=b("./menuitem"),l=b("component/extension/content-box"),g=c.KeyCode;return d.extend([l],{isSubMenu:1,decorateDom:function(a){var b=this.get("prefixCls"),a=a.one("."+b+"popupmenu"),c=a[0].ownerDocument.body;c.insertBefore(a[0],c.firstChild);this.setInternal("menu",new (this.getComponentConstructorByNode(b,a))({srcNode:a,prefixCls:b}))},bindUI:function(){this.on("afterHighlightedChange",e,this)},clearShowPopupMenuTimers:function(){var a;
if(a=this._showTimer)a.cancel(),this._showTimer=null},clearHidePopupMenuTimers:function(){var a;if(a=this._dismissTimer)a.cancel(),this._dismissTimer=null},clearSubMenuTimers:function(){this.clearHidePopupMenuTimers();this.clearShowPopupMenuTimers()},handleMouseLeaveInternal:function(){this.set("highlighted",!1,{data:{fromMouse:1}});this.clearSubMenuTimers();this.get("menu").get("visible")&&(this._dismissTimer=i.later(a,1E3*this.get("menuDelay"),!1,this))},handleMouseEnterInternal:function(){this.set("highlighted",
!0,{data:{fromMouse:1}});this.clearSubMenuTimers();this.get("menu").get("visible")||(this._showTimer=i.later(h,1E3*this.get("menuDelay"),!1,this))},_onSetHighlighted:function(b,c){this.callSuper(b,c);c&&!c.fromMouse&&(b&&!c.fromKeyboard?h.call(this):b||a.call(this))},handleClickInternal:function(a){h.call(this);this.callSuper(a)},handleKeyDownInternal:function(a){var b=this.get("menu"),c,d=b.get("visible"),e=a.keyCode;if(d){if(!b.handleKeyDownInternal(a))if(e===g.LEFT)this.set("highlighted",!1),this.set("highlighted",
!0,{data:{fromKeyboard:1}});else return}else if(e===g.RIGHT)h.call(this),a=b.get("children"),(c=a[0])&&c.set("highlighted",!0,{data:{fromKeyboard:1}});else{if(e===g.ENTER)return this.handleClickInternal(a);return}return!0},containsElement:function(a){return this.get("menu").containsElement(a)},destructor:function(){var a=this.get("menu");this.clearSubMenuTimers();a.destroy()}},{ATTRS:{menuDelay:{value:0.15},menu:{value:{},getter:function(a){a.isControl||(a.xclass=a.xclass||"popupmenu",a=this.createComponent(a),
this.setInternal("menu",a));return a},setter:function(a){a.isControl&&a.setInternal("parent",this)}},contentTpl:{value:j}},xclass:"submenu"})});
KISSY.add("menu/popupmenu",["component/extension/align","component/extension/shim","./control","component/extension/content-box"],function(i,b){var e=b("component/extension/align"),h=b("component/extension/shim"),a=b("./control"),c=b("component/extension/content-box");return a.extend([c,h,e],{getRootMenu:function(){var a=this,b;do b=a,a=a.get("parent");while(a&&(a.isMenuItem||a.isMenu));return b===this?null:b},handleMouseLeaveInternal:function(a){this.callSuper(a);if(this.get("autoHideOnMouseLeave")){var b=
this.getRootMenu();b&&(clearTimeout(b._popupAutoHideTimer),b._popupAutoHideTimer=setTimeout(function(){var a;(a=b.get("highlightedItem"))&&a.set("highlighted",!1)},1E3*this.get("parent").get("menuDelay")))}},isPopupMenu:1,handleBlurInternal:function(a){this.callSuper(a);this.hide()}},{ATTRS:{focusable:{value:!1},autoHideOnMouseLeave:{},contentEl:{},visible:{value:!1}},xclass:"popupmenu"})});
KISSY.add("menu",["menu/control","menu/menuitem","menu/check-menuitem","menu/submenu","menu/popupmenu"],function(i,b){var e=b("menu/control"),h=b("menu/menuitem"),a=b("menu/check-menuitem"),c=b("menu/submenu"),j=b("menu/popupmenu");e.Item=h;e.CheckItem=a;e.SubMenu=c;e.PopupMenu=j;return e});
