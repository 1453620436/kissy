/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: May 14 22:15
*/
KISSY.add("date/gregorian",["util","./gregorian/utils","i18n!date","./gregorian/const"],function(H,q){function d(a,b){var c=n.makeArray(arguments);"object"===typeof a?(b=a,a=b.timezoneOffset):3<=c.length&&(a=b=null);this.locale=b=b||x;this.fields=[];this.time=void 0;this.timezoneOffset=a||b.timezoneOffset;this.firstDayOfWeek=b.firstDayOfWeek;this.minimalDaysInFirstWeek=b.minimalDaysInFirstWeek;this.fieldsComputed=!1;3<=arguments.length&&this.set.apply(this,c)}function z(a){var b=a.fields,c=t(b[g],
b[h]);b[i]>c&&a.set(i,c)}function t(a,b){return A(a)?I[b]:J[b]}function y(a,b,c){var e=b+6-r(b+6-a.firstDayOfWeek,7);e-b>=a.minimalDaysInFirstWeek&&(e-=7);return E((c-e)/7)+1}var n=q("util"),k=parseInt,o=q("./gregorian/utils"),x=q("i18n!date"),l=q("./gregorian/const");n.mix(d,l);n.mix(d,{Utils:o,isLeapYear:o.isLeapYear,YEAR:1,MONTH:2,DAY_OF_MONTH:3,HOUR_OF_DAY:4,MINUTES:5,SECONDS:6,MILLISECONDS:7,WEEK_OF_YEAR:8,WEEK_OF_MONTH:9,DAY_OF_YEAR:10,DAY_OF_WEEK:11,DAY_OF_WEEK_IN_MONTH:12,AM:0,PM:1});var g=
d.YEAR,h=d.MONTH,i=d.DAY_OF_MONTH,j=d.HOUR_OF_DAY,D=d.MINUTES,u=d.SECONDS,m=d.MILLISECONDS,B=d.DAY_OF_WEEK_IN_MONTH,v=d.DAY_OF_YEAR,w=d.DAY_OF_WEEK,s=d.WEEK_OF_MONTH,p=d.WEEK_OF_YEAR,J=[31,28,31,30,31,30,31,31,30,31,30,31],I=[31,29,31,30,31,30,31,31,30,31,30,31],r=o.mod,A=o.isLeapYear,E=Math.floor,F=[void 0,1,d.JANUARY,1,0,0,0,0,1,void 0,1,d.SUNDAY,1],G=[void 0,292278994,d.DECEMBER,void 0,23,59,59,999,void 0,void 0,void 0,d.SATURDAY,void 0];d.prototype={constructor:d,isLeapYear:function(){return A(this.getYear())},
getLocale:function(){return this.locale},getActualMinimum:function(a){if(void 0!==F[a])return F[a];var b=this.fields;if(a===s)return(new d(b[g],b[h],1)).get(s);throw Error("minimum value not defined!");},getActualMaximum:function(a){if(void 0!==G[a])return G[a];var b,c=this.fields;switch(a){case i:b=t(c[g],c[h]);break;case p:b=(new d(c[g],d.DECEMBER,31)).get(p);1===b&&(b=52);break;case s:b=(new d(c[g],c[h],t(c[g],c[h]))).get(s);break;case v:b=A(c[g])?366:365;break;case B:b=k((t(c[g],c[h])-1)/7)+1}if(void 0===
b)throw Error("maximum value not defined!");return b},isSet:function(a){return void 0!==this.fields[a]},computeFields:function(){var a=this.time,b=6E4*this.timezoneOffset,c=k(b/864E5),b=b%864E5,c=c+k(a/864E5),b=b+a%864E5;if(864E5<=b)b-=864E5,c++;else for(;0>b;)b+=864E5,c--;var c=c+719163,e=o.getGregorianDateFromFixedDate(c),f=e.year,a=this.fields;a[g]=f;a[h]=e.month;a[i]=e.dayOfMonth;a[w]=e.dayOfWeek;0!==b?(a[j]=k(b/36E5),b%=36E5,a[D]=k(b/6E4),b%=6E4,a[u]=k(b/1E3),a[m]=b%1E3):a[j]=a[D]=a[u]=a[m]=
0;var l=o.getFixedDate(f,d.JANUARY,1),b=c-e.dayOfMonth+1;a[v]=c-l+1;a[B]=k((e.dayOfMonth-1)/7)+1;e=y(this,l,c);0===e?(e=l-1,f=l-(A(f-1)?366:365),e=y(this,f,e)):52<=e&&(f=l+(A(f)?366:365),l=f+6-r(f+6-this.firstDayOfWeek,7),l-f>=this.minimalDaysInFirstWeek&&c>=l-7&&(e=1));a[p]=e;a[s]=y(this,b,c);this.fieldsComputed=!0},computeTime:function(){if(!this.isSet(g))throw Error("year must be set for KISSY GregorianCalendar");var a=this.fields,b=a[g],c=0;this.isSet(j)&&(c+=a[j]);c=60*c+(a[D]||0);c=60*c+(a[u]||
0);c=1E3*c+(a[m]||0);a[g]=b;a=0+this.getFixedDate();this.time=c=864E5*(a-719163)+c-6E4*this.timezoneOffset;this.computeFields()},complete:function(){void 0===this.time&&this.computeTime();this.fieldsComputed||this.computeFields()},getFixedDate:function(){var a=this.fields,b=this.firstDayOfWeek,c=a[g],e=d.JANUARY;this.isSet(h)&&(e=a[h],e>d.DECEMBER?(c+=k(e/12),e%=12):e<d.JANUARY&&(c+=E(e/12),e=r(e,12)));var f=o.getFixedDate(c,e,1),l=this.firstDayOfWeek;this.isSet(w)&&(l=a[w]);this.isSet(h)?this.isSet(i)?
f+=a[i]-1:this.isSet(s)?(c=f+6-r(f+6-b,7),c-f>=this.minimalDaysInFirstWeek&&(c-=7),l!==b&&(c=c+6-r(c+6-l,7)),f=c+7*(a[s]-1)):(a=this.isSet(B)?a[B]:1,b=7*a,0>a&&(b=t(c,e)+7*(a+1)),f=f+b-1-r(f+b-1-l,7)):this.isSet(v)?f+=a[v]-1:(c=f+6-r(f+6-b,7),c-f>=this.minimalDaysInFirstWeek&&(c-=7),l!==b&&(c=c+6-r(c+6-l,7)),f=c+7*(a[p]-1));return f},getTime:function(){void 0===this.time&&this.computeTime();return this.time},setTime:function(a){this.time=a;this.fieldsComputed=!1;this.complete()},get:function(a){this.complete();
return this.fields[a]},set:function(a,b){var c=arguments.length;if(2===c)this.fields[a]=b;else if(c<m+1)for(var e=0;e<c;e++)this.fields[g+e]=arguments[e];else throw Error("illegal arguments for KISSY GregorianCalendar set");this.time=void 0},add:function(a,b){if(b){var c=this.fields,e=this.get(a);if(a===g)this.set(g,e+b),z(this);else if(a===h){var e=e+b,f=E(e/12),e=r(e,12);f&&this.set(g,c[g]+f);this.set(h,e);z(this)}else{switch(a){case j:b*=36E5;break;case D:b*=6E4;break;case u:b*=1E3;break;case m:break;
case s:case p:case B:b*=6048E5;break;case w:case v:case i:b*=864E5;break;default:throw Error("illegal field for add");}this.setTime(this.time+b)}}},getRolledValue:function(a,b,c,e){e=e-c+1;return c+(a-c+b%e+e)%e},roll:function(a,b){if(b){var c=this.get(a),e=this.getActualMinimum(a),f=this.getActualMaximum(a),c=this.getRolledValue(c,b,e,f);this.set(a,c);switch(a){case h:z(this);break;default:this.updateFieldsBySet(a)}}},updateFieldsBySet:function(a){var b=this.fields;switch(a){case s:b[i]=void 0;break;
case v:b[h]=void 0;break;case w:b[i]=void 0;break;case p:b[v]=void 0,b[h]=void 0}},getTimezoneOffset:function(){return this.timezoneOffset},setTimezoneOffset:function(a){this.timezoneOffset!==a&&(this.fieldsComputed=void 0,this.timezoneOffset=a)},setFirstDayOfWeek:function(a){this.firstDayOfWeek!==a&&(this.firstDayOfWeek=a,this.fieldsComputed=!1)},getFirstDayOfWeek:function(){return this.firstDayOfWeek},setMinimalDaysInFirstWeek:function(a){this.minimalDaysInFirstWeek!==a&&(this.minimalDaysInFirstWeek=
a,this.fieldsComputed=!1)},getMinimalDaysInFirstWeek:function(){return this.minimalDaysInFirstWeek},getWeeksInWeekYear:function(){var a=this.getWeekYear();if(a===this.get(g))return this.getActualMaximum(p);var b=this.clone();b.setWeekDate(a,2,this.get(w));return b.getActualMaximum(p)},getWeekYear:function(){var a=this.get(g),b=this.get(p),c=this.get(h);c===d.JANUARY?52<=b&&--a:c===d.DECEMBER&&1===b&&++a;return a},setWeekDate:function(a,b,c){if(c<d.SUNDAY||c>d.SATURDAY)throw Error("invalid dayOfWeek: "+
c);var e=this.fields,f=this.clone();f.clear();f.setTimezoneOffset(0);f.set(g,a);f.set(p,1);f.set(w,this.getFirstDayOfWeek());a=c-this.getFirstDayOfWeek();0>a&&(a+=7);a+=7*(b-1);0!==a?f.add(v,a):f.complete();e[g]=f.get(g);e[h]=f.get(h);e[i]=f.get(i);this.complete()},clone:function(){void 0===this.time&&this.computeTime();var a=new d(this.timezoneOffset,this.locale);a.setTime(this.time);return a},equals:function(a){return this.getTime()===a.getTime()&&this.firstDayOfWeek===a.firstDayOfWeek&&this.timezoneOffset===
a.timezoneOffset&&this.minimalDaysInFirstWeek===a.minimalDaysInFirstWeek},clear:function(a){void 0===a?this.field=[]:this.fields[a]=void 0;this.time=void 0;this.fieldsComputed=!1}};var C=d.prototype;n.each(",Year,Month,DayOfMonth,HourOfDay,Minutes,Seconds,Milliseconds,WeekOfYear,WeekOfMonth,DayOfYear,DayOfWeek,DayOfWeekInMonth".split(","),function(a,b){if(a){C["get"+a]=function(){return this.get(b)};C["isSet"+a]=function(){return this.isSet(b)};C["set"+a]=function(a){return this.set(b,a)};C["add"+
a]=function(a){return this.add(b,a)};C["roll"+a]=function(a){return this.roll(b,a)}}});return d});
KISSY.add("date/gregorian/utils",["util","./const"],function(H,q){var d=q("util"),z=q("./const"),t=[0,31,59,90,120,151,181,212,243,273,304,334],y=[0,31,60,91,121,152,182,213,244,274,305,335],n={};d.mix(n,{isLeapYear:function(d){return 0!==(d&3)?!1:0!==d%100||0===d%400},mod:function(d,g){return d-g*k(d/g)},getFixedDate:function(d,g,h){var i=d-1;return 365*i+k(i/4)-k(i/100)+k(i/400)+(h+(o(d)?y[g]:t[g]))},getGregorianDateFromFixedDate:function(d){var g,h,i,j;h=d-1;g=k(h/146097);i=x(h,146097);h=k(i/36524);
j=x(i,36524);i=k(j/1461);j=x(j,1461);j=k(j/365);g=400*g+100*h+4*i+j;4===h||4===j||++g;i=n.getFixedDate(g,z.JANUARY,1);j=(h=o(g))?y:t;var q=d-i,u,m;for(m=0;m<j.length;m++)if(j[m]<=q)u=m;else break;i=d-i-j[u]+1;d=0<=d?d%7:x(d,7);return{year:g,month:u,dayOfMonth:i,dayOfWeek:d,isLeap:h}}});var k=Math.floor,o=n.isLeapYear,x=n.mod;return n});
KISSY.add("date/gregorian/const",[],function(){return{SUNDAY:0,MONDAY:1,TUESDAY:2,WEDNESDAY:3,THURSDAY:4,FRIDAY:5,SATURDAY:6,JANUARY:0,FEBRUARY:1,MARCH:2,APRIL:3,MAY:4,JUNE:5,JULY:6,AUGUST:7,SEPTEMBER:8,OCTOBER:9,NOVEMBER:10,DECEMBER:11}});
