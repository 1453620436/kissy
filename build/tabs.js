/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: May 14 22:29
*/
KISSY.add("tabs","component/container,tabs/bar,tabs/body,tabs/tab,tabs/panel,util".split(","),function(i,e){function d(f){this.removeItemByTab(f.target)}function h(f){this.setSelectedTab(f.newVal)}function c(f){var a={};a.content=f.title;a.selected=f.selected;a.closable=f.closable;return a}var b=e("component/container"),a=e("tabs/bar"),j=e("tabs/body");e("tabs/tab");var l=e("tabs/panel"),k=e("util"),b=b.extend({initializer:function(){var f=this.get("items");if(f){var a=this.get("children"),b=this.get("barOrientation"),
d,e=this.get("prefixCls"),j={prefixCls:e,xclass:"tabs-bar",changeType:this.get("changeType"),children:[]},e={prefixCls:e,xclass:"tabs-body",lazyRender:this.get("lazyRender"),children:[]},l=j.children,h=e.children;k.each(f,function(f){d=d||f.selected;l.push(c(f));h.push({content:f.content,selected:f.selected})});if(!d&&l.length){l[0].selected=true;h[0].selected=true}a[g[b]]=j;a[1-g[b]]=e}},beforeCreateDom:function(f){f.elCls.push(this.getBaseCssClass(this.get("barOrientation")))},decorateDom:function(){this.get("bar").set("changeType",
this.get("changeType"))},bindUI:function(){this.on("afterSelectedTabChange",h);this.on("afterTabClose",d)},addItem:function(f,a){var b=this.get("bar"),d,e,j=b.get("children"),g=this.get("body");if(typeof a==="undefined")a=j.length;d=c(f);e={content:f.content};b.addChild(d,a);d=j[a];g.addChild(e,a);if(f.selected){b.set("selectedTab",d);g.set("selectedPanelIndex",a)}return this},removeItemAt:function(f,a){var b=this.get("bar"),c=b.get("children"),d=b.getChildAt(f),e=this.get("body");d.get("selected")&&
(c.length===1?b.set("selectedTab",null):f===0?b.set("selectedTab",b.getChildAt(f+1)):b.set("selectedTab",b.getChildAt(f-1)));b.removeChild(b.getChildAt(f),a);e.removeChild(e.getChildAt(f),a);return this},removeItemByTab:function(a,b){return this.removeItemAt(k.indexOf(a,this.get("bar").get("children")),b)},removeItemByPanel:function(a,b){return this.removeItemAt(k.indexOf(a,this.get("body").get("children")),b)},getSelectedTab:function(){var a=this.get("bar"),b=null;k.each(a.get("children"),function(a){if(a.get("selected")){b=
a;return false}});return b},getSelectedPanel:function(){var a=this.get("body"),b=null;k.each(a.get("children"),function(a){if(a.get("selected")){b=a;return false}});return b},getTabs:function(){return this.get("bar").get("children")},getPanels:function(){return this.get("body").get("children")},getTabAt:function(a){return this.get("bar").get("children")[a]},getPanelAt:function(a){return this.get("body").get("children")[a]},setSelectedTab:function(a){var b=this.get("bar"),c=this.get("body");b.set("selectedTab",
a);c.set("selectedPanelIndex",k.indexOf(a,b.get("children")));return this},setSelectedPanel:function(a){var b=this.get("bar"),c=this.get("body"),a=k.indexOf(a,c.get("children"));c.set("selectedPanelIndex",a);b.set("selectedTab",this.getTabAt(a));return this},_onSetBarOrientation:function(a){this.$el.removeClass(this.getBaseCssClass("top bottom left right")).addClass(this.getBaseCssClass(a))}},{ATTRS:{items:{},changeType:{},lazyRender:{value:false},handleGestureEvents:{value:false},allowTextSelection:{value:true},
focusable:{value:false},bar:{getter:function(){return this.get("children")[g[this.get("barOrientation")]]}},body:{getter:function(){return this.get("children")[1-g[this.get("barOrientation")]]}},barOrientation:{render:1,sync:0,value:"top",parse:function(a){return(a=a[0].className.match(/(top|bottom|left|right)\b/))&&a[1]||void 0}}},xclass:"tabs"});b.Orientation={TOP:"top",BOTTOM:"bottom",LEFT:"left",RIGHT:"right"};var g={top:0,left:0,bottom:1,right:0};b.ChangeType=a.ChangeType;b.Bar=a;b.Body=j;b.Panel=
l;return b});
KISSY.add("tabs/bar",["toolbar","util"],function(i,e){var d=e("toolbar"),h=e("util"),d=d.extend({beforeCreateDom:function(c){c.elAttrs.role="tablist"},bindUI:function(){var c=this;c.on("afterSelectedChange",function(b){b.newVal&&b.target.isTabsTab&&c.set("selectedTab",b.target)})},syncUI:function(){var c=this,b=c.get("children");h.each(b,function(a){if(a.get("selected"))return c.setInternal("selectedTab",a),!1})},handleKeyDownInternal:function(c){var b=this.get("selectedTab"),c=this.getNextItemByKeyDown(c,b);
if("boolean"===typeof c)return c;c.set("selected",!0);return!0},_onSetSelectedTab:function(c,b){var a;c&&(b&&(a=b.prevVal)&&a.set("selected",!1),c.set("selected",!0))},_onSetHighlightedItem:function(c,b){this.callSuper(c,b);"mouse"===this.get("changeType")&&this._onSetSelectedTab.apply(this,arguments)}},{ATTRS:{selectedTab:{},changeType:{value:"click"},defaultChildCfg:{valueFn:function(){return{xclass:"tabs-tab"}}}},xclass:"tabs-bar"});d.ChangeType={CLICK:"click",MOUSE:"mouse"};return d});
KISSY.add("tabs/body",["component/container","util"],function(i,e){function d(a,c,d){if(a.get("lazyRender")){var e=a.get("children")[d];if(!e.get("selected"))return e}return b.superclass[c].call(a,d)}var h=e("component/container"),c=e("util"),b=h.extend({bindUI:function(){var a=this;a.on("afterSelectedPanelIndexChange",function(b){var c=a.get("children"),d=b.newVal,e;c[d]&&((e=c[b.prevVal])&&e.set("selected",!1),a.selectPanelByIndex(d))})},syncUI:function(){var a=this,b=a.get("children");c.each(b,
function(b,c){if(b.get("selected"))return a.set("selectedPanelIndex",c),!1})},createChild:function(a){return d(this,"createChild",a)},renderChild:function(a){return d(this,"renderChild",a)},selectPanelByIndex:function(a){this.get("children")[a].set("selected",!0);this.get("lazyRender")&&this.renderChild(a)}},{ATTRS:{selectedPanelIndex:{},allowTextSelection:{value:!0},focusable:{value:!1},lazyRender:{},handleGestureEvents:{value:!1},defaultChildCfg:{valueFn:function(){return{xclass:"tabs-panel"}}}},
xclass:"tabs-body"});return b});
KISSY.add("tabs/tab",["button","./tab-xtpl","component/extension/content-box"],function(i,e){function d(){this.fire("afterTabClose")}var h=e("button"),c=e("./tab-xtpl"),b=e("component/extension/content-box");return h.extend([b],{initializer:function(){this.publish("beforeTabClose",{defaultFn:d,defaultTargetOnly:!0})},isTabsTab:!0,beforeCreateDom:function(a){var b=a.elAttrs;b.role="tab";a.selected&&(b["aria-selected"]=!0,a.elCls.push(this.getBaseCssClasses("selected")));a.closable&&a.elCls.push(this.getBaseCssClasses("closable"))},
handleClickInternal:function(a){this.get("closable")&&a.target===this.get("closeBtn")[0]?this.fire("beforeTabClose"):(this.callSuper(a),this.set("selected",!0))},_onSetSelected:function(a){var b=this.$el,c=this.getBaseCssClasses("selected");b[a?"addClass":"removeClass"](c).attr("aria-selected",!!a)}},{ATTRS:{contentTpl:{value:c},handleGestureEvents:{value:!1},focusable:{value:!1},closable:{value:!1,render:1,sync:0,parse:function(){return!!this.get("closeBtn")}},closeBtn:{selector:function(){return"."+
this.getBaseCssClass("close")}},selected:{render:1,sync:0,parse:function(a){return a.hasClass(this.getBaseCssClass("selected"))}}},xclass:"tabs-tab"})});
KISSY.add("tabs/tab-xtpl",[],function(i,e,d,h){i=function(c,b,a){var d=this,e=d.root.utils.callFn,h=d.root.nativeCommands["if"];b.write('<div class="',0);var g={escape:1},f=[];f.push("content");g.params=f;if((g=e(d,c,g,b,["getBaseCssClasses"],0,1))&&g.isBuffer)b=g,g=a;b.write(g,!0);b.write('">',0);g=c.resolve(["content"],0);b.write(g,!1);b.write("</div>\r\n",0);var g={escape:1},f=[],i=c.resolve(["closable"],0);f.push(i);g.params=f;g.fn=function(b,c){c.write('\r\n<span class="',0);var f={escape:1},
g=[];g.push("close");f.params=g;if((f=e(d,b,f,c,["getBaseCssClasses"],0,3))&&f.isBuffer)c=f,f=a;c.write(f,!0);c.write('">close</span>\r\n',0);return c};return b=h.call(d,c,g,b,2)};i.TPL_NAME=h.name;i.version="5.0.0";return i});
KISSY.add("tabs/panel",["component/container"],function(i,e){return e("component/container").extend({isTabsPanel:1,beforeCreateDom:function(d){d.elAttrs.role="tabpanel";d.selected?d.elCls.push(this.getBaseCssClasses("selected")):d.elAttrs["aria-hidden"]=!1},_onSetSelected:function(d){var e=this.$el,c=this.getBaseCssClasses("selected");e[d?"addClass":"removeClass"](c).attr("aria-hidden",!d)}},{ATTRS:{selected:{render:1,sync:0,parse:function(d){return d.hasClass(this.getBaseCssClass("selected"))}},
focusable:{value:!1},allowTextSelection:{value:!0}},xclass:"tabs-panel"})});
