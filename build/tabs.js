/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: May 8 11:55
*/
KISSY.add("tabs",["component/container","tabs/bar","tabs/body","tabs/tab","tabs/panel"],function(i,f){function e(d){this.removeItemByTab(d.target)}function c(d){this.setSelectedTab(d.newVal)}function a(d){var g={};g.content=d.title;g.selected=d.selected;g.closable=d.closable;return g}var b=f("component/container"),h=f("tabs/bar"),l=f("tabs/body");f("tabs/tab");var m=f("tabs/panel"),b=b.extend({initializer:function(){var d=this.get("items");if(d){var g=this.get("children"),b=this.get("barOrientation"),
c,h=this.get("prefixCls"),e={prefixCls:h,xclass:"tabs-bar",changeType:this.get("changeType"),children:[]},h={prefixCls:h,xclass:"tabs-body",lazyRender:this.get("lazyRender"),children:[]},f=e.children,l=h.children;i.each(d,function(d){c=c||d.selected;f.push(a(d));l.push({content:d.content,selected:d.selected})});!c&&f.length&&(f[0].selected=!0,l[0].selected=!0);g[j[b]]=e;g[1-j[b]]=h}},beforeCreateDom:function(d){d.elCls.push(this.getBaseCssClass(this.get("barOrientation")))},decorateDom:function(){this.get("bar").set("changeType",
this.get("changeType"))},bindUI:function(){this.on("afterSelectedTabChange",c);this.on("afterTabClose",e)},addItem:function(d,g){var b=this.get("bar"),c,h,f=b.get("children"),e=this.get("body");"undefined"===typeof g&&(g=f.length);c=a(d);h={content:d.content};b.addChild(c,g);c=f[g];e.addChild(h,g);d.selected&&(b.set("selectedTab",c),e.set("selectedPanelIndex",g));return this},removeItemAt:function(d,g){var a=this.get("bar"),b=a.get("children"),c=a.getChildAt(d),h=this.get("body");c.get("selected")&&
(1===b.length?a.set("selectedTab",null):0===d?a.set("selectedTab",a.getChildAt(d+1)):a.set("selectedTab",a.getChildAt(d-1)));a.removeChild(a.getChildAt(d),g);h.removeChild(h.getChildAt(d),g);return this},removeItemByTab:function(d,a){return this.removeItemAt(i.indexOf(d,this.get("bar").get("children")),a)},removeItemByPanel:function(d,a){return this.removeItemAt(i.indexOf(d,this.get("body").get("children")),a)},getSelectedTab:function(){var a=this.get("bar"),b=null;i.each(a.get("children"),function(a){if(a.get("selected"))return b=
a,!1});return b},getSelectedPanel:function(){var a=this.get("body"),b=null;i.each(a.get("children"),function(a){if(a.get("selected"))return b=a,!1});return b},getTabs:function(){return this.get("bar").get("children")},getPanels:function(){return this.get("body").get("children")},getTabAt:function(a){return this.get("bar").get("children")[a]},getPanelAt:function(a){return this.get("body").get("children")[a]},setSelectedTab:function(a){var b=this.get("bar"),c=this.get("body");b.set("selectedTab",a);
c.set("selectedPanelIndex",i.indexOf(a,b.get("children")));return this},setSelectedPanel:function(a){var b=this.get("bar"),c=this.get("body"),a=i.indexOf(a,c.get("children"));c.set("selectedPanelIndex",a);b.set("selectedTab",this.getTabAt(a));return this},_onSetBarOrientation:function(a){this.$el.removeClass(this.getBaseCssClass("top bottom left right")).addClass(this.getBaseCssClass(a))}},{ATTRS:{items:{},changeType:{},lazyRender:{value:!1},handleGestureEvents:{value:!1},allowTextSelection:{value:!0},
focusable:{value:!1},bar:{getter:function(){return this.get("children")[j[this.get("barOrientation")]]}},body:{getter:function(){return this.get("children")[1-j[this.get("barOrientation")]]}},barOrientation:{render:1,sync:0,value:"top",parse:function(a){return(a=a[0].className.match(/(top|bottom|left|right)\b/))&&a[1]||void 0}}},xclass:"tabs"});b.Orientation={TOP:"top",BOTTOM:"bottom",LEFT:"left",RIGHT:"right"};var j={top:0,left:0,bottom:1,right:0};b.ChangeType=h.ChangeType;b.Bar=h;b.Body=l;b.Panel=
m;return b});
KISSY.add("tabs/bar",["toolbar"],function(i,f){var e=f("toolbar").extend({beforeCreateDom:function(c){c.elAttrs.role="tablist"},bindUI:function(){var c=this;c.on("afterSelectedChange",function(a){a.newVal&&a.target.isTabsTab&&c.set("selectedTab",a.target)})},syncUI:function(){var c=this,a=c.get("children");i.each(a,function(a){if(a.get("selected"))return c.setInternal("selectedTab",a),!1})},handleKeyDownInternal:function(c){var a=this.get("selectedTab"),c=this.getNextItemByKeyDown(c,a);if("boolean"===
typeof c)return c;c.set("selected",!0);return!0},_onSetSelectedTab:function(c,a){var b;c&&(a&&(b=a.prevVal)&&b.set("selected",!1),c.set("selected",!0))},_onSetHighlightedItem:function(c,a){this.callSuper(c,a);"mouse"===this.get("changeType")&&this._onSetSelectedTab.apply(this,arguments)}},{ATTRS:{selectedTab:{},changeType:{value:"click"},defaultChildCfg:{valueFn:function(){return{xclass:"tabs-tab"}}}},xclass:"tabs-bar"});e.ChangeType={CLICK:"click",MOUSE:"mouse"};return e});
KISSY.add("tabs/body",["component/container"],function(i,f){function e(a,b,h){if(a.get("lazyRender")){var f=a.get("children")[h];if(!f.get("selected"))return f}return c.superclass[b].call(a,h)}var c=f("component/container").extend({bindUI:function(){var a=this;a.on("afterSelectedPanelIndexChange",function(b){var c=a.get("children"),f=b.newVal,e;c[f]&&((e=c[b.prevVal])&&e.set("selected",!1),a.selectPanelByIndex(f))})},syncUI:function(){var a=this,b=a.get("children");i.each(b,function(b,c){if(b.get("selected"))return a.set("selectedPanelIndex",
c),!1})},createChild:function(a){return e(this,"createChild",a)},renderChild:function(a){return e(this,"renderChild",a)},selectPanelByIndex:function(a){this.get("children")[a].set("selected",!0);this.get("lazyRender")&&this.renderChild(a)}},{ATTRS:{selectedPanelIndex:{},allowTextSelection:{value:!0},focusable:{value:!1},lazyRender:{},handleGestureEvents:{value:!1},defaultChildCfg:{valueFn:function(){return{xclass:"tabs-panel"}}}},xclass:"tabs-body"});return c});
KISSY.add("tabs/tab",["button","./tab-xtpl","component/extension/content-box"],function(i,f){function e(){this.fire("afterTabClose")}var c=f("button"),a=f("./tab-xtpl"),b=f("component/extension/content-box");return c.extend([b],{initializer:function(){this.publish("beforeTabClose",{defaultFn:e,defaultTargetOnly:!0})},isTabsTab:!0,beforeCreateDom:function(a){var b=a.elAttrs;b.role="tab";a.selected&&(b["aria-selected"]=!0,a.elCls.push(this.getBaseCssClasses("selected")));a.closable&&a.elCls.push(this.getBaseCssClasses("closable"))},
handleClickInternal:function(a){this.get("closable")&&a.target===this.get("closeBtn")[0]?this.fire("beforeTabClose"):(this.callSuper(a),this.set("selected",!0))},_onSetSelected:function(a){var b=this.$el,c=this.getBaseCssClasses("selected");b[a?"addClass":"removeClass"](c).attr("aria-selected",!!a)}},{ATTRS:{contentTpl:{value:a},handleGestureEvents:{value:!1},focusable:{value:!1},closable:{value:!1,render:1,sync:0,parse:function(){return!!this.get("closeBtn")}},closeBtn:{selector:function(){return"."+
this.getBaseCssClass("close")}},selected:{render:1,sync:0,parse:function(a){return a.hasClass(this.getBaseCssClass("selected"))}}},xclass:"tabs-tab"})});
KISSY.add("tabs/tab-xtpl",[],function(i,f,e,c){f=function(a,b,c,f){var e=this,j=e.utils.callFn,d=e.nativeCommands["if"];if("5.0.0"!==i.version)throw Error("current xtemplate file("+e.name+")(v5.0.0) need to be recompiled using current kissy(v"+i.version+")!");b.write('<div class="',0);var g={escape:1},k=[];k.push("content");g.params=k;if((g=j(e,a,g,b,["getBaseCssClasses"],0,1))&&g.isBuffer)b=g,g=f;b.write(g,!0);b.write('">',0);g=a.resolve(["content"],0);b.write(g,!1);b.write("</div>\r\n",0);var g=
{escape:1},k=[],n=a.resolve(["closable"],0);k.push(n);g.params=k;g.fn=function(a,b){b.write('\r\n<span class="',0);var c={escape:1},d=[];d.push("close");c.params=d;if((c=j(e,a,c,b,["getBaseCssClasses"],0,3))&&c.isBuffer)b=c,c=f;b.write(c,!0);b.write('">close</span>\r\n',0);return b};return b=d.call(e,a,g,b,2,c)};f.TPL_NAME=c.name;return f});
KISSY.add("tabs/panel",["component/container"],function(i,f){return f("component/container").extend({isTabsPanel:1,beforeCreateDom:function(e){e.elAttrs.role="tabpanel";e.selected?e.elCls.push(this.getBaseCssClasses("selected")):e.elAttrs["aria-hidden"]=!1},_onSetSelected:function(e){var c=this.$el,a=this.getBaseCssClasses("selected");c[e?"addClass":"removeClass"](a).attr("aria-hidden",!e)}},{ATTRS:{selected:{render:1,sync:0,parse:function(e){return e.hasClass(this.getBaseCssClass("selected"))}},
focusable:{value:!1},allowTextSelection:{value:!0}},xclass:"tabs-panel"})});
