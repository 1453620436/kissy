/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: Apr 29 15:09
*/
KISSY.add("filter-menu",["menu","./filter-menu/render-xtpl","component/extension/content-box"],function(i,j){var h=j("menu"),k=j("./filter-menu/render-xtpl"),c=j("component/extension/content-box");return h.extend([c],{bindUI:function(){this.get("filterInput").on("input",this.handleFilterEvent,this)},handleMouseEnterInternal:function(a){this.callSuper(a);this.getKeyEventTarget()[0].select()},handleFilterEvent:function(){var a;a=this.get("filterInput");var c=this.get("highlightedItem");this.set("filterStr",
a.val());a=a.val();this.get("allowMultiple")&&(a=a.replace(/^.+,/,""));if(!a&&c)c.set("highlighted",!1);else if(a&&(!c||!c.get("visible")))(c=this._getNextEnabledHighlighted(0,1))&&c.set("highlighted",!0)},_onSetFilterStr:function(a){this.filterItems(a)},_onSetPlaceholder:function(a){this.get("placeholderEl").html(a)},getKeyEventTarget:function(){return this.get("filterInput")},filterItems:function(a){var c=this.get("prefixCls"),d=this.get("placeholderEl"),e=this.get("filterInput");d[a?"hide":"show"]();
if(this.get("allowMultiple")){var d=[],f;f=a.match(/(.+)[,\uff0c]\s*([^\uff0c,]*)/);var b=[];f&&(b=f[1].split(/[,\uff0c]/));/[,\uff0c]$/.test(a)?(d=[],f&&(d=b,f=b[b.length-1],(b=(b=this.get("highlightedItem"))&&b.get("content"))&&-1<b.indexOf(f)&&f&&(d[d.length-1]=b),e.val(d.join(",")+",")),a=""):(f&&(a=f[2]||""),d=b);this.get("enteredItems").length!==d.length&&this.set("enteredItems",d)}var e=this.get("children"),g=a&&RegExp(i.escapeRegExp(a),"ig");i.each(e,function(b){var d=b.get("content");a?-1<
d.indexOf(a)?(b.set("visible",!0),b.get("el").html(d.replace(g,function(a){return'<span class="'+c+'menuitem-hit">'+a+"</span>"}))):b.set("visible",!1):(b.get("el").html(d),b.set("visible",!0))})},reset:function(){this.set("filterStr","");this.set("enteredItems",[]);this.get("filterInput").val("")}},{ATTRS:{allowTextSelection:{value:!0},filterInput:{selector:function(){return"."+this.getBaseCssClass("input")}},filterInputWrap:{selector:function(){return"."+this.getBaseCssClass("input-wrap")}},placeholder:{render:1,
sync:0,parse:function(){var a=this.get("placeholderEl");return a&&a.html()}},placeholderEl:{selector:function(){return"."+this.getBaseCssClass("placeholder")}},filterStr:{},enteredItems:{value:[]},allowMultiple:{value:!1},contentTpl:{value:k}},xclass:"filter-menu"})});
KISSY.add("filter-menu/render-xtpl",["component/extension/content-xtpl"],function(i,j,h,k){h=function(c,a,h,d){var e=this.utils.callFn,f=this.nativeCommands.include;if("5.0.0"!==i.version)throw Error("current xtemplate file("+this.name+")(v5.0.0) need to be recompiled using current kissy(v"+i.version+")!");a.write('<div class="',0);var b={escape:1},g=[];g.push("input-wrap");b.params=g;if((b=e(this,c,b,a,["getBaseCssClasses"],0,1))&&b.isBuffer)a=b,b=d;a.write(b,!0);a.write('">\r\n    <div class="',
0);b={escape:1};g=[];g.push("placeholder");b.params=g;if((b=e(this,c,b,a,["getBaseCssClasses"],0,2))&&b.isBuffer)a=b,b=d;a.write(b,!0);a.write('">\r\n        ',0);b=c.resolve(["placeholder"],0);a.write(b,!0);a.write('\r\n    </div>\r\n    <input class="',0);b={escape:1};g=[];g.push("input");b.params=g;if((e=e(this,c,b,a,["getBaseCssClasses"],0,5))&&e.isBuffer)a=e,e=d;a.write(e,!0);a.write('"\r\n            autocomplete="off"/>\r\n</div>\r\n',0);e={};b=[];b.push("component/extension/content-xtpl");
e.params=b;j("component/extension/content-xtpl");if((c=f.call(this,c,e,a,8,h))&&c.isBuffer)a=c,c=d;a.write(c,!1);return a};h.TPL_NAME=k.name;return h});
