/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: May 8 11:54
*/
KISSY.add("filter-menu",["menu","./filter-menu/render-xtpl","component/extension/content-box"],function(h,g){var j=g("menu"),i=g("./filter-menu/render-xtpl"),c=g("component/extension/content-box");return j.extend([c],{bindUI:function(){this.get("filterInput").on("input",this.handleFilterEvent,this)},handleMouseEnterInternal:function(a){this.callSuper(a);this.getKeyEventTarget()[0].select()},handleFilterEvent:function(){var a;a=this.get("filterInput");var e=this.get("highlightedItem");this.set("filterStr",
a.val());a=a.val();this.get("allowMultiple")&&(a=a.replace(/^.+,/,""));if(!a&&e)e.set("highlighted",!1);else if(a&&(!e||!e.get("visible")))(e=this._getNextEnabledHighlighted(0,1))&&e.set("highlighted",!0)},_onSetFilterStr:function(a){this.filterItems(a)},_onSetPlaceholder:function(a){this.get("placeholderEl").html(a)},getKeyEventTarget:function(){return this.get("filterInput")},filterItems:function(a){var e=this.get("prefixCls"),f=this.get("placeholderEl"),b=this.get("filterInput");f[a?"hide":"show"]();
if(this.get("allowMultiple")){var f=[],d;d=a.match(/(.+)[,\uff0c]\s*([^\uff0c,]*)/);var c=[];d&&(c=d[1].split(/[,\uff0c]/));/[,\uff0c]$/.test(a)?(f=[],d&&(f=c,d=c[c.length-1],(c=(c=this.get("highlightedItem"))&&c.get("content"))&&-1<c.indexOf(d)&&d&&(f[f.length-1]=c),b.val(f.join(",")+",")),a=""):(d&&(a=d[2]||""),f=c);this.get("enteredItems").length!==f.length&&this.set("enteredItems",f)}var b=this.get("children"),g=a&&RegExp(h.escapeRegExp(a),"ig");h.each(b,function(b){var c=b.get("content");a?-1<
c.indexOf(a)?(b.set("visible",!0),b.get("el").html(c.replace(g,function(a){return'<span class="'+e+'menuitem-hit">'+a+"</span>"}))):b.set("visible",!1):(b.get("el").html(c),b.set("visible",!0))})},reset:function(){this.set("filterStr","");this.set("enteredItems",[]);this.get("filterInput").val("")}},{ATTRS:{contentTpl:{value:i},allowTextSelection:{value:!0},filterInput:{selector:function(){return"."+this.getBaseCssClass("input")}},filterInputWrap:{selector:function(){return"."+this.getBaseCssClass("input-wrap")}},
placeholder:{render:1,sync:0,parse:function(){var a=this.get("placeholderEl");return a&&a.html()}},placeholderEl:{selector:function(){return"."+this.getBaseCssClass("placeholder")}},filterStr:{},enteredItems:{value:[]},allowMultiple:{value:!1}},xclass:"filter-menu"})});
KISSY.add("filter-menu/render-xtpl",[],function(h,g,j,i){g=function(c,a,e,f){e=this.utils.callFn;if("5.0.0"!==h.version)throw Error("current xtemplate file("+this.name+")(v5.0.0) need to be recompiled using current kissy(v"+h.version+")!");a.write('<div class="',0);var b={escape:1},d=[];d.push("input-wrap");b.params=d;if((b=e(this,c,b,a,["getBaseCssClasses"],0,1))&&b.isBuffer)a=b,b=f;a.write(b,!0);a.write('">\r\n    <div class="',0);b={escape:1};d=[];d.push("placeholder");b.params=d;if((b=e(this,
c,b,a,["getBaseCssClasses"],0,2))&&b.isBuffer)a=b,b=f;a.write(b,!0);a.write('">\r\n        ',0);b=c.resolve(["placeholder"],0);a.write(b,!0);a.write('\r\n    </div>\r\n    <input class="',0);b={escape:1};d=[];d.push("input");b.params=d;if((b=e(this,c,b,a,["getBaseCssClasses"],0,5))&&b.isBuffer)a=b,b=f;a.write(b,!0);a.write('"\r\n            autocomplete="off"/>\r\n</div>\r\n<div class="',0);b={escape:1};d=[];d.push("content");b.params=d;if((e=e(this,c,b,a,["getBaseCssClasses"],0,8))&&e.isBuffer)a=
e,e=f;a.write(e,!0);a.write('">',0);c=c.resolve(["content"],0);a.write(c,!1);a.write("</div>",0);return a};g.TPL_NAME=i.name;return g});
