/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: May 9 14:04
*/
KISSY.add("filter-menu",["menu","./filter-menu/render-xtpl","component/extension/content-box"],function(g,h){var j=h("menu"),i=h("./filter-menu/render-xtpl"),c=h("component/extension/content-box");return j.extend([c],{bindUI:function(){this.get("filterInput").on("input",this.handleFilterEvent,this)},handleMouseEnterInternal:function(a){this.callSuper(a);this.getKeyEventTarget()[0].select()},handleFilterEvent:function(){var a;a=this.get("filterInput");var f=this.get("highlightedItem");this.set("filterStr",
a.val());a=a.val();this.get("allowMultiple")&&(a=a.replace(/^.+,/,""));if(!a&&f)f.set("highlighted",!1);else if(a&&(!f||!f.get("visible")))(f=this._getNextEnabledHighlighted(0,1))&&f.set("highlighted",!0)},_onSetFilterStr:function(a){this.filterItems(a)},_onSetPlaceholder:function(a){this.get("placeholderEl").html(a)},getKeyEventTarget:function(){return this.get("filterInput")},filterItems:function(a){var f=this.get("prefixCls"),e=this.get("placeholderEl"),b=this.get("filterInput");e[a?"hide":"show"]();
if(this.get("allowMultiple")){var e=[],d;d=a.match(/(.+)[,\uff0c]\s*([^\uff0c,]*)/);var c=[];d&&(c=d[1].split(/[,\uff0c]/));/[,\uff0c]$/.test(a)?(e=[],d&&(e=c,d=c[c.length-1],(c=(c=this.get("highlightedItem"))&&c.get("content"))&&-1<c.indexOf(d)&&d&&(e[e.length-1]=c),b.val(e.join(",")+",")),a=""):(d&&(a=d[2]||""),e=c);this.get("enteredItems").length!==e.length&&this.set("enteredItems",e)}var b=this.get("children"),h=a&&RegExp(g.escapeRegExp(a),"ig");g.each(b,function(b){var c=b.get("content");a?-1<
c.indexOf(a)?(b.set("visible",!0),b.get("el").html(c.replace(h,function(a){return'<span class="'+f+'menuitem-hit">'+a+"</span>"}))):b.set("visible",!1):(b.get("el").html(c),b.set("visible",!0))})},reset:function(){this.set("filterStr","");this.set("enteredItems",[]);this.get("filterInput").val("")}},{ATTRS:{contentTpl:{value:i},allowTextSelection:{value:!0},filterInput:{selector:function(){return"."+this.getBaseCssClass("input")}},filterInputWrap:{selector:function(){return"."+this.getBaseCssClass("input-wrap")}},
placeholder:{render:1,sync:0,parse:function(){var a=this.get("placeholderEl");return a&&a.html()}},placeholderEl:{selector:function(){return"."+this.getBaseCssClass("placeholder")}},filterStr:{},enteredItems:{value:[]},allowMultiple:{value:!1}},xclass:"filter-menu"})});
KISSY.add("filter-menu/render-xtpl",[],function(g,h,j,i){g=function(c,a,f){var e=this.root.utils.callFn;a.write('<div class="',0);var b={escape:1},d=[];d.push("input-wrap");b.params=d;if((b=e(this,c,b,a,["getBaseCssClasses"],0,1))&&b.isBuffer)a=b,b=f;a.write(b,!0);a.write('">\r\n    <div class="',0);b={escape:1};d=[];d.push("placeholder");b.params=d;if((b=e(this,c,b,a,["getBaseCssClasses"],0,2))&&b.isBuffer)a=b,b=f;a.write(b,!0);a.write('">\r\n        ',0);b=c.resolve(["placeholder"],0);a.write(b,
!0);a.write('\r\n    </div>\r\n    <input class="',0);b={escape:1};d=[];d.push("input");b.params=d;if((b=e(this,c,b,a,["getBaseCssClasses"],0,5))&&b.isBuffer)a=b,b=f;a.write(b,!0);a.write('"\r\n            autocomplete="off"/>\r\n</div>\r\n<div class="',0);b={escape:1};d=[];d.push("content");b.params=d;if((e=e(this,c,b,a,["getBaseCssClasses"],0,8))&&e.isBuffer)a=e,e=f;a.write(e,!0);a.write('">',0);c=c.resolve(["content"],0);a.write(c,!1);a.write("</div>",0);return a};g.TPL_NAME=i.name;g.version="5.0.0";
return g});
