/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: Aug 26 16:09
*/
KISSY.add("menu","menu/control,menu/menuitem,menu/check-menuitem,menu/radio-menuitem,menu/submenu,menu/popupmenu".split(","),function(e,c,i,h){e=c("menu/control");e.Item=c("menu/menuitem");e.CheckItem=c("menu/check-menuitem");e.RadioItem=c("menu/radio-menuitem");e.SubMenu=c("menu/submenu");e.PopupMenu=c("menu/popupmenu");h.exports=e});
KISSY.add("menu/control",["util","component/container","component/extension/delegate-children","node"],function(e,c,i,h){function b(d){d.target.isMenu&&(d=d.newVal,this.el.setAttribute("aria-activedescendant",d&&d.el.id||""))}var a=c("util"),e=c("component/container"),i=c("component/extension/delegate-children"),j=c("node").Event.KeyCode;h.exports=e.extend([i],{isMenu:1,beforeCreateDom:function(d){d.elAttrs.role="menu"},bindUI:function(){this.on("afterHighlightedItemChange",b,this)},_onSetHighlightedItem:function(d,
a){var f;d&&a&&(f=a.prevVal)&&f.set("highlighted",!1,{data:{byPassSetHighlightedItem:1}})},_onSetVisible:function(a,b){this.callSuper(a,b);var f;!a&&(f=this.get("highlightedItem"))&&f.set("highlighted",!1)},getRootMenu:function(){return this},handleMouseEnterInternal:function(a){this.callSuper(a);a=this.getRootMenu();a!==this&&a._popupAutoHideTimer&&(clearTimeout(a._popupAutoHideTimer),a._popupAutoHideTimer=null)},handleBlurInternal:function(a){this.callSuper(a);var b;(b=this.get("highlightedItem"))&&
b.set("highlighted",!1)},_getNextEnabledHighlighted:function(a,b){var f=this.get("children"),g=f.length,c=a;do{var j=f[c];if(!j.get("disabled")&&!1!==j.get("visible"))return f[c];c=(c+b+g)%g}while(c!==a)},handleKeyDownInternal:function(d){var b=this.get("highlightedItem");if(b&&b.handleKeyDownInternal(d))return!0;var c=this.get("children"),g=c.length;if(0!==g){var k;switch(d.keyCode){case j.ESC:(b=this.get("highlightedItem"))&&b.set("highlighted",!1);break;case j.HOME:k=this._getNextEnabledHighlighted(0,
1);break;case j.END:k=this._getNextEnabledHighlighted(g-1,-1);break;case j.UP:b?(d=a.indexOf(b,c),g=(d-1+g)%g):g-=1;k=this._getNextEnabledHighlighted(g,-1);break;case j.DOWN:b?(d=a.indexOf(b,c),g=(d+1+g)%g):g=0,k=this._getNextEnabledHighlighted(g,1)}if(k)return k.set("highlighted",!0,{data:{fromKeyboard:1}}),!0}},containsElement:function(a){var b=this.$el;if(!this.get("visible")||!b)return!1;if(b&&(b[0]===a||b.contains(a)))return!0;for(var b=this.get("children"),c=0,g=b.length;c<g;c++){var j=b[c];
if(j.containsElement&&j.containsElement(a))return!0}return!1}},{ATTRS:{handleGestureEvents:{value:!0},focusable:{value:!0},allowTextSelection:{value:!1},highlightedItem:{value:null},defaultChildCfg:{valueFn:function(){return{xclass:"menuitem"}}}},xclass:"menu"})});
KISSY.add("menu/menuitem",["component/control","node"],function(e,c,i,h){var e=c("component/control"),b=c("node");h.exports=e.extend({isMenuItem:1,beforeCreateDom:function(a){a.elAttrs.role="menuitem"},handleClickInternal:function(a){this.callSuper(a);a.preventDefault();this.fire("click");return!0},_onSetHighlighted:function(a,c){var d=this.get("parent");this.callSuper(a,c);if(!c||!c.byPassSetHighlightedItem)this.get("rendered")?d.set("highlightedItem",a?this:null):a&&d.set("highlightedItem",this);
if(a){var e=this.$el;(d=e.parent(function(a){return"visible"!==b(a).css("overflow")},d.get("el").parent()))&&e.scrollIntoView(d,{alignWithTop:!0,allowHorizontalScroll:!0,onlyScrollIfNeeded:!0})}},containsElement:function(a){var b=this.$el;return b&&(b[0]===a||b.contains(a))}},{ATTRS:{handleGestureEvents:{value:!1},focusable:{value:!1},allowTextSelection:{value:!1}},xclass:"menuitem"})});
KISSY.add("menu/check-menuitem",["./menuitem","component/extension/content-box","./check-menuitem-xtpl"],function(e,c,i,h){e=c("./menuitem");i=c("component/extension/content-box");c=c("./check-menuitem-xtpl");h.exports=e.extend([i],{beforeCreateDom:function(b){b.checked&&b.elCls.push(this.getBaseCssClasses("checked"))},_onSetChecked:function(b){var a=this.getBaseCssClasses("checked");this.$el[b?"addClass":"removeClass"](a)},handleClickInternal:function(b){this.set("checked",!this.get("checked"));
this.callSuper(b);return!0}},{ATTRS:{contentTpl:{value:c},checked:{render:1,sync:0}},xclass:"check-menuitem"})});
KISSY.add("menu/check-menuitem-xtpl",[],function(e,c,i,h){h.exports=function(b,a,c){var d=this.pos={line:1,col:1},e=this.root.utils.callFn;a.append('<div class="');var f={escape:1},g=[];g.push("checkbox");f.params=g;d.line=1;d.col=33;if((f=e(this,b,f,a,["getBaseCssClasses"]))&&f.isBuffer)a=f,f=c;a.writeEscaped(f);a.append('">\r\n</div>\r\n<div class="');f={escape:1};g=[];g.push("content");f.params=g;d.line=3;d.col=32;if((d=e(this,b,f,a,["getBaseCssClasses"]))&&d.isBuffer)a=d,d=c;a.writeEscaped(d);
a.append('">');b=b.resolve(["content"]);a.write(b);a.append("</div>");return a};h.exports.TPL_NAME=h.name});
KISSY.add("menu/radio-menuitem",["./menuitem","component/extension/content-box","./radio-menuitem-xtpl"],function(e,c,i,h){e=c("./menuitem");i=c("component/extension/content-box");c=c("./radio-menuitem-xtpl");h.exports=e.extend([i],{beforeCreateDom:function(b){b.elAttrs.role="menuitemradio";b.selected&&b.elCls.push(this.getBaseCssClasses("selected"))},_onSetSelected:function(b){var a=this.getBaseCssClasses("selected");this.$el[b?"addClass":"removeClass"](a)},handleClickInternal:function(b){var a=
this.get("parent").getRootMenu(),c=a.__selectedItem;c&&c!==this&&c.set("selected",!1);a.__selectedItem=this;this.set("selected",!0);this.callSuper(b);return!0},destructor:function(){var b=this.get("parent");if((b=b&&b.getRootMenu())&&b.__selectedItem===this)b.__selectedItem=null}},{ATTRS:{contentTpl:{value:c},selected:{sync:0,render:1}},xclass:"radio-menuitem"})});
KISSY.add("menu/radio-menuitem-xtpl",[],function(e,c,i,h){h.exports=function(b,a,c){var d=this.pos={line:1,col:1},e=this.root.utils.callFn;a.append('<div class="');var f={escape:1},g=[];g.push("radio");f.params=g;d.line=1;d.col=33;if((f=e(this,b,f,a,["getBaseCssClasses"]))&&f.isBuffer)a=f,f=c;a.writeEscaped(f);a.append('">\r\n</div>\r\n<div class="');f={escape:1};g=[];g.push("content");f.params=g;d.line=3;d.col=32;if((d=e(this,b,f,a,["getBaseCssClasses"]))&&d.isBuffer)a=d,d=c;a.writeEscaped(d);a.append('">');
b=b.resolve(["content"]);a.write(b);a.append("</div>");return a};h.exports.TPL_NAME=h.name});
KISSY.add("menu/submenu",["util","./submenu-xtpl","./menuitem","component/extension/content-box","node"],function(e,c,i,h){function b(a){var b=a.target;b!==this&&b.isMenuItem&&a.newVal&&(this.clearHidePopupMenuTimers(),this.get("highlighted")||(this.set("highlighted",!0),b.set("highlighted",!1),b.set("highlighted",!0)))}function a(){var a=this.get("menu"),b={node:this.$el,points:["tr","tl"],overflow:{adjustX:1,adjustY:1}};d.mix(a.get("align"),b,!1);a.show();this.el.setAttribute("aria-haspopup",a.get("el").attr("id"))}
function j(){this.get("menu").hide()}var d=c("util"),e=c("./submenu-xtpl"),i=c("./menuitem"),l=c("component/extension/content-box"),f=c("node").Event.KeyCode;h.exports=i.extend([l],{isSubMenu:1,decorateDom:function(a){var b=this.get("prefixCls"),a=a.one("."+b+"popupmenu"),c=a[0].ownerDocument.body;c.insertBefore(a[0],c.firstChild);this.setInternal("menu",new (this.getComponentConstructorByNode(b,a))({srcNode:a,prefixCls:b}))},bindUI:function(){this.on("afterHighlightedChange",b,this)},clearShowPopupMenuTimers:function(){var a;
if(a=this._showTimer)a.cancel(),this._showTimer=null},clearHidePopupMenuTimers:function(){var a;if(a=this._dismissTimer)a.cancel(),this._dismissTimer=null},clearSubMenuTimers:function(){this.clearHidePopupMenuTimers();this.clearShowPopupMenuTimers()},handleMouseLeaveInternal:function(){this.set("highlighted",!1,{data:{fromMouse:1}});this.clearSubMenuTimers();this.get("menu").get("visible")&&(this._dismissTimer=d.later(j,1E3*this.get("menuDelay"),!1,this))},handleMouseEnterInternal:function(){this.set("highlighted",
!0,{data:{fromMouse:1}});this.clearSubMenuTimers();this.get("menu").get("visible")||(this._showTimer=d.later(a,1E3*this.get("menuDelay"),!1,this))},_onSetHighlighted:function(b,c){this.callSuper(b,c);c&&!c.fromMouse&&(b&&!c.fromKeyboard?a.call(this):b||j.call(this))},handleClickInternal:function(b){a.call(this);this.callSuper(b)},handleKeyDownInternal:function(b){var c=this.get("menu"),d,e=c.get("visible"),j=b.keyCode;if(e){if(!c.handleKeyDownInternal(b))if(j===f.LEFT)this.set("highlighted",!1),this.set("highlighted",
!0,{data:{fromKeyboard:1}});else return}else if(j===f.RIGHT)a.call(this),b=c.get("children"),(d=b[0])&&d.set("highlighted",!0,{data:{fromKeyboard:1}});else{if(j===f.ENTER)return this.handleClickInternal(b);return}return!0},containsElement:function(a){return this.get("menu").containsElement(a)},destructor:function(){var a=this.get("menu");this.clearSubMenuTimers();a.destroy()}},{ATTRS:{contentTpl:{value:e},menuDelay:{value:0.15},menu:{getter:function(a){a=a||{};a.isControl||(a.xclass=a.xclass||"popupmenu",
a=this.createComponent(a),this.setInternal("menu",a));return a},setter:function(a){a.isControl&&a.setInternal("parent",this)}}},xclass:"submenu"})});
KISSY.add("menu/submenu-xtpl",[],function(e,c,i,h){h.exports=function(b,a,c){var d=this.pos={line:1,col:1},e=this.root.utils.callFn;a.append('<div class="');var f={escape:1},g=[];g.push("content");f.params=g;d.line=1;d.col=33;if((d=e(this,b,f,a,["getBaseCssClasses"]))&&d.isBuffer)a=d,d=c;a.writeEscaped(d);a.append('">');c=b.resolve(["content"]);a.write(c);a.append('</div>\r\n<span class="');b=b.resolve(["prefixCls"]);a.writeEscaped(b);a.append('submenu-arrow">\u25ba</span>');return a};h.exports.TPL_NAME=
h.name});
KISSY.add("menu/popupmenu",["component/extension/align","component/extension/shim","./control","component/extension/content-box"],function(e,c,i,h){var e=c("component/extension/align"),i=c("component/extension/shim"),b=c("./control"),c=c("component/extension/content-box");h.exports=b.extend([c,i,e],{getRootMenu:function(){var a=this,b;do b=a,a=a.get("parent");while(a&&(a.isMenuItem||a.isMenu));return b},handleMouseLeaveInternal:function(a){this.callSuper(a);if(this.get("autoHideOnMouseLeave")){var b=this.getRootMenu();
b!==this&&(clearTimeout(b._popupAutoHideTimer),b._popupAutoHideTimer=setTimeout(function(){var a;(a=b.get("highlightedItem"))&&a.set("highlighted",!1)},1E3*this.get("parent").get("menuDelay")))}},isPopupMenu:1,handleBlurInternal:function(a){this.callSuper(a);this.hide()}},{ATTRS:{handleGestureEvents:{value:!0},focusable:{value:!1},allowTextSelection:{value:!1},autoHideOnMouseLeave:{},visible:{value:!1}},xclass:"popupmenu"})});
