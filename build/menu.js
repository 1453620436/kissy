/*
Copyright 2014, KISSY v5.0.0
MIT Licensed
build time: May 14 22:27
*/
KISSY.add("menu",["menu/control","menu/menuitem","menu/check-menuitem","menu/submenu","menu/popupmenu"],function(j,c){var i=c("menu/control"),e=c("menu/menuitem"),a=c("menu/check-menuitem"),b=c("menu/submenu"),f=c("menu/popupmenu");i.Item=e;i.CheckItem=a;i.SubMenu=b;i.PopupMenu=f;return i});
KISSY.add("menu/control",["util","node","component/container","component/extension/delegate-children"],function(j,c){function i(d){d.target.isMenu&&(d=d.newVal,this.el.setAttribute("aria-activedescendant",d&&d.el.id||""))}var e=c("util"),a=c("node"),b=c("component/container"),f=c("component/extension/delegate-children"),g=a.KeyCode;return b.extend([f],{isMenu:1,beforeCreateDom:function(d){d.elAttrs.role="menu"},bindUI:function(){this.on("afterHighlightedItemChange",i,this)},_onSetHighlightedItem:function(d,
b){var a;d&&b&&(a=b.prevVal)&&a.set("highlighted",!1,{data:{byPassSetHighlightedItem:1}})},_onSetVisible:function(d,b){this.callSuper(d,b);var a;!d&&(a=this.get("highlightedItem"))&&a.set("highlighted",!1)},getRootMenu:function(){return this},handleMouseEnterInternal:function(d){this.callSuper(d);if((d=this.getRootMenu())&&d._popupAutoHideTimer)clearTimeout(d._popupAutoHideTimer),d._popupAutoHideTimer=null;this.focus()},handleBlurInternal:function(d){this.callSuper(d);var b;(b=this.get("highlightedItem"))&&
b.set("highlighted",!1)},_getNextEnabledHighlighted:function(d,b){var a=this.get("children"),h=a.length,g=d;do{var f=a[d];if(!f.get("disabled")&&!1!==f.get("visible"))return a[d];d=(d+b+h)%h}while(d!==g)},handleKeyDownInternal:function(b){var a=this.get("highlightedItem");if(a&&a.handleKeyDownInternal(b))return!0;var f=this.get("children"),h=f.length;if(0!==h){var c;switch(b.keyCode){case g.ESC:(a=this.get("highlightedItem"))&&a.set("highlighted",!1);break;case g.HOME:c=this._getNextEnabledHighlighted(0,
1);break;case g.END:c=this._getNextEnabledHighlighted(h-1,-1);break;case g.UP:a?(b=e.indexOf(a,f),h=(b-1+h)%h):h-=1;c=this._getNextEnabledHighlighted(h,-1);break;case g.DOWN:a?(b=e.indexOf(a,f),h=(b+1+h)%h):h=0,c=this._getNextEnabledHighlighted(h,1)}if(c)return c.set("highlighted",!0,{data:{fromKeyboard:1}}),!0}},containsElement:function(b){var a=this.$el;if(!this.get("visible")||!a)return!1;if(a&&(a[0]===b||a.contains(b)))return!0;for(var a=this.get("children"),f=0,h=a.length;f<h;f++){var c=a[f];
if(c.containsElement&&c.containsElement(b))return!0}return!1}},{ATTRS:{highlightedItem:{value:null},defaultChildCfg:{valueFn:function(){return{xclass:"menuitem"}}}},xclass:"menu"})});
KISSY.add("menu/menuitem",["component/control","node"],function(j,c){var i=c("component/control"),e=c("node").all;return i.extend({isMenuItem:1,beforeCreateDom:function(a){a.elAttrs.role=a.selectable?"menuitemradio":"menuitem";a.selected&&a.elCls.push(this.getBaseCssClasses("selected"))},handleClickInternal:function(a){this.callSuper(a);a.preventDefault();this.get("selectable")&&this.set("selected",!0);this.fire("click");return!0},_onSetHighlighted:function(a,b){var f=this.get("parent");this.callSuper(a,
b);if(!b||!b.byPassSetHighlightedItem)this.get("rendered")?f.set("highlightedItem",a?this:null):a&&f.set("highlightedItem",this);if(a){var c=this.$el;(f=c.parent(function(b){return"visible"!==e(b).css("overflow")},f.get("el").parent()))&&c.scrollIntoView(f,{alignWithTop:!0,allowHorizontalScroll:!0,onlyScrollIfNeeded:!0})}},_onSetSelected:function(a){var b=this.getBaseCssClasses("selected");this.$el[a?"addClass":"removeClass"](b)},containsElement:function(a){var b=this.$el;return b&&(b[0]===a||b.contains(a))}},
{ATTRS:{focusable:{value:!1},handleGestureEvents:{value:!1},selectable:{sync:0,render:1,parse:function(a){return a.hasClass(this.getBaseCssClass("selectable"))}},value:{},selected:{sync:0,render:1}},xclass:"menuitem"})});
KISSY.add("menu/check-menuitem",["./menuitem","component/extension/content-box","./check-menuitem-xtpl"],function(j,c){var i=c("./menuitem"),e=c("component/extension/content-box"),a=c("./check-menuitem-xtpl");return i.extend([e],{beforeCreateDom:function(b){b.checked&&b.elCls.push(this.getBaseCssClasses("checked"))},_onSetChecked:function(b){var a=this.getBaseCssClasses("checked");this.$el[b?"addClass":"removeClass"](a)},handleClickInternal:function(b){this.callSuper(b);this.set("checked",!this.get("checked"));
this.fire("click");return!0}},{ATTRS:{contentTpl:{value:a},checked:{render:1,sync:0}},xclass:"check-menuitem"})});
KISSY.add("menu/check-menuitem-xtpl",[],function(j,c,i,e){j=function(a,b,c){var g=this.root.utils.callFn;b.write('<div class="',0);var d={escape:1},e=[];e.push("checkbox");d.params=e;if((d=g(this,a,d,b,["getBaseCssClasses"],0,1))&&d.isBuffer)b=d,d=c;b.write(d,!0);b.write('">\r\n</div>\r\n<div class="',0);d={escape:1};e=[];e.push("content");d.params=e;if((g=g(this,a,d,b,["getBaseCssClasses"],0,3))&&g.isBuffer)b=g,g=c;b.write(g,!0);b.write('">',0);a=a.resolve(["content"],0);b.write(a,!1);b.write("</div>",
0);return b};j.TPL_NAME=e.name;j.version="5.0.0";return j});
KISSY.add("menu/submenu",["util","node","./submenu-xtpl","./menuitem","component/extension/content-box"],function(j,c){function i(b){var a=b.target;a!==this&&a.isMenuItem&&b.newVal&&(this.clearHidePopupMenuTimers(),this.get("highlighted")||(this.set("highlighted",!0),a.set("highlighted",!1),a.set("highlighted",!0)))}function e(){var a=this.get("menu"),c={node:this.$el,points:["tr","tl"],overflow:{adjustX:1,adjustY:1}};b.mix(a.get("align"),c,!1);a.show();this.el.setAttribute("aria-haspopup",a.get("el").attr("id"))}
function a(){this.get("menu").hide()}var b=c("util"),f=c("node"),g=c("./submenu-xtpl"),d=c("./menuitem"),l=c("component/extension/content-box"),k=f.KeyCode;return d.extend([l],{isSubMenu:1,decorateDom:function(a){var b=this.get("prefixCls"),a=a.one("."+b+"popupmenu"),c=a[0].ownerDocument.body;c.insertBefore(a[0],c.firstChild);this.setInternal("menu",new (this.getComponentConstructorByNode(b,a))({srcNode:a,prefixCls:b}))},bindUI:function(){this.on("afterHighlightedChange",i,this)},clearShowPopupMenuTimers:function(){var a;
if(a=this._showTimer)a.cancel(),this._showTimer=null},clearHidePopupMenuTimers:function(){var a;if(a=this._dismissTimer)a.cancel(),this._dismissTimer=null},clearSubMenuTimers:function(){this.clearHidePopupMenuTimers();this.clearShowPopupMenuTimers()},handleMouseLeaveInternal:function(){this.set("highlighted",!1,{data:{fromMouse:1}});this.clearSubMenuTimers();this.get("menu").get("visible")&&(this._dismissTimer=b.later(a,1E3*this.get("menuDelay"),!1,this))},handleMouseEnterInternal:function(){this.set("highlighted",
!0,{data:{fromMouse:1}});this.clearSubMenuTimers();this.get("menu").get("visible")||(this._showTimer=b.later(e,1E3*this.get("menuDelay"),!1,this))},_onSetHighlighted:function(b,c){this.callSuper(b,c);c&&!c.fromMouse&&(b&&!c.fromKeyboard?e.call(this):b||a.call(this))},handleClickInternal:function(a){e.call(this);this.callSuper(a)},handleKeyDownInternal:function(a){var b=this.get("menu"),c,d=b.get("visible"),f=a.keyCode;if(d){if(!b.handleKeyDownInternal(a))if(f===k.LEFT)this.set("highlighted",!1),this.set("highlighted",
!0,{data:{fromKeyboard:1}});else return}else if(f===k.RIGHT)e.call(this),a=b.get("children"),(c=a[0])&&c.set("highlighted",!0,{data:{fromKeyboard:1}});else{if(f===k.ENTER)return this.handleClickInternal(a);return}return!0},containsElement:function(a){return this.get("menu").containsElement(a)},destructor:function(){var a=this.get("menu");this.clearSubMenuTimers();a.destroy()}},{ATTRS:{contentTpl:{value:g},menuDelay:{value:0.15},menu:{getter:function(a){a=a||{};a.isControl||(a.xclass=a.xclass||"popupmenu",
a=this.createComponent(a),this.setInternal("menu",a));return a},setter:function(a){a.isControl&&a.setInternal("parent",this)}}},xclass:"submenu"})});
KISSY.add("menu/submenu-xtpl",[],function(j,c,i,e){j=function(a,b,c){var g=this.root.utils.callFn;b.write('<div class="',0);var d={escape:1},e=[];e.push("content");d.params=e;if((g=g(this,a,d,b,["getBaseCssClasses"],0,1))&&g.isBuffer)b=g,g=c;b.write(g,!0);b.write('">',0);c=a.resolve(["content"],0);b.write(c,!1);b.write('</div>\r\n<span class="',0);a=a.resolve(["prefixCls"],0);b.write(a,!0);b.write('submenu-arrow">\u25ba</span>',0);return b};j.TPL_NAME=e.name;j.version="5.0.0";return j});
KISSY.add("menu/popupmenu",["component/extension/align","component/extension/shim","./control","component/extension/content-box"],function(j,c){var i=c("component/extension/align"),e=c("component/extension/shim"),a=c("./control"),b=c("component/extension/content-box");return a.extend([b,e,i],{getRootMenu:function(){var a=this,b;do b=a,a=a.get("parent");while(a&&(a.isMenuItem||a.isMenu));return b===this?null:b},handleMouseLeaveInternal:function(a){this.callSuper(a);if(this.get("autoHideOnMouseLeave")){var b=
this.getRootMenu();b&&(clearTimeout(b._popupAutoHideTimer),b._popupAutoHideTimer=setTimeout(function(){var a;(a=b.get("highlightedItem"))&&a.set("highlighted",!1)},1E3*this.get("parent").get("menuDelay")))}},isPopupMenu:1,handleBlurInternal:function(a){this.callSuper(a);this.hide()}},{ATTRS:{focusable:{value:!1},autoHideOnMouseLeave:{},visible:{value:!1}},xclass:"popupmenu"})});
