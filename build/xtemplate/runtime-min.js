/*
Copyright 2014, KISSY v1.50
MIT Licensed
build time: Feb 14 12:34
*/
KISSY.add("xtemplate/runtime/scope",[],function(k){function l(d,g){this.data=d||{};this.affix=g;this.root=this}l.prototype={isScope:1,setParent:function(d){this.parent=d;this.root=d.root},getParent:function(){return this.parent},getRoot:function(){return this.root},set:function(d,g){this.affix||(this.affix={});this.affix[d]=g},setData:function(d){this.data=d},getData:function(){return this.data},mix:function(d){this.affix||(this.affix={});k.mix(this.affix,d)},has:function(d){var g=this.data,e=this.affix;
return e&&d in e?!0:"object"===typeof g&&d in g},get:function(d){var g=this.data,e=this.affix;if(e&&d in e)return e[d];if("object"===typeof g&&d in g)return g[d]},resolve:function(d,g){"."===d&&(d="this");var e=d.split("."),b=this,a,c,f,h,j;if("root"===e[0])e.shift(),b=b.root;else if(g)for(;b&&g--;)b=b.parent;var i=0;for(a=e.length;b;){j=1;f=b;for(c=0;c<a;c++)if(h=e[c],"this"===h)i=1;else if(f===b){if(!b.has(h)){j=0;break}f=b.get(h)}else{if("object"!==typeof f||!(h in f)){j=0;break}f=f[h]}if(j)return f&&
f.isScope&&(f=f.data),"function"===typeof f&&(f=f.call(this.data)),[f];if(i)break;b=b.parent}return!1}};return l});
KISSY.add("xtemplate/runtime/commands",["./scope"],function(k,l){var d,g=l("./scope");return d={each:function(e,b){var a=b.params,c=a[0],d=a[2]||"xindex",a=a[1],h="",j,i,m;if(c)if(i=new g,k.isArray(c)){j=c.length;for(var n=0;n<j;n++)i.data=c[n],m=i.affix={xcount:j},m[d]=n,a&&(m[a]=c[n]),i.setParent(e),h+=b.fn(i)}else for(j in c)i.data=c[j],m=i.affix={},m[d]=j,a&&(m[a]=c[j]),i.setParent(e),h+=b.fn(i);else b.inverse&&(h=b.inverse(e));return h},"with":function(e,b){var a=b.params[0],c="";a?(a=new g(a),
a.setParent(e),c=b.fn(a)):b.inverse&&(c=b.inverse(e));return c},"if":function(e,b){var a="";b.params[0]?b.fn&&(a=b.fn(e)):b.inverse&&(a=b.inverse(e));return a},set:function(e,b){e.mix(b.hash);return""},include:function(e,b){var a=b.params;if(!a||1!==a.length)return"";if(b.hash){var c=new g(b.hash);c.setParent(e);e=c}c=this.config.name;a=a[0];if("."===a.charAt(0)){if("unspecified"===c)return"";c=c.split("/");a=a.split("/");c.pop();for(var d=0;d<a.length;d++){var h=a[d];"."!==h&&(".."===h?c.pop():c.push(h))}a=
c.join("/")}c=this.config.loader.call(this,a);b=k.merge(this.config);b.name=a;b.commands=this.config.commands;b.macros=this.config.macros;return this.invokeEngine(c,e,b)},macro:function(d,b){var a=b.params,c=a[0],f=a.slice(1),a=this.config.macros;if(b.fn)a[c]||(a[c]={paramNames:f,fn:b.fn});else{var h={},c=a[c];k.each(c.paramNames,function(b,a){h[b]=f[a]});a=new g(h);return c.fn.call(this,a)}return""},parse:function(e,b){return d.include.call(this,new g,b)}}});
KISSY.add("xtemplate/runtime",["./runtime/commands","./runtime/scope"],function(k,l){function d(){}function g(b,a){for(var c=a.split("."),d=b,e=c.length,g=0;g<e&&!(d=d[c[g]],!d);g++);return d}function e(b,a,c,d){var e;if(d=g(b.config.commands,d)){try{e=d.call(b,a,c)}catch(h){}return{find:!0,value:e}}return{find:!1}}function b(b,a,c,e,g){var h,b=b.config.silent?d:k.error,a=a.resolve(c,e);!1===a?b('can not find property: "'+c+'" at line '+g,"warn"):h=a[0];return h}function a(b,a){this.tpl=b;a=k.merge(i,
a);a.commands=k.merge(a.commands,c);a.utils=j;a.macros=a.macros||{};this.config=a}var c=l("./runtime/commands"),f=l("./runtime/scope"),h=k.escapeHtml,j={runBlockCommand:function(a,b,c,e,h){var f=a.config,j=f.silent?d:k.error,f=f.commands,i=g(f,e);if(!i)if(!c.params&&!c.hash){var l=b.resolve(e);!1===l?(j('can not find property: "'+e+'" at line '+h),l=""):l=l[0];i=f["if"];k.isArray(l)?i=f.each:"object"===typeof l&&(i=f["with"]);c.params=[l]}else return"";var o;try{o=i.call(a,b,c)}catch(p){}return o},
renderOutput:function(a,b){void 0===a&&(a="");return b&&a?h(a):a},getProperty:function(a,c,d,e,f){return b(a,c,d,e,f)},runInlineCommand:function(a,b,c,d,f){var g="",a=e(a,b,c,d,f);a.find&&(g=a.value);return g},getPropertyOrRunCommand:function(a,c,d,f,g,h){var i,j=d.hash||d.params,d=e(a,c,d,f,h,j);d.find?i=d.value:j||(i=b(a,c,f,g,h));return i}},i={silent:!0,name:"unspecified",loader:function(a){return k.require(a)}};k.mix(a,{commands:c,utils:j,addCommand:function(a,b){c[a]=b},removeCommand:function(a){delete c[a]}});
a.prototype={constructor:a,invokeEngine:function(a,b,c){return(new this.constructor(a,c)).render(b,!0)},removeCommand:function(a){delete this.config.commands[a]},addCommand:function(a,b){this.config.commands[a]=b},render:function(a){var b=a;if(!b||!b.isScope)b=new f(a);return this.tpl(b,k)}};a.Scope=f;return a});
